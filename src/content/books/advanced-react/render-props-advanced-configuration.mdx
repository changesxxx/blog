---
title: "æ¸²æŸ“ props çš„é«˜çº§é…ç½®"
description: "åœ¨ä¸Šä¸€ç« ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†çµæ´»æ€§ã€ç»„ä»¶é…ç½®ã€å¦‚ä½•å°†å…ƒç´ ä½œä¸º props ä¼ é€’æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä»¥åŠå¦‚ä½•åœ¨è¿™äº›å…ƒç´ ä¸Šè®¾ç½®é»˜è®¤å€¼ã€‚ä½†æ˜¯ï¼Œå…ƒç´ ä½œä¸º propsï¼Œå°½ç®¡å¾ˆä¼˜ç§€ï¼Œå¹¶ä¸èƒ½ä¸ºæˆ‘ä»¬è§£å†³æ‰€æœ‰é—®é¢˜ã€‚å¦‚æœä¸€ä¸ªç»„ä»¶é€šè¿‡ props æ¥å—å…¶ä»–ç»„ä»¶ï¼Œéœ€è¦ä»¥æŸç§æ˜ç¡®çš„éé­”æ³•æ–¹å¼å½±å“å®ƒä»¬çš„ props æˆ–å°†ä¸€äº›çŠ¶æ€ä¼ é€’ç»™å®ƒä»¬ï¼Œé‚£ä¹ˆå…ƒç´ ä½œä¸º props å’Œ cloneElement å‡½æ•°åœ¨è¿™é‡Œå°±æ— èƒ½ä¸ºåŠ›äº†ã€‚"

name: "render-props-advanced-configuration"
---

è¿™å°±æ˜¯è¢«ç§°ä¸ºâ€œæ¸²æŸ“ propsâ€çš„æ¨¡å¼æ´¾ä¸Šç”¨åœºçš„åœ°æ–¹ã€‚åœ¨è¿™ä¸€ç« ä¸­ï¼Œä½ å°†å­¦ä¹ ï¼š

- æ¸²æŸ“ props æ¨¡å¼æ˜¯ä»€ä¹ˆï¼Œä»¥åŠå®ƒè§£å†³äº†å“ªäº›é…ç½®é—®é¢˜ï¼Œè€Œå…ƒç´ ä½œä¸º props åˆ™æ— æ³•è§£å†³ã€‚
- å¦‚ä½•é€šè¿‡æ¸²æŸ“ props åˆ†äº«çŠ¶æ€é€»è¾‘ï¼Œä»¥åŠä½œä¸ºæ¸²æŸ“ props çš„ children çœ‹èµ·æ¥æ˜¯æ€æ ·çš„ã€‚
- ä¸ºä»€ä¹ˆåœ¨å¦‚ä»Šæ‹¥æœ‰ hooks çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å®é™…ä¸Šä¸åº”è¯¥è¿™æ ·åšã€‚
- åœ¨ hooks æ—¶ä»£ï¼Œåˆ†äº«é€»è¾‘çš„æ¸²æŸ“ props æ¨¡å¼ä½•æ—¶ä»ç„¶æœ‰ç”¨ã€‚

---

### é—®é¢˜

è¿™æ˜¯æˆ‘ä»¬åœ¨ä¸Šä¸€ç« ä¸­å®ç°çš„æŒ‰é’®ç»„ä»¶ï¼š

```jsx
const Button = ({ appearance, size, icon }) => {
  // åˆ›å»ºé»˜è®¤ props
  const defaultIconProps = {
    size: size === "large" ? "large" : "medium",
    color: appearance === "primary" ? "white" : "black",
  };
  const newProps = {
    ...defaultIconProps,
    // ç¡®ä¿æ¥è‡ª icon çš„ props è¦†ç›– default ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
    ...icon.props,
  };
  // å…‹éš†å›¾æ ‡å¹¶ä¸ºå…¶åˆ†é…æ–° props
  const clonedIcon = React.cloneElement(icon, newProps);
  return (
    <button className={`button ${appearance}`}>Submit {clonedIcon}</button>
  );
};
```

æŒ‰é’®æ¥å—ä¸€ä¸ªå›¾æ ‡å…ƒç´ ï¼Œå¹¶é»˜è®¤è®¾ç½®å…¶å¤§å°å’Œé¢œè‰² propsã€‚

è™½ç„¶è¿™ç§æ–¹æ³•å¯¹äºç®€å•æƒ…å†µéå¸¸æœ‰æ•ˆï¼Œä½†å¯¹äºæ›´å¤æ‚çš„æƒ…å†µå°±ä¸é‚£ä¹ˆç†æƒ³äº†ã€‚å¦‚æœæˆ‘æƒ³åœ¨æŒ‰é’®ä¸­å¼•å…¥ä¸€äº›çŠ¶æ€ï¼Œå¹¶è®©æŒ‰é’®çš„æ¶ˆè´¹è€…è®¿é—®è¯¥çŠ¶æ€å‘¢ï¼Ÿæ¯”å¦‚åœ¨æŒ‰é’®è¢«æ‚¬åœæ—¶è°ƒæ•´å›¾æ ‡ï¼Ÿåœ¨æŒ‰é’®ä¸­å®ç°è¯¥çŠ¶æ€éå¸¸ç®€å•ï¼š

```jsx
const Button = ({ ... }) => {
 const [isHovered, setIsHovered] = useState();
 return <button onMouseOver={() => setIsHovered(true)} />
}

```

ä½†æ¥ä¸‹æ¥æ€ä¹ˆåŠï¼Ÿæˆ‘ä»¬å¦‚ä½•å°†å…¶ä¸å›¾æ ‡å…±äº«ï¼Ÿ

è¿™ç§æ–¹æ³•çš„å¦ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œæˆ‘ä»¬å¯¹é€šè¿‡å›¾æ ‡ prop ä¼ é€’çš„å…ƒç´ åšå‡ºäº†ä¸€äº›é‡å¤§å‡è®¾ã€‚æˆ‘ä»¬æœŸæœ›å®ƒè‡³å°‘å…·æœ‰å¤§å°å’Œé¢œè‰² propsã€‚å¦‚æœæˆ‘ä»¬æƒ³ä½¿ç”¨ä¸åŒçš„å›¾æ ‡åº“ï¼Œè€Œé‚£äº›å›¾æ ‡æ²¡æœ‰è¿™äº›ç¡®åˆ‡çš„ props å‘¢ï¼Ÿæˆ‘ä»¬çš„é»˜è®¤ props é€»è¾‘å°†æ— æ³•å·¥ä½œï¼Œä¸”æ²¡æœ‰ä¿®å¤çš„æ–¹æ³•ã€‚

---

### ç”¨äºæ¸²æŸ“å…ƒç´ çš„æ¸²æŸ“ props

å¹¸è¿çš„æ˜¯ï¼Œæ­£å¦‚æˆ‘ä¹‹å‰æåˆ°çš„ï¼ŒReact ä¸­æœ‰ä¸€ç™¾ä¸‡ç§æ–¹æ³•å¯ä»¥è§£å†³å®Œå…¨ç›¸åŒçš„é—®é¢˜ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…ƒç´ ä½œä¸ºæ¸²æŸ“ propï¼ˆæˆ–æ¸²æŸ“å‡½æ•°ï¼‰ä¼ é€’ï¼Œè€Œä¸æ˜¯å°†å…¶ä½œä¸º prop ä¼ é€’ã€‚æ¸²æŸ“ prop åªæ˜¯ä¸€ä¸ªè¿”å›å…ƒç´ çš„å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°å‡ ä¹ä¸ç»„ä»¶ç›¸åŒã€‚å”¯ä¸€çš„åŒºåˆ«æ˜¯ï¼Œä½ ä¸ä¼šç›´æ¥è°ƒç”¨ç»„ä»¶â€”â€”React ä¸ºä½ è°ƒç”¨å®ƒã€‚ä½†æ¸²æŸ“å‡½æ•°åˆ™ç”±ä½ æ¥æ§åˆ¶ã€‚

åœ¨æŒ‰é’®åŠå…¶å›¾æ ‡çš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨æ¸²æŸ“å‡½æ•°å°†æ˜¯è¿™æ ·çš„ï¼š

```jsx
// è€Œä¸æ˜¯éœ€è¦ Element çš„ â€œiconâ€
// æˆ‘ä»¬æ­£åœ¨æ¥æ”¶ä¸€ä¸ªè¿”å› Element çš„å‡½æ•°
const Button = ({ renderIcon }) => {
  // ç„¶ååªéœ€åœ¨åº”è¯¥å‘ˆç°å›¾æ ‡çš„ä½ç½®è°ƒç”¨æ­¤å‡½æ•°;
  return <button>Submit {renderIcon()}</button>;
};
```

æˆ‘ä»¬æ¥å—ä¸€ä¸ª renderIcon å‡½æ•°ï¼Œå¹¶åœ¨å›¾æ ‡åº”è¯¥å‡ºç°çš„åœ°æ–¹è°ƒç”¨å®ƒã€‚ç„¶åï¼Œåœ¨æ¶ˆè´¹è€…ä¸€ä¾§ï¼Œæˆ‘ä»¬å°†ä¼ é€’è¿”å›å›¾æ ‡çš„å‡½æ•°ï¼Œè€Œä¸æ˜¯ç›´æ¥ä¼ é€’å›¾æ ‡ï¼š

```jsx
<Button renderIcon={() => <HomeIcon />} />
```

æˆ‘ä»¬å½“ç„¶å¯ä»¥æ ¹æ®éœ€è¦è°ƒæ•´å›¾æ ‡ï¼Œå°±åƒå¤„ç†å¸¸è§„å…ƒç´ ä¸€æ ·ï¼š

```jsx
// red icon
<Button renderIcon={() => <HomeIcon color="red" /> } />
// large icon
<Button renderIcon={() => <HomeIcon size="large" /> } />
```

é‚£ä¹ˆï¼Œä½¿ç”¨è¿™ä¸ªå‡½æ•°çš„æ„ä¹‰ä½•åœ¨ï¼Ÿé¦–å…ˆæ˜¯å›¾æ ‡çš„ propsã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å°†å¯¹è±¡ä¼ é€’ç»™å‡½æ•°ï¼Œè€Œæ— éœ€å…‹éš†å…ƒç´ ï¼Œè¿™æ ·åšè™½ç„¶æœ‰äº›ä¸å¤ªå¦¥å½“ï¼š

```jsx
const Button = ({ appearance, size, renderIcon }) => {
  // åƒä»¥å‰ä¸€æ ·åˆ›å»ºé»˜è®¤ props
  const defaultIconProps = {
    size: size === "large" ? "large" : "medium",
    color: appearance === "primary" ? "white" : "black",
  };
  // ç„¶åå°†å®ƒä»¬ä¼ é€’ç»™å‡½æ•°
  return <button>Submit {renderIcon(defaultIconProps)}</button>;
};
```

ç„¶åï¼Œåœ¨å›¾æ ‡çš„ä¾§é¢ï¼Œæˆ‘ä»¬å¯ä»¥æ¥å—è¿™äº› props å¹¶å°†å®ƒä»¬å±•å¼€åˆ°å›¾æ ‡ä¸Šï¼š

```jsx
<Button renderIcon={(props) => <HomeIcon {...props} />} />
```

æˆ‘ä»¬å¯ä»¥è¦†ç›–å…¶ä¸­ä¸€äº›ï¼š

```jsx
<Button
  renderIcon={(props) => <HomeIcon {...props} size="large" color="red" />}
/>
```

æˆ–è€…å°†å®ƒä»¬è½¬æ¢ä¸ºå›¾æ ‡å®é™…ä¸Šæ¥å—çš„ propsï¼š

```jsx
<Button
  renderIcon={(props) => (
    <HomeIcon fontSize={props.size} style={{ color: props.color }} />
  )}
/>
```

<Callout icon="ğŸ”">

[äº’åŠ¨ç¤ºä¾‹å’Œå®Œæ•´ä»£ç ](https://advanced-react.com/examples/04/01)

</Callout>

ä¸€åˆ‡éƒ½æ˜¯æ˜¾å¼çš„ï¼Œæ²¡æœ‰ä»€ä¹ˆæ˜¯é€šè¿‡éšè—çš„é­”æ³•è¦†ç›–çš„ã€‚æ•°æ®æµè™½ç„¶æœ‰äº›å¾ªç¯ï¼Œä½†å´æ˜¯å¯è§ä¸”å¯è¿½è¸ªçš„ã€‚

![image-20240913160739838](/assets/images/books/advanced-react/props.png)

å…±äº«çŠ¶æ€ä¹Ÿä¸å†æ˜¯é—®é¢˜ã€‚æˆ‘ä»¬å¯ä»¥ç®€å•åœ°å°†è¯¥çŠ¶æ€å€¼åˆå¹¶åˆ°ä¼ é€’ç»™å›¾æ ‡çš„å¯¹è±¡ä¸­ï¼š

```jsx
const Button = ({ appearance, size, renderIcon }) => {
  const [isHovered, setIsHovered] = useState(false);
  const iconParams = {
    size: size === "large" ? "large" : "medium",
    color: appearance === "primary" ? "white" : "black",
    // åœ¨æ­¤å¤„æ·»åŠ çŠ¶æ€ - å®ƒæ¯•ç«Ÿåªæ˜¯ä¸€ä¸ªå¯¹è±¡
    isHovered,
  };
  return <button ...>Submit {renderIcon(iconParams)}</button>;
};
```

æˆ–è€…æˆ‘ä»¬ç”šè‡³å¯ä»¥å°†å…¶ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ä¼ é€’ï¼Œä»¥æ¸…æ™°åœ°åŒºåˆ†çŠ¶æ€å’Œ propsã€‚æ— è®ºå¯¹æˆ‘ä»¬çš„ä»£ç åº“æ¥è¯´ä»€ä¹ˆæ›´æœ‰æ„ä¹‰ï¼š

```jsx
const Button = ({ appearance, size, renderIcon }) => {
  const [isHovered, setIsHovered] = useState(false);
  const iconParams = {
    size: size === "large" ? "large" : "medium",
    color: appearance === "primary" ? "white" : "black",
  };
  // åœ¨æ­¤å¤„å°† state ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ä¼ é€’
  return <Button ...>Submit {renderIcon(iconParams, { isHovered })}</Button>;
};
```

ç„¶ååœ¨å›¾æ ‡ä¾§é¢ï¼Œæˆ‘ä»¬å¯ä»¥å†æ¬¡å¯¹è¿™ä¸ª hovered çŠ¶æ€åšä»»ä½•æˆ‘ä»¬æƒ³åšçš„äº‹æƒ…ã€‚æˆ‘ä»¬å¯ä»¥æ¸²æŸ“å¦ä¸€ä¸ªå›¾æ ‡ï¼š

```jsx
const icon = (props, state) => state.isHovered ? <HomeIconHovered
{...props} /> : <HomeIcon {...props} />
<Button renderIcon={icon} />
```

åº”ç”¨ä¸åŒçš„ classNameï¼š

```jsx
const icon = (props, state) => <HomeIcon {...props} className=
{state.isHovered ? 'hovered' : ''} />
<Button renderIcon={icon} />
```

æˆ–è€…å®Œå…¨å¿½ç•¥å®ƒã€‚

<Callout icon="ğŸ”">
  [äº’åŠ¨ç¤ºä¾‹å’Œå®Œæ•´ä»£ç ](https://advanced-react.com/examples/04/02)
</Callout>

---

### å…±äº«çŠ¶æ€é€»è¾‘ï¼šä½œä¸ºæ¸²æŸ“ props çš„ children

æ¸²æŸ“ props çš„å¦ä¸€ä¸ªæœ‰ç”¨åº”ç”¨æ˜¯å…±äº«ç»„ä»¶ä¹‹é—´çš„çŠ¶æ€é€»è¾‘ï¼Œé€šå¸¸ä¸â€œchildren ä½œä¸º propsâ€æ¨¡å¼ç»“åˆä½¿ç”¨ã€‚æ­£å¦‚åœ¨ä¸Šä¸€ç« ä¸­è®¨è®ºçš„é‚£æ ·ï¼Œâ€œchildrenâ€åœ¨ä½œä¸ºç±»ä¼¼ HTML çš„åµŒå¥—è¯­æ³•ä½¿ç”¨æ—¶ï¼Œä¸è¿‡æ˜¯ä¸€ä¸ª propï¼š

```jsx
<Parent>
 <Child />
</Parent>
// åŒä¸Š
<Parent children={<Child />} />
```

å› æ­¤ï¼Œå®é™…ä¸Šæ²¡æœ‰ä»€ä¹ˆé˜»æ­¢æˆ‘ä»¬å°† children ä¹Ÿä½œä¸ºä¸€ä¸ªå‡½æ•°ã€‚æˆ‘ä»¬ç”šè‡³ä¸å¿…ç”¨ render å‰ç¼€ã€‚renderSomething åªæ˜¯ä¸€ç§å‘½åçº¦å®šã€‚å®ƒå°†çœ‹èµ·æ¥åƒè¿™æ ·ï¼š

```jsx
// ä½¿å…¶æˆä¸ºå‡½æ•°
<Parent children={() => <Child />} />
```

åœ¨ Parent ä¸­ï¼Œä½ å¯ä»¥åƒè°ƒç”¨ä»»ä½•å…¶ä»–æ¸²æŸ“ prop ä¸€æ ·è°ƒç”¨å®ƒï¼š

```jsx
const Parent = ({ children }) => {
  // å®ƒåªæ˜¯ä¸€ä¸ªè¿”å›å…ƒç´ çš„å‡½æ•°ï¼Œåªéœ€è°ƒç”¨å®ƒ
  //è¿™é‡Œ
  return children();
};
```

è¿™ç§æ¼‚äº®çš„åµŒå¥—è¯­æ³•ä¹Ÿå¯ä»¥ä¸æ­¤ä¸€èµ·ä½¿ç”¨ï¼š

```jsx
<Parent>{() => <Child />}</Parent>
```

<Callout icon="ğŸ”">
  [äº’åŠ¨ç¤ºä¾‹å’Œå®Œæ•´ä»£ç ](https://advanced-react.com/examples/04/03)
</Callout>

è¿™ä¸ºä»€ä¹ˆä¼šæœ‰ç”¨ï¼Ÿæƒ³è±¡ä¸€ä¸‹ï¼Œä½ æ­£åœ¨å®ç°ä¸€ä¸ªâ€œå°ºå¯¸æ£€æµ‹å™¨â€ç»„ä»¶ã€‚ä¸€ä¸ªè·Ÿè¸ªæµè§ˆå™¨çª—å£è°ƒæ•´å¤§å°äº‹ä»¶çš„ç»„ä»¶ï¼š

```jsx
const ResizeDetector = () => {
  const [width, setWidth] = useState();
  useEffect(() => {
    const listener = () => {
      const width = window.innerWidth;
      setWidth(width);
    };
    window.addEventListener("resize", listener);
    // ä»£ç çš„å…¶ä½™éƒ¨åˆ†
  }, []);
  return ...;
};
```

ä½ å¸Œæœ›ä½¿å…¶é€šç”¨ï¼Œä»¥ä¾¿åº”ç”¨ä¸­çš„ä¸åŒç»„ä»¶å¯ä»¥è·Ÿè¸ªçª—å£å®½åº¦ï¼Œè€Œæ— éœ€åœ¨æ¯ä¸ªåœ°æ–¹å®ç°è¯¥ä»£ç ã€‚å› æ­¤ï¼ŒResizeDetector éœ€è¦ä»¥æŸç§æ–¹å¼ä¸å…¶ä»–ç»„ä»¶å…±äº«è¯¥çŠ¶æ€ã€‚æŠ€æœ¯ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ props æ¥å®ç°ï¼Œä»…éœ€å°† onWidthChange prop æ·»åŠ åˆ°æ£€æµ‹å™¨ï¼š

```jsx
const ResizeDetector = ({ onWidthChange }) => {
  const [width, setWidth] = useState();
  useEffect(() => {
    const listener = () => {
      const width = window.innerWidth;
      setWidth(width);
      // åœ¨æ­¤å¤„è§¦å‘ onWidthChange å±æ€§
      onWidthChange(width);
    };
    window.addEventListener("resize", listener);
    // ä»£ç çš„å…¶ä½™éƒ¨åˆ†
  }, []);
  return ...;
};
```

ä½†è¿™æ„å‘³ç€ä»»ä½•æƒ³è¦ä½¿ç”¨å®ƒçš„ç»„ä»¶å¿…é¡»ç»´æŠ¤è‡ªå·±çš„çŠ¶æ€ï¼š

```jsx
const Layout = () => {
  const [windowWidth, setWindowWidth] = useState(0);
  return (
    <>
      <ResizeDetector onWindowWidth={setWindowWidth} />
      {windowWidth > 600 ? <WideLayout /> : <NarrowLayout />}
    </>
  );
};
```

è¿™æœ‰ç‚¹æ‚ä¹±ã€‚

æˆ‘ä»¬å¯ä»¥åšçš„æ›¿ä»£æ–¹æ¡ˆæ˜¯è®© ResizeDetector æ¥å— children ä½œä¸ºä¸€ä¸ªå‡½æ•°ï¼Œå¹¶ç›´æ¥å°†å®½åº¦ä¼ é€’ç»™ childrenï¼š

```jsx
const ResizeDetector = ({ children }) => {
  const [width, setWidth] = useState();
  //ä¸ä¹‹å‰çš„ä»£ç ç›¸åŒ
  //å°†å®½åº¦ä¼ é€’ç»™å­é¡¹
  return children(width);
};
```

ç„¶åï¼Œä»»ä½•éœ€è¦è¯¥å®½åº¦çš„ç»„ä»¶éƒ½å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œè€Œæ— éœ€ä¸ºæ­¤å¼•å…¥ä¸å¿…è¦çš„çŠ¶æ€ï¼š

```jsx
const Layout = () => {
  return (
    <ResizeDetector>
      {(windowWidth) => {
        //ä¸å†æœ‰çŠ¶æ€ï¼ç›´æ¥ä»è°ƒæ•´å¤§å°å™¨ä¸­è·å–
        return windowWidth > 600 ? <WideLayout /> : <NarrowLayout />;
      }}
    </ResizeDetector>
  );
};
```

<Callout icon="ğŸ”">
  [äº’åŠ¨ç¤ºä¾‹å’Œå®Œæ•´ä»£ç ](https://advanced-react.com/examples/04/04)
</Callout>

åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå½“ç„¶æˆ‘ä»¬ä¼šåœ¨è¿™é‡Œé‡åˆ°é‡æ–°æ¸²æŸ“çš„é—®é¢˜ï¼šæ¯æ¬¡å®½åº¦å˜åŒ–éƒ½ä¼šè§¦å‘çŠ¶æ€æ›´æ–°ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¿…é¡»åœ¨æ£€æµ‹å™¨å†…éƒ¨è®¡ç®—å¸ƒå±€æˆ–è¿›è¡Œé˜²æŠ–å¤„ç†ã€‚ä½†å…±äº«çŠ¶æ€çš„åŸåˆ™å°†ä¿æŒä¸å˜ã€‚

æ­¤å¤–ï¼Œåœ¨ç°ä»£ä»£ç ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½æ ¹æœ¬ä¸ä¼šä½¿ç”¨è¿™ä¸€ç‚¹ï¼Œå› ä¸ºâ€¦â€¦

hooks å–ä»£äº†æ¸²æŸ“ propsã€‚

åœ¨è¿‡å»ä¸¤å¹´ä¸­ï¼Œæœ‰äººä»äº‹ React ç¼–ç æ—¶ï¼Œå¯èƒ½ä¼šæƒ³ï¼šâ€œå˜¿ï¼Œä½ æ‰€è¯´çš„å¹¶æ²¡æœ‰æ„ä¹‰ã€‚ä¸ºä»€ä¹ˆè¦åšè¿™ä¹ˆå¤æ‚çš„äº‹æƒ…ï¼Œå½“æˆ‘ä»¬æœ‰ hooks å¯ä»¥å…±äº«çŠ¶æ€é€»è¾‘ï¼Ÿâ€

ä½ å®Œå…¨æ­£ç¡®ï¼åœ¨å‡ ä¹ 99% çš„æƒ…å†µä¸‹ï¼Œhooks å–ä»£äº†è¿™ä¸€æ¨¡å¼ã€‚è€Œä¸”è¿™æ˜¯æœ‰ç†ç”±çš„ã€‚å®Œå…¨ç›¸åŒçš„ç”¨ä¾‹å¯ä»¥ç”¨ hooks è¿™æ ·é‡å†™ï¼š

```jsx
const useResizeDetector = () => {
  const [width, setWidth] = useState();
  useEffect(() => {
    const listener = () => {
       const width = ... // get window width here
      setWidth(width);
    };
    window.addEventListener("resize", listener);
    // the rest of the code
  }, []);
  return width;
};
```

åªéœ€å°† ResizeDetector ç»„ä»¶çš„æ•´ä¸ªé€»è¾‘æå–ä¸ºä¸€ä¸ª hookï¼Œç„¶ååœ¨ä»»ä½•åœ°æ–¹ä½¿ç”¨ï¼š

```jsx
const Layout = () => {
  const windowWidth = useResizeDetector();
  return windowWidth > 600 ? <WideLayout /> : <NarrowLayout />;
};
```

<Callout icon="ğŸ”">
  [äº’åŠ¨ç¤ºä¾‹å’Œå®Œæ•´ä»£ç ](https://advanced-react.com/examples/04/05)
</Callout>

æ›´å°‘çš„ä»£ç ï¼Œæ›´å®¹æ˜“ç†è§£å‘ç”Ÿäº†ä»€ä¹ˆã€‚

é‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆè¿˜è¦å­¦ä¹ è¿™ä¸ªæ¨¡å¼å‘¢ï¼Ÿæœ‰å‡ ä¸ªåŸå› ï¼š

- ä¹‹å‰æè¿°çš„ç”¨äºé…ç½®å’Œçµæ´»æ€§çš„æ¸²æŸ“ props ç”¨ä¾‹ä»ç„¶éå¸¸å¯è¡Œã€‚
- å¦‚æœä½ åœ¨ä¸€ä¸ªå‡ å¹´å‰çš„é¡¹ç›®ä¸­å·¥ä½œï¼Œè¿™ç§æ¨¡å¼å°†åœ¨ä»£ç åº“ä¸­éšå¤„å¯è§ã€‚åœ¨å¼•å…¥ hooks ä¹‹å‰ï¼Œå®ƒç¡®å®éå¸¸æµè¡Œï¼Œç‰¹åˆ«æ˜¯åœ¨å°è£…è¡¨å•éªŒè¯é€»è¾‘æ–¹é¢ã€‚ä¸€äº›æµè¡Œçš„åº“è‡³ä»Šä»åœ¨ä½¿ç”¨å®ƒã€‚
- å¯¹äºç‰¹å®šåœºæ™¯ï¼Œå®ƒä»ç„¶å¾ˆæœ‰ç”¨ï¼Œä¾‹å¦‚ï¼Œå½“ä½ æƒ³è¦å…±äº«çš„é€»è¾‘å’ŒçŠ¶æ€ä¾èµ–äº DOM å…ƒç´ æ—¶ã€‚

æœ€åä¸€ä¸ªç”¨ä¾‹çš„ä¸€ä¸ªéå¸¸å¸¸è§çš„ä¾‹å­æ˜¯è·Ÿè¸ªåŒºåŸŸä¸­çš„æ»šåŠ¨ï¼š

```jsx
const ScrollDetector = ({ children }) => {
  const [scroll, setScroll] = useState();
  return (
    <div onScroll={(e) => setScroll(e.currentTarget.scrollTop)}>{children}</div>
  );
};
```

æ­£æ˜¯ä¸ä¹‹å‰ç›¸åŒçš„æƒ…å†µï¼šä½ æœ‰ä¸€äº›å€¼ï¼Œå¹¶å¸Œæœ›ä¸å…¶ä»–ç»„ä»¶å…±äº«è¯¥å€¼ã€‚å†æ¬¡ï¼Œä½¿ç”¨ props ä¼šæ˜¾å¾—æ‚ä¹±ã€‚

è€Œå°†å…¶æå–ä¸ºä¸€ä¸ª hook å¹¶ä¸ä¼šåƒä»¥å‰é‚£æ ·ç®€å•ï¼šè¿™æ¬¡ä½ éœ€è¦å°† onScroll ç›‘å¬å™¨é™„åŠ åˆ°ä¸€ä¸ª divï¼Œè€Œä¸æ˜¯ windowã€‚å› æ­¤ï¼Œä½ éœ€è¦å¼•å…¥ä¸€ä¸ª Ref è¿›è¡Œä¼ é€’ï¼ˆå…³äº Refs çš„æ›´å¤šå†…å®¹è¯·å‚è§ç¬¬ä¹ç« ï¼šRefsï¼šä»å­˜å‚¨æ•°æ®åˆ°å‘½ä»¤å¼ APIï¼‰ã€‚æˆ–è€…ä»…ä½¿ç”¨æ¸²æŸ“ prop æ¨¡å¼ï¼š

```jsx
const ScrollDetector = ({ children }) => {
  const [scroll, setScroll] = useState();
  return (
    <div onScroll={(e) => setScroll(e.currentTarget.scrollTop)}>
      {children(scroll)}
    </div>
  );
};
```

åœ¨éœ€è¦æ ¹æ®ç”¨æˆ·æ»šåŠ¨çš„å¤šå°‘è¿›è¡Œæ“ä½œçš„åœ°æ–¹ä½¿ç”¨å®ƒï¼š

```jsx
const Layout = () => {
  return (
    <ScrollDetector>
      {(scroll) => {
        return <>{scroll > 30 ? <SomeBlock /> : null}</>;
      }}
    </ScrollDetector>
  );
};
```

---

### å…³é”®è¦ç‚¹

å¸Œæœ›è¿™ä¸€åˆ‡éƒ½èƒ½è®©ä½ æ˜ç™½ï¼Œè¿™ä¸ªæ¨¡å¼ç°åœ¨æ¸…æ™°æ˜äº†ã€‚ä»è¿™ä¸€ç« ä¸­éœ€è¦è®°ä½çš„å‡ ä»¶äº‹ï¼š

å¦‚æœä¸€ä¸ªå…·æœ‰å…ƒç´ ä½œä¸º props çš„ç»„ä»¶å¸Œæœ›æ§åˆ¶è¿™äº›å…ƒç´ çš„ props æˆ–å°†çŠ¶æ€ä¼ é€’ç»™å®ƒä»¬ï¼Œåˆ™éœ€è¦å°†è¿™äº›å…ƒç´ è½¬æ¢ä¸ºæ¸²æŸ“ propsï¼š

```jsx
const Button = ({ renderIcon }) => {
 const [someState, setSomeState] = useState()
 const someProps = { ... };
 return <button>Submit {renderIcon(someProps, someState)}
</button>;
                    };
<Button renderIcon={(props, state) => <IconComponent {...props}
someProps={state} /> } />

```

children ä¹Ÿå¯ä»¥æ˜¯æ¸²æŸ“ propsï¼ŒåŒ…æ‹¬â€œåµŒå¥—â€è¯­æ³•ã€‚

```jsx
const Parent = ({ children }) => {
  return children(somedata);
};
```

å½“æˆ‘ä»¬éœ€è¦åœ¨ç»„ä»¶ä¹‹é—´å…±äº«çŠ¶æ€é€»è¾‘è€Œä¸æå‡å®ƒæ—¶ï¼Œæ¸²æŸ“ props éå¸¸æœ‰ç”¨ã€‚

ä½†åœ¨ 99% çš„æƒ…å†µä¸‹ï¼Œhooks å–ä»£äº†è¿™ä¸€ç”¨ä¾‹ã€‚

ç”¨äºå…±äº«çŠ¶æ€é€»è¾‘å’Œæ•°æ®çš„æ¸²æŸ“ props ä»Šå¤©ä»ç„¶å¯èƒ½æœ‰ç”¨ï¼Œä¾‹å¦‚ï¼Œå½“è¿™äº›é€»è¾‘ä¸ DOM å…ƒç´ ç›¸å…³è”æ—¶ã€‚
