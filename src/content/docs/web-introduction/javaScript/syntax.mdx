---
title: åŸºæœ¬è¯­æ³•
description: ''
slug: web-introduction/javaScript/syntax
---

### å‡½æ•°

**å‡½æ•°å£°æ˜å’Œå‡½æ•°è¡¨è¾¾å¼**

å‡½æ•°å£°æ˜

```js
function foo() {
  console.log(`fooå‡½æ•°`)
}
```

å‡½æ•°è¡¨è¾¾å¼

```js
var foo = function () {
  console.log(`fooå‡½æ•°`)
}
```

åŒºåˆ« : **å‡½æ•°å£°æ˜ä¼šè¢«æå‡åˆ°å®ƒæ‰€åœ¨ä½œç”¨åŸŸçš„é¡¶éƒ¨**ï¼Œå¯ä»¥åœ¨å‡½æ•°å£°æ˜ä¹‹å‰è°ƒç”¨è¯¥å‡½æ•°ã€‚è€Œå‡½æ•°è¡¨è¾¾å¼ä¸ä¼šã€‚

```js
bar() //barå‡½æ•°
foo() //Uncaught TypeError: foo is not a function

//å‡½æ•°è¡¨è¾¾å¼ä¸ä¼šè¢«æå‡ åœ¨é¡µé¢æ‰§è¡Œjsæ–‡ä»¶åˆæ¬¡æ‰«ææ—¶åˆ›å»ºçš„åˆ™æ˜¯ä¸€ä¸ªfooå˜é‡ ä¼šå°†fooåˆ›å»ºå¹¶èµ‹å€¼ä¸ºundefined  æ‰€ä»¥å½“ä¸Šé¢fooæ‰§è¡Œæ—¶å®é™…ä¸ºundefined () æ‰€ä»¥æŠ¥é”™ä¸ºundefinedä¸æ˜¯ä¸€ä¸ªå¯æ‰§è¡Œå‡½æ•°
var foo = function () {
  console.log(`fooå‡½æ•°`)
}

//å‡½æ•°å£°æ˜æå‡ å½“é¡µé¢æ‰§è¡Œjsæ–‡ä»¶æ—¶ä¼šåˆæ¬¡æ‰«æä¸€é åœ¨ä¸Šé¢bar()æ‰§è¡Œæ—¶è¿™ä¸ªå‡½æ•°å°±å·²ç»è¢«åˆ›å»ºäº†
function bar() {
  console.log(`barå‡½æ•°`)
}
```

**å›è°ƒå‡½æ•°å’ŒåŒ¿åå‡½æ•°**

å›è°ƒå‡½æ•°:é€šè¿‡å‚æ•°ä¼ é€’ç»™å¦ä¸€ä¸ªå‡½æ•°ï¼Œå¹¶åœ¨æŸä¸ªäº‹ä»¶æˆ–æ¡ä»¶å‘ç”Ÿåè¢«è°ƒç”¨çš„å‡½æ•°ã€‚

```js
//æ­¤æ—¶callbackå³ä¸ºä¸€ä¸ªå›è°ƒå‡½æ•°
function request(url, callback) {
  console.log(`è¯·æ±‚${url}æ•°æ®....`)

  //è·å–åˆ°æ•°æ®
  var res = 'æˆ‘æ˜¯è¯·æ±‚ç»“æœ'

  //å›è°ƒå‡½æ•° - è¯·æ±‚åˆ°æ•°æ®åæ‰§è¡Œå‡½æ•°
  callback(res)
}
```

åŒ¿åå‡½æ•°:é¡¾åæ€ä¹‰ï¼Œæ˜¯æ²¡æœ‰åç§°çš„å‡½æ•°ã€‚å®ƒä»¬å¯ä»¥åœ¨éœ€è¦å‡½æ•°ä½†ä¸éœ€è¦å‡½æ•°åç§°æ—¶ä½¿ç”¨ã€‚

```js
//ç¬¬äºŒä¸ªå®å‚å³ä¸ºåŒ¿åå‡½æ•°
request('xxxx', function (res) {
  console.log('æ‰“å°è¯·æ±‚ç»“æœ:' + res)
})
```

**ç«‹å³æ‰§è¡Œå‡½æ•°**

ç«‹å³æ‰§è¡Œå‡½æ•°:æ˜¯ä¸€ç§åœ¨å®šä¹‰åç«‹å³æ‰§è¡Œçš„ JavaScript å‡½æ•°ã€‚é€šå¸¸ç”¨æ¥åˆ›å»ºä¸€ä¸ªç‹¬ç«‹çš„ä½œç”¨åŸŸï¼Œè¿™æ ·åœ¨å…¶ä¸­å®šä¹‰çš„å˜é‡å°±ä¸ä¼šæ±¡æŸ“åˆ°å…¨å±€ä½œç”¨åŸŸï¼Œéå¸¸é€‚åˆç”¨æ¥åˆå§‹åŒ–ä»£ç æˆ–åˆ›å»ºç‹¬ç«‹çš„ä»£ç å—ï¼Œä»¥é¿å…å˜é‡å†²çªã€‚

```js
//æ™®é€šç«‹å³æ‰§è¡Œå‡½æ•° (function...)() ç¬¬ä¸€ä¸ª()è¡¨ç¤ºå°æ‹¬å·å†…å®¹ä¸ºä¸€ä¸ªæ•´ä½“ ç¬¬äºŒä¸ª()ä¸ºæ‰§è¡Œå‡½æ•°
;(function () {
  console.log('ç«‹å³æ‰§è¡Œå‡½æ•°...')
})()

//å¸¦æœ‰å‚æ•°å’Œè¿”å›å€¼çš„ç«‹å³æ‰§è¡Œå‡½æ•°
var res = (function (age) {
  console.log('ç«‹å³æ‰§è¡Œå‡½æ•°...å‚æ•°ä¸º:' + age)

  return 10 + age
})(20)

console.log(res) //30
```

åœ¨ç«‹å³æ‰§è¡Œå‡½æ•°å†…éƒ¨å£°æ˜çš„ä»»ä½•å˜é‡éƒ½ä¸ä¼šå½±å“åˆ°å…¨å±€ä½œç”¨åŸŸï¼Œå› ä¸ºç«‹å³æ‰§è¡Œå‡½æ•°æœ¬èº«å°±æ˜¯ä¸€ä¸ªå‡½æ•°ä½œç”¨åŸŸã€‚

**ç®­å¤´å‡½æ•°**

ç®­å¤´å‡½æ•° : JavaScript ä¸­å¼•å…¥çš„ä¸€ä¸ªè¾ƒæ–°çš„åŠŸèƒ½ï¼Œå®ƒæä¾›äº†ä¸€ç§æ›´ç®€æ´çš„æ–¹å¼æ¥å†™å‡½æ•°ã€‚

```js
//æ™®é€šå‡½æ•°ä¹¦å†™æ–¹å¼
function foo() {
  console.log('æ™®é€šå‡½æ•°')
}

//ç®­å¤´å‡½æ•°ä¹¦å†™æ–¹å¼
var bar = () => {
  console.log('ç®­å¤´å‡½æ•°')
}
```

æ™®é€šå‡½æ•°ä¸ç®­å¤´å‡½æ•°çš„åŒºåˆ«:

1. æ›´åŠ ç®€æ´çš„å‡½æ•°è¯­æ³•

```js
//ç®­å¤´å‡½æ•°
var foo = () => {
  console.log('ç®­å¤´å‡½æ•°')
}

//å¦‚æœå‚æ•°åªæœ‰ä¸€ä¸ª ()å¯ä»¥çœç•¥
var bar = (name) => {
  console.log('ç®­å¤´å‡½æ•°', name)
}
//å¦‚æœå‡½æ•°å†…åªæœ‰ä¸€è¡Œæ‰§è¡Œä»£ç  {}å¯ä»¥çœç•¥
var bar1 = (name) => console.log('ç®­å¤´å‡½æ•°', name)

//å¦‚æœåªæœ‰ä¸€è¡Œä»£ç ,è¿™è¡Œä»£ç çš„ç»“æœä¼šä½œä¸ºå‡½æ•°çš„è¿”å›å€¼é»˜è®¤è¿”å›
var add = (num1, num2) => num1 + num2
console.log(add(10, 20)) //30

//å¦‚æœé»˜è®¤è¿”å›å€¼æ˜¯ä¸€ä¸ªå¯¹è±¡,å¿…é¡»åŠ ä¸Š()
var fn = () => ({ name: 'zs' })
console.log(fn()) // {name :'zs'}
```

2. æ²¡æœ‰è‡ªå·±çš„ this : åœ¨ç®­å¤´å‡½æ•°ä¸­ï¼Œ`this`å…³é”®å­—æŒ‡å‘çš„æ˜¯å®ƒè¢«åˆ›å»ºæ—¶çš„ä¸Šä¸‹æ–‡ï¼ˆå³å¤–å±‚å‡½æ•°æˆ–å…¨å±€ä¸Šä¸‹æ–‡ï¼‰ã€‚è¿™ä¸ä¼ ç»Ÿå‡½æ•°ä¸åŒï¼Œä¼ ç»Ÿå‡½æ•°çš„`this`æŒ‡å‘åœ¨å‡½æ•°è¢«è°ƒç”¨æ—¶ç¡®å®šã€‚

```js
//ç®­å¤´å‡½æ•°
var foo = () => {
  console.log('ç®­å¤´å‡½æ•°', this) //this = window
}

//thiså¼•ç”¨ä¸Šå±‚ä½œç”¨åŸŸçš„this
var obj = {
  name: 'test',
  bar() {
    var fn = () => {
      console.log('ç®­å¤´å‡½æ•°', this) //this = window
    }
    fn()
  },
}

obj.bar() //obj:{name:'test',bar...}
```

3. ä¸ç»‘å®š arguments å¯¹è±¡ : ç®­å¤´å‡½æ•°å†…éƒ¨æ²¡æœ‰`arguments`å¯¹è±¡ï¼Œå¦‚æœä½ éœ€è¦è®¿é—®å‡½æ•°çš„å‚æ•°åˆ—è¡¨ï¼Œå¯ä»¥ä½¿ç”¨å‰©ä½™å‚æ•°è¯­æ³•`...args`ã€‚

```js
function bar(name, age) {
  console.log('arguments', arguments) //Arguments[]
}

var foo = (name, ...args) => {
  // console.log('arguments', arguments) //test.html:23 Uncaught ReferenceError: arguments is not defined
  console.log(name, ...args) // zs 19
}
```

4. ä¸èƒ½ç”¨ä½œæ„é€ å‡½æ•° : ç”±äºç®­å¤´å‡½æ•°æ²¡æœ‰è‡ªå·±çš„`this`ï¼Œå®ƒä»¬ä¸èƒ½ç”¨ä½œæ„é€ å‡½æ•°ã€‚å¦‚æœä½ å°è¯•ä½¿ç”¨`new`å…³é”®å­—è°ƒç”¨ç®­å¤´å‡½æ•°ï¼Œä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚

5. æ²¡æœ‰ prototype å±æ€§ : ç®­å¤´å‡½æ•°æ²¡æœ‰`prototype`å±æ€§ï¼Œå› ä¸ºå®ƒä»¬ä¸é€‚åˆç”¨æ¥æ„é€ å¯¹è±¡ã€‚

{/* todo */}
[å¸¸è§é¢è¯•é¢˜:ä¸ºä»€ä¹ˆè¦æœ‰ç®­å¤´å‡½æ•°ï¼Ÿ](https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/p)

**çº¯å‡½æ•°**

çº¯å‡½æ•° : ç›¸åŒçš„è¾“å…¥ï¼Œæ€»æ˜¯ä¼šçš„åˆ°ç›¸åŒçš„è¾“å‡ºï¼Œå¹¶ä¸”åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­æ²¡æœ‰ä»»ä½•å‰¯ä½œç”¨(ä¸ä¼šå¯¹å‚¨å­˜çš„å˜é‡äº§ç”Ÿå½±å“)ã€‚

ä¼˜ç‚¹:

1. å¯é¢„æµ‹æ€§ï¼šç”±äºçº¯å‡½æ•°å¯¹åŒæ ·çš„è¾“å…¥æ€»æ˜¯äº§ç”Ÿç›¸åŒçš„è¾“å‡ºï¼Œå®ƒä»¬çš„è¡Œä¸ºæ˜¯å®Œå…¨å¯é¢„æµ‹çš„ï¼Œè¿™ä½¿å¾—ç¨‹åºçš„è°ƒè¯•å’Œæµ‹è¯•å˜å¾—æ›´åŠ å®¹æ˜“ã€‚

2. æ›´å°‘çš„é”™è¯¯ï¼šç”±äºçº¯å‡½æ•°ä¸ä¿®æ”¹å¤–éƒ¨çŠ¶æ€ï¼Œå®ƒä»¬ä¸ä¼šå› ä¸ºå¤–éƒ¨å˜é‡çš„æ”¹å˜è€Œå¯¼è‡´æ„å¤–çš„è¡Œä¸ºå˜åŒ–ï¼Œä»è€Œå‡å°‘äº†ç¨‹åºä¸­çš„é”™è¯¯ã€‚

3. æ›´å¥½çš„å¯é‡ç”¨æ€§ï¼šçº¯å‡½æ•°ç”±äºä¸ä¾èµ–äºå¤–éƒ¨çŠ¶æ€ï¼Œå› æ­¤å®ƒä»¬æ›´å®¹æ˜“è¢«é‡ç”¨äºå…¶ä»–éƒ¨åˆ†çš„ç¨‹åºä¸­ï¼Œæ— è®ºå¤–éƒ¨ç¯å¢ƒå¦‚ä½•å˜åŒ–ã€‚

**arguments**

åœ¨ JavaScript å‡½æ•°å†…éƒ¨ï¼Œ`arguments`æ˜¯ä¸€ä¸ªç±»æ•°ç»„å¯¹è±¡ï¼Œå®ƒåŒ…å«äº†ä¼ é€’ç»™å‡½æ•°çš„æ‰€æœ‰å‚æ•°ã€‚æ˜¯æ‰€æœ‰ï¼ˆéç®­å¤´ï¼‰å‡½æ•°ä¸­éƒ½å¯ç”¨çš„**å±€éƒ¨å˜é‡**ã€‚

```js
function foo(name, age) {
  //è·å–argumentså±æ€§
  console.log(arguments)
  //2 å‚æ•°æ•°é‡
  console.log(arguments.length)
}

foo('xxx', 11)
```

<Callout icon="âš ï¸" type="warning">
  æ³¨:å‚æ•°å¸¦æœ‰é»˜è®¤å€¼å¹¶ä¸”è°ƒç”¨å‚æ•°æ²¡æœ‰è¿›è¡Œä¼ å€¼å°†ä¸ä¼šè¢«è®¡ç®—åœ¨argumentsä¸­
</Callout>

arguments è½¬æˆæ•°ç»„çš„å‡ ç§æ–¹å¼

`arguments`æ˜¯ä¸€ä¸ªç±»æ•°ç»„å¯¹è±¡ï¼Œå®ƒåŒ…å«äº†ä¼ é€’ç»™å‡½æ•°çš„æ‰€æœ‰å‚æ•°ã€‚å°½ç®¡å®ƒçœ‹èµ·æ¥å’Œæ•°ç»„å¾ˆç›¸ä¼¼ï¼Œä½†`arguments`å¹¶ä¸æ˜¯ä¸€ä¸ªçœŸæ­£çš„æ•°ç»„ï¼Œå› æ­¤å®ƒæ²¡æœ‰æ•°ç»„åŸå‹ä¸Šçš„æ–¹æ³•ï¼Œæ¯”å¦‚`map`ã€`slice`ç­‰ã€‚

1. éå†

```js
var arr = []
function foo(name, age) {
  for (var arg of arguments) {
    arr.push(arg)
  }
}
```

2. ES6 ä¸­çš„æ–¹å¼

```js
const args = Array.from(arguments)
const args = [...arguments]
```

3. ä½¿ç”¨`slice`å‡½æ•°æ›´æ”¹ this æŒ‡å‘

```js
var args = [].slice.apply(arguments)
```

<Callout icon="âš ï¸" type="warning">
  æ³¨:è¿™ç§åšæ³•åœ¨æŸäº› JavaScript å¼•æ“ï¼ˆä¾‹å¦‚ V8ï¼ŒChrome å’Œ Node.js çš„åº•å±‚å¼•æ“ï¼‰ä¸­ä¼šé˜»æ­¢æŸäº›ä¼˜åŒ–ã€‚åŸå› æ˜¯ï¼Œè¿™ç§æ“ä½œè¦æ±‚å¼•æ“å¯¹å‡½æ•°çš„å‚æ•°è¿›è¡Œç‰¹åˆ«å¤„ç†ï¼Œå¯èƒ½ä¼šå¯¼è‡´å‡½æ•°æ‰§è¡Œæ•ˆç‡é™ä½ã€‚

å¦‚æœä½ å…³å¿ƒä»£ç çš„æ€§èƒ½ï¼Œå»ºè®®é€šè¿‡éå†`arguments`å¯¹è±¡æ¥æ‰‹åŠ¨æ„å»ºä¸€ä¸ªæ–°çš„æ•°ç»„ï¼Œè€Œä¸æ˜¯ä½¿ç”¨`slice`ã€‚è¿™æ ·å¯ä»¥é¿å…é˜»ç¢å¼•æ“ä¼˜åŒ–çš„é—®é¢˜ã€‚

</Callout>

å¦å¤–ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨`Array`æ„é€ å‡½æ•°ä½œä¸ºä¸€ä¸ªå‡½æ•°ï¼Œé…åˆ`apply`æ–¹æ³•æ¥è¾¾åˆ°åŒæ ·çš„ç›®çš„ã€‚æˆ–è€…é‡‡ç”¨ä¸Šè¿°ç¬¬äºŒç§æ–¹å¼ã€‚

```js
var args = Array.apply(null, arguments)
```

---

### Object

Object æ˜¯ JavaScript çš„ä¸€ç§æ•°æ®ç±»å‹ã€‚å®ƒç”¨äºå­˜å‚¨å„ç§é”®å€¼é›†åˆå’Œæ›´å¤æ‚çš„å®ä½“ã€‚å¯ä»¥é€šè¿‡ Object() æ„é€ å‡½æ•°æˆ–è€…ä½¿ç”¨å¯¹è±¡å­—é¢é‡çš„æ–¹å¼åˆ›å»ºå¯¹è±¡ã€‚

**å¸¸è§åˆ›å»º Object çš„å‡ ç§æ–¹å¼**

1. å¯¹è±¡å­—é¢é‡ : æœ€ç›´æ¥çš„åˆ›å»ºå¯¹è±¡æ–¹å¼ã€‚é€‚ç”¨äºåˆ›å»ºå•ä¸ªå¯¹è±¡ï¼Œç®€æ´æ˜äº†ã€‚

```js
var obj = {
  name: 'Alice',
  age: 30,
  sayHello: function () {
    console.log('Hello, ' + this.name)
  },
}
```

2. æ„é€ å‡½æ•° : ä½¿ç”¨`new`å…³é”®å­—å’Œæ„é€ å‡½æ•°æ¥åˆ›å»ºå¯¹è±¡ã€‚é€‚ç”¨äºåˆ›å»ºå¤šä¸ªç»“æ„ç›¸åŒçš„å¯¹è±¡ã€‚

```js
function Person(name, age) {
  this.name = name
  this.age = age
  this.sayHello = function () {
    console.log('Hello, ' + this.name)
  }
}

var person1 = new Person('Bob', 25)
var person2 = new Person('Carol', 28)
```

3. Object.create()æ–¹æ³• : é€šè¿‡æŒ‡å®šåŸå‹å¯¹è±¡å’Œå±æ€§æ¥åˆ›å»ºæ–°å¯¹è±¡ã€‚æä¾›äº†ä¸€ç§æ›´çµæ´»çš„æ–¹å¼æ¥è®¾ç½®å¯¹è±¡çš„åŸå‹ã€‚

```js
const person = {
  isHuman: false,
  printIntroduction: function () {
    console.log(`My name is ${this.name}. Am I human? ${this.isHuman}`)
  },
}

const me = Object.create(person)

me.name = 'Matthew'
me.isHuman = true

me.printIntroduction()
```

4. class ç±» : ä½¿ç”¨`class`å…³é”®å­—å®šä¹‰ç±»ï¼Œç„¶åé€šè¿‡`new`åˆ›å»ºå®ä¾‹ã€‚

```js
class Person {
  constructor(name, age) {
    this.name = name
    this.age = age
  }

  sayHello() {
    console.log('Hello, ' + this.name)
  }
}

var person = new Person('Eve', 32)
```

**é€šè¿‡ new å…³é”®å­—å…³é”®å¯¹è±¡ä¼šå‘ç”Ÿä»€ä¹ˆ?**

1. **åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡**ï¼šJavaScript ä¼šåˆ›å»ºä¸€ä¸ªå…¨æ–°çš„ç©ºå¯¹è±¡ã€‚
2. **è®¾ç½®åŸå‹**ï¼šæ–°åˆ›å»ºçš„å¯¹è±¡çš„`[[Prototype]]`è¢«é“¾æ¥åˆ°æ„é€ å‡½æ•°çš„`prototype`å¯¹è±¡ä¸Šã€‚è¿™æ„å‘³ç€æ–°å¯¹è±¡å¯ä»¥è®¿é—®æ„é€ å‡½æ•°åŸå‹ä¸Šçš„å±æ€§å’Œæ–¹æ³•ã€‚
3. **ç»‘å®š this å€¼**ï¼šåœ¨æ„é€ å‡½æ•°ä¸­ï¼Œ`this`å…³é”®å­—æŒ‡å‘æ–°åˆ›å»ºçš„å¯¹è±¡ï¼Œå…è®¸ä½ å°†å±æ€§å’Œæ–¹æ³•æ·»åŠ åˆ°è¿™ä¸ªå¯¹è±¡ä¸Šã€‚
4. **è¿”å›æ–°å¯¹è±¡**ï¼šå¦‚æœæ„é€ å‡½æ•°æ²¡æœ‰è¿”å›å…¶ä»–å¯¹è±¡ï¼Œè°ƒç”¨`new`è¡¨è¾¾å¼ä¼šè‡ªåŠ¨è¿”å›è¿™ä¸ªæ–°åˆ›å»ºçš„å¯¹è±¡ã€‚

**å±æ€§æè¿°ç¬¦**

ç”¨äºå®šä¹‰å’Œæ§åˆ¶å¯¹è±¡ä¸­å±æ€§çš„è¡Œä¸ºã€‚æ¯ä¸ªå±æ€§éƒ½æœ‰è‡ªå·±çš„å±æ€§æè¿°ç¬¦,å¯ä»¥é€šè¿‡ **Object.getOwnPropertyDescriptor()** æ–¹æ³•è·å–ã€‚ä¹Ÿå¯ä»¥é€šè¿‡ **Object.defineProperty()** æˆ– **Object.defineProperties()** æ–¹æ³•æ¥ä¿®æ”¹ã€‚

å±æ€§æè¿°ç¬¦åŒ…å«ä»¥ä¸‹ç‰¹æ€§:

- **configurable** :å½“è¯¥å±æ€§çš„å€¼ä¸º `true` æ—¶,å¯¹åº”çš„å±æ€§æè¿°ç¬¦å¯ä»¥è¢«ä¿®æ”¹,å¹¶ä¸”è¯¥å±æ€§ä¹Ÿèƒ½å¤Ÿä»å¯¹åº”çš„å¯¹è±¡ä¸Šè¢«åˆ é™¤ã€‚å½“æˆ‘ä»¬ç›´æ¥åœ¨ä¸€ä¸ªå¯¹è±¡å®šä¹‰å±æ€§æ—¶,è¿™ä¸ªå±æ€§çš„`configurable`ä¸º trueã€‚å½“æˆ‘ä»¬é€šè¿‡`Object.defineProperty()`å®šä¹‰ä¸€ä¸ªå±æ€§æ—¶,è¿™ä¸ªå±æ€§çš„`configurable`ä¸º falseã€‚

- **enumerable** :å½“è¯¥å±æ€§çš„å€¼ä¸º `true` æ—¶,å¯¹åº”çš„å±æ€§å°±å¯ä»¥é€šè¿‡ `for...in` å¾ªç¯æˆ– `Object.keys()` æ–¹æ³•æšä¸¾å‡ºæ¥ã€‚é»˜è®¤å€¼å’Œ`configurable`ä¸€è‡´ã€‚

- **writable** :å½“è¯¥å±æ€§çš„å€¼ä¸º `false` æ—¶,å¯¹åº”çš„å±æ€§å€¼å°±å˜æˆäº†åªè¯»(immutable),æ— æ³•ä¿®æ”¹ã€‚é»˜è®¤å€¼å’Œ`configurable`ä¸€è‡´ã€‚

- **value** :è¯¥å±æ€§å­˜æ”¾å±æ€§çš„å€¼,å¯ä»¥æ˜¯ä»»ä½•æœ‰æ•ˆçš„ JavaScript å€¼ã€‚é»˜è®¤æƒ…å†µä¸‹ä¸º`undefined`ã€‚

- **get** è¯¥å±æ€§å…³è”ä¸€ä¸ªè·å–è®¿é—®å™¨å‡½æ•°(getter),åœ¨è¯»å–å¯¹åº”å±æ€§å€¼æ—¶ä¼šè¢«è°ƒç”¨ã€‚

- **set** è¯¥å±æ€§å…³è”ä¸€ä¸ªè®¾ç½®è®¿é—®å™¨å‡½æ•°(setter),åœ¨å†™å…¥å¯¹åº”å±æ€§å€¼æ—¶ä¼šè¢«è°ƒç”¨ã€‚

```js
let person = {
  name: 'Alice',
}

Object.defineProperty(person, 'age', {
  value: 30,
  writable: false, // age å±æ€§åªè¯»
  enumerable: true,
  configurable: true,
})

console.log(person.age) // è¾“å‡º 30
person.age = 35 // æ— æ•ˆ,å› ä¸º age æ˜¯åªè¯»å±æ€§
console.log(person.age) // ä»ç„¶è¾“å‡º 30

let descriptor = Object.getOwnPropertyDescriptor(person, 'age')
// è¾“å‡º { value: 30, writable: false, enumerable: true, configurable: true }
console.log(descriptor)

const obj = Object.defineProperty({}, 'info', {})
//info : { value: undefined, writable: false, enumerable: false, configurable: false }
console.log(Object.getOwnPropertyDescriptors(obj))
```

**ç±»æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•**

ç±»æ–¹æ³•

```js
function Person(name) {
  this.name = name
}

//å®šä¹‰ç±»æ–¹æ³•
Person.eat = function () {
  console.log('æ¯å¤©éƒ½è¦åƒ')
}

//ç±»æ–¹æ³•è°ƒç”¨
Person.eat() //æ¯å¤©éƒ½è¦åƒ
```

å®ä¾‹æ–¹æ³•

```js
function Person(name) {
  this.name = name
}

//å®šä¹‰å®ä¾‹æ–¹æ³•
Person.prototype.belief = function (belief) {
  console.log(`${this.name}çš„ä¿¡ä»°æ˜¯${belief}`)
}

//å®ä¾‹å¯¹è±¡
var person = new Person('å–½å–½')
//è°ƒç”¨å®ä¾‹æ–¹æ³•
person.belief('éº¦é—¨æ°¸å­˜ ğŸŸ') //å–½å–½çš„ä¿¡ä»°æ˜¯éº¦é—¨æ°¸å­˜ ğŸŸ
```

---

### this

`this`å…³é”®å­—æ˜¯ä¸€ä¸ªæŒ‡å‘å‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡çš„æŒ‡é’ˆï¼Œå®ƒçš„å€¼å–å†³äºå‡½æ•°æ˜¯å¦‚ä½•è¢«è°ƒç”¨çš„ï¼Œè€Œä¸æ˜¯å¦‚ä½•è¢«å®šä¹‰æˆ–å£°æ˜çš„ã€‚

**ç»‘å®šè§„åˆ™**

1. é»˜è®¤ç»‘å®š : å½“å‡½æ•°ç›´æ¥è¢«è°ƒç”¨æ—¶ï¼ˆå³ä¸ä½œä¸ºä»»ä½•å¯¹è±¡çš„æ–¹æ³•æˆ–é€šè¿‡ä»»ä½•æ˜ç¡®çš„ç»‘å®šæ–¹å¼è°ƒç”¨ï¼‰ã€‚

```js
function show() {
  console.log(this)
}
/* 
`this`æŒ‡å‘å…¨å±€å¯¹è±¡ï¼ˆåœ¨æµè§ˆå™¨ä¸­æ˜¯`window`å¯¹è±¡ï¼‰ã€‚
åœ¨ä¸¥æ ¼æ¨¡å¼ï¼ˆ`'use strict'`ï¼‰ä¸‹ï¼Œ`this`ä¼šè¢«è®¾ç½®ä¸º`undefined`ï¼Œä»¥é¿å…ä¸å°å¿ƒä¿®æ”¹å…¨å±€å¯¹è±¡ã€‚
*/
show()
```

2. éšå¼ç»‘å®š : å½“å‡½æ•°ä½œä¸ºå¯¹è±¡çš„æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œ`this`éšå¼åœ°æŒ‡å‘è¿™ä¸ªå¯¹è±¡ã€‚

```js
const obj = {
  value: 'hello',
  show() {
    console.log(this.value)
  },
}
obj.show() // `this`æŒ‡å‘obj
```

3. æ˜¾å¼ç»‘å®š : ä½¿ç”¨`call`ã€`apply`æˆ–`bind`æ–¹æ³•å¯ä»¥æ˜¾å¼åœ°æŒ‡å®š`this`çš„æŒ‡å‘ã€‚

```js
function show() {
  console.log(this.value)
}
const obj = { value: 'hello' }

show.call(obj) // ä½¿ç”¨`call`æ˜¾å¼ç»‘å®š`this`åˆ°`obj`
show.apply(obj) // ä½¿ç”¨`apply`æ˜¾å¼ç»‘å®š`this`åˆ°`obj`
const boundShow = show.bind(obj) // `bind`è¿”å›ä¸€ä¸ªæ–°å‡½æ•°ï¼Œ`this`è¢«ç»‘å®šåˆ°`obj`
boundShow()
```

`call`ã€`apply`å’Œ`bind`éƒ½æ˜¯ JavaScript ä¸­çš„å‡½æ•°æ–¹æ³•ï¼Œç”¨äºæ˜¾å¼åœ°è®¾ç½®å‡½æ•°è°ƒç”¨æ—¶çš„`this`æŒ‡å‘ã€‚å°½ç®¡å®ƒä»¬çš„ç›®çš„ç›¸åŒï¼Œä½†åœ¨å‚æ•°ä¼ é€’å’Œä½¿ç”¨æ–¹å¼ä¸Šæœ‰æ‰€ä¸åŒï¼š

`call`æ–¹æ³•:`call`æ–¹æ³•å…è®¸ä¸ºä¸€ä¸ªå‡½æ•°æŒ‡å®š`this`å€¼ï¼Œå¹¶ä¸”æ¥å—ä¸€ä¸ªå‚æ•°åˆ—è¡¨ã€‚è¯¥æ–¹æ³•ç«‹å³æ‰§è¡Œå‡½æ•°ã€‚

```js
function greet(message, name) {
  console.log(`${message}, ${name}. This is ${this.title}`)
}

const obj = { title: 'Call example' }

// ä½¿ç”¨callï¼Œ`this`è¢«è®¾ç½®ä¸ºobj
greet.call(obj, 'Hello', 'John') // è¾“å‡º: "Hello, John. This is Call example"
```

`apply`æ–¹æ³•:`apply`æ–¹æ³•ä¸`call`æ–¹æ³•éå¸¸ç›¸ä¼¼ï¼ŒåŒºåˆ«åœ¨äº`apply`æ¥å—çš„æ˜¯ä¸€ä¸ªå‚æ•°æ•°ç»„ï¼Œè€Œä¸æ˜¯å‚æ•°åˆ—è¡¨ã€‚è¯¥æ–¹æ³•ä¹Ÿä¼šç«‹å³æ‰§è¡Œå‡½æ•°ã€‚

```js
function greet(message, name) {
  console.log(`${message}, ${name}. This is ${this.title}`)
}

const obj = { title: 'Call example' }

// ä½¿ç”¨applyï¼Œ`this`è¢«è®¾ç½®ä¸ºobj
greet.apply(obj, ['Hello', 'John']) // è¾“å‡º: "Hello, John. This is Call example"
```

`bind`æ–¹æ³•:`bind`æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œ`this`å€¼è¢«è®¾ç½®ä¸ºä¼ ç»™`bind`çš„ç¬¬ä¸€ä¸ªå‚æ•°ã€‚ä¸`call`å’Œ`apply`ä¸åŒï¼Œ`bind`ä¸ä¼šç«‹å³æ‰§è¡Œå‡½æ•°ï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ªæ”¹å˜äº†ä¸Šä¸‹æ–‡`this`çš„æ–°å‡½æ•°ã€‚`bind`ä¹Ÿæ¥å—å‚æ•°åˆ—è¡¨ï¼Œè¿™äº›å‚æ•°å°†è¢«é¢„è®¾åˆ°æ–°å‡½æ•°çš„å‚æ•°ä¸­ã€‚

```js
function greet(message, name) {
  console.log(`${message}, ${name}. This is ${this.title}`)
}

const obj = { title: 'Call example' }

// ä½¿ç”¨callï¼Œ`this`è¢«è®¾ç½®ä¸ºobj
const boundGreet = greet.bind(obj, 'Hello')
boundGreet('John') // è¾“å‡º: "Hello, John. This is Bind example"
```

4. new ç»‘å®š : å½“å‡½æ•°ä½œä¸ºæ„é€ å™¨è¢«`new`å…³é”®å­—è°ƒç”¨æ—¶ï¼Œ`this`è¢«ç»‘å®šåˆ°æ–°åˆ›å»ºçš„å¯¹è±¡ä¸Šã€‚

```js
function Person(name) {
  this.name = name
}
const person = new Person('John')
console.log(person.name) // `this`æŒ‡å‘æ–°åˆ›å»ºçš„`person`å¯¹è±¡
```

**è§„åˆ™ä¼˜å…ˆçº§**

ä»é«˜åˆ°ä½çš„ä¼˜å…ˆçº§æ’åºå¦‚ä¸‹ï¼š

1. new ç»‘å®š
2. bind ç»‘å®š
3. apply/call ç»‘å®š
4. éšå¼ç»‘å®š
5. é»˜è®¤ç»‘å®š

```js
function foo() {
  console.log('fooå‡½æ•°,thisæŒ‡å‘ä¸º:', this)
}

var obj = {
  name: 'test',
  bar: foo,
}

//é»˜è®¤ç»‘å®š éä¸¥æ ¼æ¨¡å¼ä¸‹thisæŒ‡å‘å…¨å±€å˜é‡ ä¸¥æ ¼æ¨¡å¼ä¸‹thisä¸ºundefined
foo() //Window

//éšå¼ç»‘å®š
obj.bar() //obj

//æ˜¾å¼ç»‘å®š
foo.apply('abc') //String

//newç»‘å®š
new foo() //æ–°åˆ›å»ºçš„å¯¹è±¡foo

//éšå¼ç»‘å®šä¼˜å…ˆçº§æ¯”é»˜è®¤ç»‘å®šä¼˜å…ˆçº§å¤§ foo < obj.bar
//æ˜¾å¼ç»‘å®šæ¯”éšå¼ç»‘å®šä¼˜å…ˆçº§å¤§
obj.bar.apply('abc') //String
//è€Œåœ¨æ˜¾å¼ç»‘å®šä¸­bind æ¯” apply/callä¼˜å…ˆçº§å¤§
var bindFnObj = {
  name: 'test',
  bar: obj.bar.bind(123),
}
bindFnObj.bar.apply('string') //Number
//è€Œnewç»‘å®šæ¯”æ˜¾å¼ç»‘å®šä¼˜å…ˆçº§å¤§
new bindFnObj.bar() //foo
```

**é—´æ¥å‡½æ•°å¼•ç”¨**

é—´æ¥å‡½æ•°å¼•ç”¨æ˜¯æŒ‡å°†ä¸€ä¸ªå‡½æ•°èµ‹å€¼ç»™å¦ä¸€ä¸ªå˜é‡ï¼Œç„¶åé€šè¿‡é‚£ä¸ªå˜é‡æ¥è°ƒç”¨è¯¥å‡½æ•°çš„æƒ…å½¢ã€‚è¿™ç§æ“ä½œå¾€å¾€ä¼šæ¶‰åŠåˆ°`this`çš„ç»‘å®šï¼Œ**å› ä¸º`this`çš„å€¼æ˜¯åœ¨å‡½æ•°è¢«è°ƒç”¨æ—¶ç¡®å®šçš„ï¼Œè€Œä¸æ˜¯åœ¨å‡½æ•°è¢«å®šä¹‰æ—¶ç¡®å®šçš„**ã€‚**é—´æ¥å¼•ç”¨ä¸€ä¸ªå‡½æ•°å¯èƒ½ä¼šå½±å“`this`çš„ç»‘å®šï¼Œå¯¼è‡´å…¶æŒ‡å‘ä¸åŒçš„å¯¹è±¡**ã€‚

```js
const obj = {
  myMethod: function () {
    console.log(this)
  },
}

// ç›´æ¥è°ƒç”¨
obj.myMethod() // `this`æŒ‡å‘obj

// é—´æ¥å¼•ç”¨
const anotherMethod = obj.myMethod
// `this`åœ¨éä¸¥æ ¼æ¨¡å¼ä¸‹æŒ‡å‘å…¨å±€å¯¹è±¡ï¼ˆå¦‚windowï¼‰ï¼Œåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ä¸º`undefined`
anotherMethod()
```

**åˆ›å»ºå¯¹è±¡äº§ç”Ÿ this æŒ‡å‘é—®é¢˜**

é€šè¿‡`new`å…³é”®å­—åˆ›å»ºçš„å¯¹è±¡ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œ`this`æŒ‡å‘æ˜¯æ˜ç¡®çš„ï¼šç”±`new`æ“ä½œåˆ›å»ºçš„ç‹¬ç‰¹ä¸Šä¸‹æ–‡ç¯å¢ƒï¼Œå®ƒæŒ‡å‘é€šè¿‡`new`å…³é”®å­—åˆ›å»ºçš„æ–°å¯¹è±¡(å®ä¾‹)ã€‚

è€Œ**é€šè¿‡å¯¹è±¡å­—é¢é‡åˆ›å»ºå¯¹è±¡**æ—¶ï¼Œä¸å­˜åœ¨æ„é€ è¿‡ç¨‹ä¸­`this`çš„ç»‘å®š,æ‰€ä»¥ä¹Ÿå°±ä¸ä¼šåˆ›å»ºä¸Šä¸‹æ–‡ç¯å¢ƒï¼›åœ¨åˆ›å»ºå­—é¢é‡å¯¹è±¡æ—¶æ·»åŠ çš„å‡½æ•°(éç®­å¤´å‡½æ•°ï¼‰ä¸­`this`ä¸€èˆ¬æƒ…å†µæŒ‡å‘çš„å°±æ˜¯è¯¥å¯¹è±¡,è¿™æ˜¯å› ä¸ºæ™®é€šå‡½æ•°çš„`this`æŒ‡å‘åœ¨å‡½æ•°è¢«è°ƒç”¨æ—¶ç¡®å®šã€‚è€Œç®­å¤´å‡½æ•°`this`æŒ‡å‘åˆ™æ˜¯åœ¨åˆ›å»ºæ—¶ç¡®å®šã€‚

`new`å®ä¾‹å’Œå­—é¢é‡åˆ›å»ºæ™®é€šå‡½æ•°å¯¹æ¯”

```js
function Person(name) {
  this.name = name
  this.sayHello = function () {
    console.log('Hello, my name is ' + this.name)
  }
}

var person = new Person('Alice')
person.sayHello() // è¿™é‡Œçš„thisæŒ‡å‘personå®ä¾‹

var obj = {
  name: 'Bob',
  sayHello: function () {
    console.log('Hello, my name is ' + this.name)
  },
}

obj.sayHello() // è¿™é‡Œçš„thisæŒ‡å‘objå¯¹è±¡ éšå¼ç»‘å®š
```

`new`å®ä¾‹å’Œå­—é¢é‡åˆ›å»ºç®­å¤´å‡½æ•°å¯¹æ¯”

```js
function Person(name) {
  this.name = name
  /*newåˆ›å»ºçš„å¯¹è±¡æ˜ç¡®æŒ‡å‡ºthisæŒ‡å‘è‡ªå·±çš„å®ä¾‹å¹¶ä¼šåˆ›å»ºä¸Šä¸‹æ–‡ç¯å¢ƒ ç®­å¤´å‡½æ•°æ‰¾ä¸Šå±‚thisä¾¿æ˜¯æ­¤å¤„çš„ä¸Šä¸‹æ–‡ç¯å¢ƒ*/
  this.sayHello = () => {
    console.log('Hello, my name is ', this, this.name)
  }
}

var person = new Person('Alice')
person.sayHello() // è¿™é‡Œçš„thisæŒ‡å‘personå®ä¾‹

var obj = {
  name: 'Bob',
  /*è‡ªå˜é‡åˆ›å»ºå¯¹è±¡ä¸ä¼šç”Ÿæˆè‡ªå·±çš„ä¸Šä¸‹æ–‡ç¯å¢ƒ è€Œç®­å¤´å‡½æ•°ä¸€èˆ¬thisæŒ‡å‘åˆ™æ˜¯ä¸Šå±‚çš„ä¸Šä¸‹æ–‡this objä¸Šå±‚this å°±æ˜¯window*/
  sayHello: () => {
    console.log('Hello, my name is ', this, this.name)
  },
}

obj.sayHello() // è¿™é‡Œçš„thisæŒ‡å‘çš„æ˜¯window
```

ä¾§æ–¹é¢è¯å®ç®­å¤´å‡½æ•°ç‰¹æ€§ : ç®­å¤´å‡½æ•° `this` æŒ‡å‘æ˜¯åœ¨è¢«åˆ›å»ºæ—¶ç¡®å®šçš„

```js
var glb = {
  name: 'glb',
  child: {
    name: 'Bob',
    fn() {
      //æ­¤å¤„thiså› ä¸ºæ˜¯æ™®é€šå‡½æ•°,åªæœ‰åœ¨è¢«è°ƒç”¨æ—¶æ‰èƒ½ç¡®å®šthisæŒ‡å‘,glb.child.fn()éšå¼ç»‘å®š thisæŒ‡å‘childå¯¹è±¡
      var sayHello = () => {
        //ç®­å¤´å‡½æ•°åœ¨åˆ›å»ºæ—¶å°±ä¼šç¡®å®šthisæŒ‡å‘,æŒ‡å‘ä¸Šå±‚ä¸Šä¸‹æ–‡ç¯å¢ƒ,ä¸Šå±‚thisæŒ‡å‘child,æ‰€ä»¥æ­¤æ—¶thisæŒ‡å‘çš„å°±æ˜¯child
        console.log('this: ', this)
      }
      sayHello()
    },
  },
}
glb.child.fn() //childå¯¹è±¡
```

---

### js æ‰§è¡ŒåŸç†

**æ‰§è¡Œä¸Šä¸‹æ–‡**

å½“ JavaScript å¼•æ“æ‰«æè„šæœ¬æ–‡ä»¶æ—¶ï¼Œå®ƒä¼šåˆ›å»ºä¸€ä¸ªç§°ä¸º**æ‰§è¡Œä¸Šä¸‹æ–‡çš„**ç¯å¢ƒï¼Œç”¨äºå¤„ç†ä»£ç çš„æ•´ä¸ªè½¬æ¢å’Œæ‰§è¡Œã€‚

æœ‰ä¸¤ç§ç±»å‹çš„æ‰§è¡Œä¸Šä¸‹æ–‡ï¼š**å…¨å±€**å’Œ**å‡½æ•°**ã€‚å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡æ˜¯åœ¨ JavaScript è„šæœ¬ç¬¬ä¸€æ¬¡å¼€å§‹è¿è¡Œæ—¶åˆ›å»ºçš„ï¼Œå®ƒä»£è¡¨ JavaScript ä¸­çš„å…¨å±€èŒƒå›´ã€‚æ¯å½“è°ƒç”¨å‡½æ•°æ—¶éƒ½ä¼šåˆ›å»ºå‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œè¡¨ç¤ºå‡½æ•°çš„æœ¬åœ°èŒƒå›´ã€‚

ç”±äº js çš„å•çº¿ç¨‹ç‰¹æ€§ï¼Œè¿™æ„å‘³ç€å®ƒä¸€æ¬¡åªèƒ½æ‰§è¡Œä¸€é¡¹ä»»åŠ¡ã€‚ä¼šåˆ›å»ºä¸€å †è¦æ‰§è¡Œçš„æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œç§°ä¸ºä¸€ä¸ªæ‰§è¡Œå †ã€‚å½“å‰ä½äºé¡¶éƒ¨çš„æ‰§è¡Œä¸Šä¸‹æ–‡ (EC) æˆä¸ºæ´»åŠ¨æ‰§è¡Œè¡Œä¸‹æ–‡ï¼Œå¹¶ç”± js å¼•æ“é¦–å…ˆæ‰§è¡Œã€‚ä¸€æ—¦æ´»åŠ¨æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­çš„æ‰€æœ‰ä»£ç æ‰§è¡Œå®Œæ¯•ï¼Œjs å¼•æ“å°±ä¼šå¼¹å‡ºæ‰§è¡Œå †æ ˆä¸­è¿™ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œç§»è‡³å…¶ä¸‹æ–¹çš„ä¸‹ä¸€ä¸ªï¼Œä¾æ­¤ç±»æ¨ã€‚

æ‰§è¡Œä¸Šä¸‹æ–‡æœ‰ä¸¤ä¸ªé˜¶æ®µï¼š

1. **åˆ›å»ºé˜¶æ®µ**ï¼š
   - åˆ›å»ºå˜é‡å¯¹è±¡ï¼ˆVariable Objectï¼‰ï¼šVO ç”¨äºå­˜å‚¨å‡½æ•°å£°æ˜ã€å˜é‡å£°æ˜ï¼ˆåˆå§‹åŒ–ä¸º`undefined`ï¼‰å’Œåœ¨å‡½æ•°ä¸Šä¸‹æ–‡ä¸­çš„å½¢å‚ã€‚
   - å»ºç«‹ä½œç”¨åŸŸé“¾ï¼ˆScope Chainï¼‰ï¼šä½œç”¨åŸŸé“¾ç¡®ä¿äº†å½“å‰æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­çš„ä»£ç èƒ½å¤Ÿè®¿é—®åˆ°çˆ¶çº§ä½œç”¨åŸŸä¸­çš„å˜é‡å’Œå‡½æ•°ï¼Œä»è€Œå®ç°è¯æ³•ä½œç”¨åŸŸçš„ç‰¹æ€§ã€‚
   - ç¡®å®š this çš„æŒ‡å‘ï¼šç¡®å®šå‡½æ•°æ‰§è¡Œæ—¶ this å…³é”®å­—æ‰€å¼•ç”¨çš„å¯¹è±¡ã€‚
   - åˆ›å»ºå‡½æ•°ï¼ˆFunction Declarationï¼‰ï¼šå°†å‡½æ•°å£°æ˜æå‡åˆ°ä½œç”¨åŸŸçš„é¡¶éƒ¨ï¼Œå¯ä»¥åœ¨å£°æ˜ä¹‹å‰è°ƒç”¨å‡½æ•°ã€‚
   - åˆ›å»ºå˜é‡ï¼ˆVariable Declarationï¼‰ï¼šå°†å˜é‡å£°æ˜æå‡åˆ°ä½œç”¨åŸŸçš„é¡¶éƒ¨ï¼Œä½†æ˜¯ä¸èµ‹å€¼ï¼ˆå³ undefinedï¼‰ã€‚
2. **æ‰§è¡Œé˜¶æ®µ**ï¼š
   - é€è¡Œæ‰§è¡Œä»£ç ï¼šæŒ‰ç…§ä»£ç ç¼–å†™çš„é¡ºåºæ‰§è¡Œè¯­å¥ï¼ŒåŒ…æ‹¬èµ‹å€¼ã€å‡½æ•°è°ƒç”¨ã€æ¡ä»¶è¯­å¥ç­‰æ“ä½œã€‚
   - æ ¹æ®ä½œç”¨åŸŸé“¾æŸ¥æ‰¾å˜é‡ï¼šåœ¨è®¿é—®å˜é‡æ—¶ï¼Œä¼šæ ¹æ®ä½œç”¨åŸŸé“¾ä»å†…åˆ°å¤–é€çº§æŸ¥æ‰¾å˜é‡çš„å€¼ã€‚
   - æ‰§è¡Œå‡½æ•°ï¼šå½“è°ƒç”¨å‡½æ•°æ—¶ï¼Œä¼šåˆ›å»ºæ–°çš„å‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œå¹¶åœ¨å…¶ä¸­æ‰§è¡Œå‡½æ•°å†…éƒ¨çš„ä»£ç ã€‚
   - æ›´æ–°å˜é‡å€¼ï¼šæ ¹æ®æ‰§è¡Œçš„æ“ä½œæ›´æ–°å˜é‡çš„å€¼ã€‚

**å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡**

**å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡**æ˜¯ JavaScript ä»£ç æ‰§è¡Œæ—¶æ ¹çº§æ‰§è¡Œç¯å¢ƒï¼Œæ¯ä¸ª JavaScript ç¯å¢ƒåªæœ‰ä¸€ä¸ªå…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œå®ƒåœ¨ç¨‹åºå¼€å§‹æ‰§è¡Œæ—¶åˆ›å»ºï¼Œå¹¶ä¸”åœ¨ç¨‹åºç»“æŸæ—¶é”€æ¯ã€‚å½“ JavaScript å¼•æ“å¼€å§‹æ‰§è¡Œè„šæœ¬æ—¶ï¼Œå®ƒé¦–å…ˆè¿›å…¥å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡çš„åˆ›å»ºé˜¶æ®µã€‚è¿™ä¸ªé˜¶æ®µä¼šåˆ›å»ºå…¨å±€å¯¹è±¡ï¼Œè®¾ç½®å…¨å±€å¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•ï¼Œå¹¶åˆå§‹åŒ–å…¨å±€å˜é‡å’Œå‡½æ•°ã€‚ä¹‹åï¼Œå¼•æ“å¼€å§‹é€è¡Œæ‰§è¡Œå…¨å±€ä¸Šä¸‹æ–‡ä¸­çš„ä»£ç ã€‚è¿™åŒ…æ‹¬å˜é‡èµ‹å€¼ã€å‡½æ•°è°ƒç”¨ç­‰æ“ä½œã€‚

**å‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡**

å½“å‘ç°å‡½æ•°è°ƒç”¨æ—¶ä¼šåˆ›å»ºå•ç‹¬çš„å‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡(FEC)ï¼Œå­˜æ”¾åœ¨æ‰§è¡Œæ ˆå†…ã€‚å¹¶åˆ›å»ºä¸€ä¸ª AO å¯¹è±¡(Activation Object)è¿™ä¸ª AO å¯¹è±¡ä¼šæ„é€ ä¸€ä¸ªåä¸ºâ€œ argument â€çš„ç±»æ•°ç»„å¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«æä¾›ç»™è¯¥å‡½æ•°çš„æ‰€æœ‰å‚æ•°ã€‚åœ¨è¿™ä¸ªå‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡æ‰§è¡Œä¹‹å‰,è¿™ä¸ª AO å¯¹è±¡ä¼šä½œä¸ºå‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡çš„ VO æ¥å­˜æ”¾å˜é‡åˆå§‹åŒ–ã€‚

- åˆ›å»ºé˜¶æ®µ

  1. åˆ›å»ºå˜é‡å¯¹è±¡(Variable Object)
     å˜é‡å¯¹è±¡ï¼ˆVOï¼‰æ˜¯æ‰§è¡Œä¸Šä¸‹æ–‡çš„ä¸€éƒ¨åˆ†ï¼Œä»»ä½•çš„ä¸€ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡éƒ½å¿…é¡»å…³è”å¯¹åº”çš„ VO å¯¹è±¡ï¼Œå®ƒåŒ…å«äº†æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­å®šä¹‰çš„æ‰€æœ‰å˜é‡å’Œå‡½æ•°å£°æ˜ã€‚å¯¹äºå…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œå˜é‡å¯¹è±¡å®é™…ä¸Šå°±æ˜¯å…¨å±€å¯¹è±¡(GO)æœ¬èº«ï¼ˆåœ¨æµè§ˆå™¨ä¸­é€šå¸¸æ˜¯`window`å¯¹è±¡ï¼‰ã€‚è€Œå¯¹äºå‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡ VO å¯¹åº”çš„åˆ™æ˜¯å‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡æ‰§è¡Œä¹‹å‰åˆ›å»ºçš„ AO(Activation Object) ã€‚åœ¨æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­ï¼Œä½¿ç”¨`var`å…³é”®å­—å£°æ˜çš„å˜é‡ä¼šè¢«æ·»åŠ åˆ° VO ä¸Šï¼Œå¹¶åˆå§‹åŒ–ä¸º`undefined`ã€‚å‡½æ•°å£°æ˜ä¹Ÿä¼šè¢«æ·»åŠ åˆ° VO ä¸­å¹¶ä¼˜å…ˆåˆ›å»ºå‡ºå‡½æ•°å¯¹è±¡ï¼Œæ‰€ä»¥å¯ä»¥åœ¨ä»£ç æ‰§è¡Œå‰è¢«è®¿é—®ï¼Œè¿™ä¸ªç°è±¡ç§°ä¸ºæå‡ï¼ˆHoistingï¼‰ã€‚

  2. åˆ›å»ºä½œç”¨åŸŸé“¾(scope)

     ä½œç”¨åŸŸé“¾ï¼ˆScope Chainï¼‰æ˜¯ JavaScript ä¸­ç”¨äºè§£æå’ŒæŸ¥æ‰¾å˜é‡çš„ä¸€ç§æœºåˆ¶ã€‚å½“ä»£ç éœ€è¦è®¿é—®ä¸€ä¸ªå˜é‡æ—¶ï¼ŒJavaScript å¼•æ“ä¼šé€šè¿‡ä½œç”¨åŸŸé“¾æ¥æŸ¥æ‰¾è¿™ä¸ªå˜é‡ã€‚ä½œç”¨åŸŸé“¾æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªæŒ‡å‘å˜é‡å¯¹è±¡çš„æŒ‡é’ˆåˆ—è¡¨ï¼Œè¿™äº›å˜é‡å¯¹è±¡å¯¹åº”ç€ä»£ç çš„è¯æ³•åµŒå¥—ç»“æ„ã€‚

     å¯¹äºå…¨å±€æ‰§è¡Œä¸Šä¸‹ä½œç”¨åŸŸé“¾åŒ…å«ä¸€ä¸ªå¯¹è±¡å°±æ˜¯å…¨å±€å¯¹è±¡æœ¬èº«,å› ä¸ºå…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡æ˜¯ä½œç”¨åŸŸé“¾çš„æœ€é¡¶ç«¯,æ²¡æœ‰å¤–éƒ¨å¼•ç”¨ã€‚å› æ­¤å…¶ä½œç”¨åŸŸé“¾ä»…åŒ…å«è‡ªèº«ã€‚

     å¯¹äºå‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡å®ƒçš„ä½œç”¨åŸŸé“¾åŒ…å«äº†å½“å‰å‡½æ•°ä½œç”¨åŸŸä¸­çš„å˜é‡å¯¹è±¡ä»¥åŠå¤–éƒ¨ç¯å¢ƒçš„å˜é‡å¯¹è±¡ã€‚**å‡½æ•°çš„ä½œç”¨åŸŸé“¾åœ¨è¢«å‡½æ•°å®šä¹‰æ—¶å°±å·²ç»ç¡®å®š**,å³è¯æ³•ä½œç”¨åŸŸè§„åˆ™ã€‚å®ƒåŸºäºå‡½æ•°æ˜¯åœ¨å“ªé‡Œå®šä¹‰çš„,è€Œä¸æ˜¯å“ªé‡Œè¢«è°ƒç”¨çš„(this æŒ‡å‘å¯¹äºå‡½æ•°æ¥è¯´æ˜¯è¢«è°ƒç”¨æ—¶ç¡®å®š),è¿™æ„å‘³è¿™å‡½æ•°å¯ä»¥è®¿é—®è‡ªå·±çš„å†…éƒ¨å˜é‡,å®šä¹‰å®ƒçš„å¤–éƒ¨å‡½æ•°å˜é‡,ä»¥åŠå…¨å±€å˜é‡ã€‚å‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡çš„ä½œç”¨åŸŸé“¾å¼€å§‹äºå®ƒå­çš„å˜é‡å¯¹è±¡,ç„¶åæ˜¯å®šä¹‰è¯¥å‡½æ•°çš„çˆ¶å‡½æ•°çš„å˜é‡å¯¹è±¡,ä¸€ç›´å»¶ä¼¸åˆ°å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡çš„å…¨å±€å¯¹è±¡ã€‚

  3. é…ç½®`this`å…³é”®å­—

     åœ¨å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­ï¼Œ**this**å˜é‡å¼•ç”¨å…¨å±€å¯¹è±¡ã€‚
     åœ¨å‡½æ•°å†…éƒ¨ï¼Œ**this**å˜é‡æ ¹æ®å‡½æ•°çš„è°ƒç”¨æ–¹å¼å¼•ç”¨ä¸€ä¸ªå¯¹è±¡ã€‚å¦‚æœè°ƒç”¨æ²¡æœ‰è®¾ç½®**this**çš„å€¼ï¼Œåˆ™**this**çš„å€¼å¼•ç”¨å…¨å±€å¯¹è±¡â€”â€”å³æµè§ˆå™¨ä¸­çš„ window å¯¹è±¡ã€‚ç„¶è€Œï¼Œåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œå¦‚æœåœ¨è¿›å…¥æ‰§è¡Œä¸Šä¸‹æ–‡æ—¶æœªè®¾ç½®è¯¥å€¼ï¼Œåˆ™è¯¥å€¼ä¸º**undefined**

- æ‰§è¡Œé˜¶æ®µ

  åˆ›å»ºé˜¶æ®µä¹‹åï¼Œå¼•æ“å¼€å§‹é€è¡Œæ‰§è¡Œå…¨å±€ä¸Šä¸‹æ–‡ä¸­çš„ä»£ç ã€‚è¿™åŒ…æ‹¬å˜é‡èµ‹å€¼ã€å‡½æ•°è°ƒç”¨ç­‰æ“ä½œã€‚å¦‚æœæœ‰å‡½æ•°è¢«è°ƒç”¨ï¼Œé‚£ä¹ˆä¸€ä¸ªæ–°çš„å‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡å°†è¢«åˆ›å»ºå¹¶æ¨å…¥æ‰§è¡Œä¸Šä¸‹æ–‡æ ˆã€‚

**åˆå§‹åŒ–å…¨å±€å¯¹è±¡**

js å¼•æ“åœ¨æ‰§è¡Œä»£ç ä¹‹å‰,ä¼šåœ¨å †å†…å­˜ä¸­åˆ›å»ºä¸€ä¸ªåˆå§‹åŒ–å…¨å±€å¯¹è±¡:**Globel Object**ã€‚å¹¶ç»‘å®šå…¨å±€å‡½æ•°åŠå¯¹è±¡,ä¾‹:`Array`ã€`Object`ã€`parseInt`ï¼Œç»‘å®šåˆ°å…¨å±€å¯¹è±¡ä¸Šã€‚è¿™ä½¿å¾—è¿™äº›å†…ç½®åŠŸèƒ½åœ¨ä»»ä½•åœ°æ–¹éƒ½å¯ç”¨ã€‚å…¶ä¸­è¿˜æœ‰ä¸€ä¸ª`window`å±æ€§æŒ‡å‘è‡ªèº«ã€‚

---

### é—­åŒ…

é—­åŒ…ï¼ˆClosureï¼‰æ˜¯ä¸€ä¸ªå¼ºå¤§çš„ JavaScript ç‰¹æ€§ï¼Œå…è®¸ä¸€ä¸ªå‡½æ•°è®¿é—®å¹¶æ“ä½œå¤–éƒ¨å‡½æ•°ä½œç”¨åŸŸä¸­çš„å˜é‡ï¼Œå³ä½¿å¤–éƒ¨å‡½æ•°å·²ç»æ‰§è¡Œå®Œæˆã€‚

é—­åŒ…å‘ç”Ÿåœ¨ä¸€ä¸ªå‡½æ•°å†…éƒ¨åˆ›å»ºå¦ä¸€ä¸ªå‡½æ•°æ—¶ã€‚å†…éƒ¨å‡½æ•°ä¼šâ€œè®°ä½â€å¤–éƒ¨å‡½æ•°çš„ç¯å¢ƒï¼Œå³ä½¿å¤–éƒ¨å‡½æ•°å·²ç»æ‰§è¡Œç»“æŸã€‚è¿™æ˜¯å› ä¸ºå‡½æ•°åœ¨ JavaScript ä¸­æ˜¯è¯æ³•ä½œç”¨åŸŸçš„ï¼Œæ„å‘³ç€å‡½æ•°çš„ä½œç”¨åŸŸåœ¨å‡½æ•°å®šä¹‰çš„æ—¶å€™å°±å·²ç»ç¡®å®šï¼Œè€Œä¸æ˜¯åœ¨æ‰§è¡Œæ—¶ã€‚å†…éƒ¨å‡½æ•°ä¿æŒå¯¹å¤–éƒ¨å‡½æ•°ä½œç”¨åŸŸçš„å¼•ç”¨ï¼Œè¿™ä¸ªå¼•ç”¨å°±æ˜¯é—­åŒ…ã€‚

```js
/* åˆ›å»ºåç§° */
function createName(surname) {
  return function (name) {
    return `${surname}${name}`
  }
}

var zhangSurname = createName('å¼ ')

console.log(zhangSurname('ä¸‰')) //å¼ ä¸‰
console.log(zhangSurname('å…­')) //å¼ å…­

var wangSurname = createName('ç‹')

console.log(wangSurname('äº”')) //å¼ ä¸‰
console.log(wangSurname('ä¸ƒ')) //å¼ å…­
```

ç»“åˆä¸Šä¸€æ–‡çš„æ‰§è¡ŒåŸç†å›¾ä¾‹:
**åˆ›å»ºé˜¶æ®µ**

å½“ JavaScript å¼•æ“å¼€å§‹æ‰§è¡Œè„šæœ¬æ—¶é¦–å…ˆå°±ä¼šåˆ›å»ºå…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡,å…¶æ¬¡ä¼šåˆ›å»ºä¸€ä¸ªå…¨å±€å¯¹è±¡,å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡çš„ VO å°†å¼•ç”¨è¿™ä¸ªå…¨å±€å¯¹è±¡ã€‚å…¨å±€å¯¹è±¡åŒ…å«äº†ä¸€äº›å…¨å±€å‡½æ•°å±æ€§åŠå¯¹è±¡,å¹¶ä¼šå¯¹ä½¿ç”¨`var`å£°æ˜çš„å˜é‡åˆå§‹åŒ–ä¸º`undefined`ã€‚å¦‚æœæ˜¯å‡½æ•°,åˆ™ä¼šæå‰åˆ›å»ºå‡½æ•°å¯¹è±¡,æ¯ä¸ªå‡½æ•°å¯¹è±¡åœ¨åˆ›å»ºæ—¶éƒ½ä¼šæœ‰ä¸€ä¸ªå†…éƒ¨å±æ€§`[[Scope]]`ï¼Œè¿™ä¸ªå±æ€§åŒ…å«äº†å‡½æ•°å®šä¹‰æ—¶çš„ä½œç”¨åŸŸé“¾ã€‚è¿™ä¹Ÿæ„å‘³ç€å‡½æ•°çš„ä½œç”¨åŸŸåœ¨å‡½æ•°å®šä¹‰çš„æ—¶å€™å°±å·²ç»ç¡®å®šäº†ï¼Œä¸æ˜¯åœ¨æ‰§è¡Œçš„æ—¶å€™ã€‚å‡½æ•°å¯¹è±¡çš„`[[Scope]]`å±æ€§ï¼Œå®é™…ä¸Šå°±æ˜¯æ•è·äº†å‡½æ•°å®šä¹‰æ—¶çš„å¤–éƒ¨ä½œç”¨åŸŸé“¾ï¼Œç¡®ä¿äº†å‡½æ•°å³ä½¿åœ¨å…¶ä»–åœ°æ–¹æ‰§è¡Œï¼Œä¹Ÿèƒ½è®¿é—®åˆ°å®šä¹‰æ—¶çš„ä½œç”¨åŸŸå†…çš„å˜é‡ã€‚**è¿™ç§æœºåˆ¶ä½¿å¾—é—­åŒ…æˆä¸ºå¯èƒ½ï¼šä¸€ä¸ªå‡½æ•°å¯ä»¥è®¿é—®å¹¶æ“ä½œä¸å±äºè‡ªèº«å±€éƒ¨ä½œç”¨åŸŸçš„å˜é‡ã€‚è¿™ä¸ä»…åŒ…æ‹¬å¤–å›´å‡½æ•°çš„å±€éƒ¨å˜é‡ï¼Œä¹ŸåŒ…æ‹¬å…¨å±€å˜é‡ã€‚**

**æ‰§è¡Œé˜¶æ®µ**

åˆ›å»ºé˜¶æ®µå®Œæˆå,ä»£ç å°†ä¸€è¡Œè¡Œè¿›è¡Œæ‰§è¡Œï¼Œå°†ä¼šå¯¹å˜é‡å¯¹è±¡ä¸­çš„å˜é‡è¿›è¡Œèµ‹å€¼æ“ä½œ,å½“å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼ŒJavaScript å¼•æ“ä¼šä¸ºè¯¥å‡½æ•°è°ƒç”¨åˆ›å»ºä¸€ä¸ªæ–°çš„æ‰§è¡Œä¸Šä¸‹æ–‡ã€‚å‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡ä¼š**å¤åˆ¶å‡½æ•°å¯¹è±¡çš„`[[Scope]]`å±æ€§æ¥åˆ›å»ºä½œç”¨åŸŸé“¾**ã€‚å¹¶åˆ›å»º AO å¯¹è±¡,å‡½æ•°çš„å‚æ•°ã€å±€éƒ¨å˜é‡ç­‰ä¼šè¢«æ·»åŠ åˆ°è¿™ä¸ª AO å¯¹è±¡ä¸­ã€‚ç„¶åï¼Œè¿™ä¸ª AO å¯¹è±¡è¢«æ¨å…¥ä½œç”¨åŸŸé“¾çš„å‰ç«¯ï¼Œè¿™æ ·å‡½æ•°å†…éƒ¨çš„ä»£ç å°±å¯ä»¥è®¿é—®åˆ°è¿™äº›å±€éƒ¨å˜é‡å’Œå‚æ•°ã€‚

---

### åƒåœ¾å›æ”¶æœºåˆ¶

JavaScript çš„åƒåœ¾å›æ”¶ï¼ˆGarbage Collection, GCï¼‰æœºåˆ¶æ˜¯è‡ªåŠ¨çš„ï¼Œæ—¨åœ¨å¸®åŠ©å¼€å‘è€…ç®¡ç†å†…å­˜ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼ã€‚åƒåœ¾å›æ”¶æœºåˆ¶å®šæœŸæŸ¥æ‰¾é‚£äº›ä¸å†è¢«åº”ç”¨ç¨‹åºä½¿ç”¨çš„å˜é‡æˆ–å¯¹è±¡ï¼Œç„¶åé‡Šæ”¾å®ƒä»¬çš„å†…å­˜ã€‚è¿™æ˜¯é€šè¿‡è¯†åˆ«å“ªäº›å¯¹è±¡æ˜¯â€œå¯è¾¾çš„â€æ¥å®Œæˆçš„ã€‚å¯è¾¾å¯¹è±¡æ˜¯æŒ‡åœ¨åº”ç”¨ç¨‹åºä¸­ä»ç„¶å¯ä»¥è®¿é—®åˆ°çš„å¯¹è±¡ï¼Œå› æ­¤è¢«è®¤ä¸ºæ˜¯â€œæ´»åŠ¨çš„â€æˆ–â€œå¿…éœ€çš„â€ã€‚

**åŸºæœ¬æ¦‚å¿µ**

**å¯è¾¾æ€§ï¼ˆReachabilityï¼‰**ï¼šæœ€åŸºæœ¬çš„â€œå¯è¾¾â€å€¼æ˜¯é‚£äº›ä»æ ¹(js ä¸­æŒ‡çš„å°±æ˜¯ global object)é›†åˆå‡ºå‘å¯ä»¥å¼•ç”¨åˆ°çš„å€¼ã€‚æ ¹é›†åˆé€šå¸¸åŒ…æ‹¬åœ¨å…¨å±€ä½œç”¨åŸŸä¸­çš„å¯¹è±¡ã€å½“å‰åµŒå¥—è°ƒç”¨é“¾ä¸Šçš„å±€éƒ¨å˜é‡å’Œå‚æ•°ç­‰ã€‚ä»è¿™äº›æ ¹å‡ºå‘ï¼Œå¼•ç”¨æˆ–è€…é“¾å¼å¼•ç”¨çš„ä»»ä½•å¯¹è±¡éƒ½è¢«è§†ä¸ºå¯è¾¾çš„ï¼Œå› æ­¤ä¸ä¼šè¢«åƒåœ¾å›æ”¶å™¨å›æ”¶ã€‚

**åƒåœ¾å›æ”¶ç®—æ³•**

åƒåœ¾å›æ”¶å™¨ä¸»è¦ä¾èµ–äºå‡ ç§ç®—æ³•æ¥æ‰§è¡Œå†…å­˜å›æ”¶ï¼š

1. **æ ‡è®°-æ¸…é™¤ï¼ˆMark-and-Sweepï¼‰**ï¼šè¿™æ˜¯æœ€å¸¸ç”¨çš„åƒåœ¾å›æ”¶ç®—æ³•ã€‚å½“åƒåœ¾å›æ”¶è¿è¡Œæ—¶ï¼Œå®ƒâ€œæ ‡è®°â€æ ¹å¯¹è±¡é›†åˆï¼Œç„¶åè®¿é—®å¹¶â€œæ ‡è®°â€æ‰€æœ‰ä»æ ¹å¯¹è±¡å¼•ç”¨çš„å¯¹è±¡ï¼Œå†æ ‡è®°ä»è¿™äº›å¯¹è±¡å¼•ç”¨çš„å¯¹è±¡ï¼Œä»¥æ­¤ç±»æ¨ã€‚ä¸€æ—¦æ‰€æœ‰å¯è¾¾å¯¹è±¡éƒ½è¢«æ ‡è®°ï¼Œé‚£äº›æœªè¢«æ ‡è®°çš„å¯¹è±¡å³è¢«è§†ä¸ºä¸å¯è¾¾ï¼Œå› æ­¤æ˜¯åƒåœ¾ã€‚åƒåœ¾å›æ”¶å™¨éšåä¼šâ€œæ¸…é™¤â€è¿™äº›å¯¹è±¡å ç”¨çš„å†…å­˜ï¼Œå¹¶ä¸”â€œå–æ¶ˆæ ‡è®°â€æ‰€æœ‰æ´»åŠ¨å¯¹è±¡ï¼Œä»¥å¤‡ä¸‹ä¸€æ¬¡åƒåœ¾å›æ”¶ä½¿ç”¨ã€‚
2. **å¼•ç”¨è®¡æ•°ï¼ˆReference Countingï¼‰**ï¼šè¿™æ˜¯ä¸€ç§è¾ƒæ—©çš„åƒåœ¾å›æ”¶ç­–ç•¥ï¼Œæ¯ä¸ªå¯¹è±¡ä¿å­˜ä¸€ä¸ªå¼•ç”¨è®¡æ•°ï¼Œå³æœ‰å¤šå°‘ä¸ªå¼•ç”¨æŒ‡å‘å®ƒã€‚å½“å¼•ç”¨è®¡æ•°å˜ä¸º 0 æ—¶ï¼Œæ„å‘³ç€å¯¹è±¡ä¸å¯è¾¾ï¼Œå› æ­¤å¯ä»¥å›æ”¶å…¶å†…å­˜ã€‚è¿™ç§æ–¹æ³•çš„ä¸»è¦ç¼ºç‚¹æ˜¯æ— æ³•å¤„ç†å¾ªç¯å¼•ç”¨ã€‚
3. **å¢é‡åƒåœ¾å›æ”¶ï¼ˆIncremental GCï¼‰**ï¼šå¢é‡åƒåœ¾å›æ”¶å°†æ ‡è®°-æ¸…é™¤è¿‡ç¨‹åˆ†æˆå°ç‰‡æ®µè¿›è¡Œï¼Œé€šè¿‡åˆ†æ•£åƒåœ¾å›æ”¶çš„è´Ÿæ‹…ï¼Œå‡å°‘åº”ç”¨ç¨‹åºçš„æš‚åœæ—¶é—´ã€‚
4. **åˆ†ä»£å›æ”¶ï¼ˆGenerational Collectionï¼‰**ï¼šç°ä»£åƒåœ¾å›æ”¶å™¨ç»å¸¸é‡‡ç”¨åˆ†ä»£å›æ”¶ç­–ç•¥ï¼Œå°†å¯¹è±¡åˆ†ä¸ºä¸¤ç»„æˆ–æ›´å¤šç»„ï¼ˆä»£ï¼‰ã€‚æ–°åˆ›å»ºçš„å¯¹è±¡è¢«åˆ†é…åˆ°æ–°ç”Ÿä»£ï¼ˆYoung Generationï¼‰ï¼Œè€Œå­˜æ´»æ—¶é—´è¾ƒé•¿çš„å¯¹è±¡ä¼šè¢«ç§»åŠ¨åˆ°è€å¹´ä»£ï¼ˆOld Generationï¼‰ã€‚ç”±äºæ–°ç”Ÿä»£ä¸­çš„å¯¹è±¡é€šå¸¸å¯¿å‘½è¾ƒçŸ­ï¼Œæ‰€ä»¥å¯ä»¥æ›´é¢‘ç¹åœ°å¯¹å…¶è¿›è¡Œå›æ”¶ã€‚
5. **å‹ç¼©ï¼ˆCompactionï¼‰**ï¼šä¸€äº›åƒåœ¾å›æ”¶ç®—æ³•è¿˜ä¼šåœ¨æ¸…é™¤ä¸å¯è¾¾å¯¹è±¡åï¼Œå¯¹å‰©ä½™çš„å¯¹è±¡è¿›è¡Œå†…å­˜æ•´ç†ï¼Œç§»åŠ¨å¯¹è±¡æ¥æ¶ˆé™¤åˆ†æ•£çš„ç©ºé—²å†…å­˜å—ï¼Œä»è€Œä¼˜åŒ–å†…å­˜çš„ä½¿ç”¨ã€‚

---

### åŸå‹

åœ¨ JavaScript ä¸­,åŸå‹(prototype)æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µ,æ¯ä¸ªå¯¹è±¡éƒ½æœ‰ä¸€ä¸ªå†…éƒ¨çš„ç§æœ‰å±æ€§[[Prototype]],æŒ‡å‘å¦ä¸€ä¸ªå¯¹è±¡,å¦ä¸€ä¸ªå¯¹è±¡è¢«ç§°ä¸ºè¯¥å¯¹è±¡çš„åŸå‹ã€‚å½“æˆ‘ä»¬è¯•å›¾è®¿é—®ä¸€ä¸ªå¯¹è±¡çš„å±æ€§æˆ–æ–¹æ³•æ—¶,å¦‚æœè¯¥å¯¹è±¡æœ¬èº«æ²¡æœ‰å®šä¹‰è¯¥å±æ€§æˆ–æ–¹æ³•,JavaScript å¼•æ“ä¼šæ²¿ç€åŸå‹é“¾å‘ä¸ŠæŸ¥æ‰¾,ç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªåŒ¹é…çš„å±æ€§æˆ–æ–¹æ³•,æˆ–è€…åˆ°è¾¾åŸå‹é“¾çš„é¡¶ç«¯ã€‚

é€šè¿‡ä»¥ä¸‹æ–¹å¼è·å–å¯¹è±¡[[Prototype]]:

1. `__proto__`

`__proto__` å¹¶ä¸æ˜¯è¯­è¨€æœ¬èº«çš„ç‰¹æ€§ï¼Œè¿™æ˜¯å„å¤§å‚å•†å…·ä½“å®ç°æ—¶æ·»åŠ çš„`ç§æœ‰å±æ€§`ï¼Œè™½ç„¶ç›®å‰å¾ˆå¤šç°ä»£æµè§ˆå™¨çš„ JS å¼•æ“ä¸­éƒ½æä¾›äº†è¿™ä¸ªç§æœ‰å±æ€§ï¼Œä½†ä¾æ—§ä¸å»ºè®®åœ¨ç”Ÿäº§ä¸­ä½¿ç”¨è¯¥å±æ€§ï¼Œé¿å…å¯¹ç¯å¢ƒäº§ç”Ÿä¾èµ–ã€‚

```js
function Person() {}

const p1 = new Person()

console.log(p1.__proto__) // {constructor: Æ’ Person()}
```

2. `Object.getPrototypeOf`

```js
function Person() {}

const p1 = new Person()

console.log(Object.getPrototypeOf(p1) === p1.__proto__) //true
```

**[[Prototype]]å’Œ Prototype**

`Prototype`å±æ€§

`prototype`æ˜¯å‡½æ•°å¯¹è±¡ç‰¹æœ‰çš„å±æ€§ã€‚æ¯å½“å£°æ˜ä¸€ä¸ªå‡½æ•°æ—¶ï¼ŒJavaScript å¼•æ“å°±ä¼šä¸ºè¿™ä¸ªå‡½æ•°åˆ›å»ºä¸€ä¸ª`prototype`å±æ€§ï¼Œè¿™ä¸ªå±æ€§æŒ‡å‘ä¸€ä¸ªå¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡é€šå¸¸è¢«ç§°ä¸ºåŸå‹å¯¹è±¡ï¼Œå®ƒåŒ…å«äº†è¯¥å‡½æ•°æ„é€ çš„æ‰€æœ‰å®ä¾‹æ‰€ç»§æ‰¿çš„å±æ€§å’Œæ–¹æ³•ã€‚æ˜¯å®ç°åŸºäºåŸå‹çš„ç»§æ‰¿å’Œå±æ€§çš„å…±äº«ã€‚å½“ä½¿ç”¨æ„é€ å‡½æ•°åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡æ—¶ï¼ˆå³é€šè¿‡`new`å…³é”®è¯ï¼‰ï¼Œè¢«åˆ›å»ºå¯¹è±¡çš„å†…éƒ¨é“¾æ¥ï¼ˆ`[[Prototype]]`ï¼‰å°±ä¼šæŒ‡å‘æ„é€ å‡½æ•°çš„`prototype`å¯¹è±¡ã€‚

`[[Prototype]]`å±æ€§

å¯¹è±¡éƒ½æœ‰ä¸€ä¸ªç‰¹æ®Šçš„å†…éƒ¨å±æ€§ï¼Œç§°ä¸º`[[Prototype]]`ã€‚è¿™ä¸ªå±æ€§æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘è¯¥å¯¹è±¡çš„åŸå‹ï¼Œå³ä»å“ªä¸ªå¯¹è±¡ç»§æ‰¿å…¶å±æ€§ã€‚`[[Prototype]]`å±æ€§çš„å­˜åœ¨ä½¿å¾— JavaScript å¯¹è±¡å¯ä»¥å®ç°åŸå‹é“¾ç»§æ‰¿ã€‚å½“å°è¯•è®¿é—®ä¸€ä¸ªå¯¹è±¡çš„å±æ€§æ—¶ï¼Œå¦‚æœè¯¥å¯¹è±¡è‡ªèº«æ²¡æœ‰è¿™ä¸ªå±æ€§ï¼Œåˆ™ JavaScript å¼•æ“ä¼šæ²¿ç€`[[Prototype]]`é“¾å‘ä¸ŠæŸ¥æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°è¯¥å±æ€§æˆ–åˆ°è¾¾åŸå‹é“¾çš„é¡¶ç«¯ã€‚

```js
function Person(name) {
  this.name = name
}

Person.prototype.sayName = function () {
  console.log(this.name)
}

var person1 = new Person('Alice')
person1.sayName() //Alice
```

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå³ä½¿æˆ‘ä»¬æ²¡æœ‰ä¸º person1 åˆ›å»º sayName æ–¹æ³•,ä½†æ˜¯ä¾æ—§å¯ä»¥æ­£å¸¸æ‰§è¡Œã€‚åŸå› å°±æ˜¯ person1 æ˜¯ Person æ„å»ºå‡½æ•°é€šè¿‡ new åˆ›å»ºå‡ºæ¥çš„ï¼Œåˆ›å»ºè¿‡ç¨‹æ—¶ä¼šå°† person1 çš„`[[Prototype]]`å±æ€§æŒ‡å‘ä¸º Person çš„`Prototype`å¯¹è±¡,å½“æˆ‘ä»¬ person1.sayName()æ‰§è¡Œæ—¶,é¦–å…ˆä¼šåœ¨è‡ªèº«æŸ¥æ‰¾ sayName å‡½æ•°å¦‚æœæ²¡æœ‰ä¼šé€šè¿‡`[[Prototype]]`è¿›è¡Œä¸Šå±‚æŸ¥æ‰¾,`Prototype`åŸå‹å¯¹è±¡å­˜åœ¨è¿™ä¸ªæ–¹æ³•ã€‚

**constructor å±æ€§**

`constructor`å±æ€§æ˜¯å­˜å‚¨åœ¨åŸå‹å¯¹è±¡ä¸Šçš„ä¸€ä¸ªå±æ€§ï¼Œå®ƒæŒ‡å‘åˆ›å»ºå½“å‰å¯¹è±¡çš„æ„é€ å‡½æ•°ã€‚è¿™æ„å‘³ç€ï¼Œé€šè¿‡è¿™ä¸ªå±æ€§ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªå¯¹è±¡å®ä¾‹çš„åŸå§‹æ„é€ å‡½æ•°ã€‚æ¯ä¸ªåŸå‹å¯¹è±¡é»˜è®¤éƒ½ä¼šæœ‰ä¸€ä¸ª`constructor`å±æ€§ã€‚

---

### ç»§æ‰¿

1. åŸå‹é“¾ç»§æ‰¿ : è®©å­ç±»å‹çš„åŸå‹ä¸ºçˆ¶ç±»å‹çš„ä¸€ä¸ªå®ä¾‹ã€‚è¿™æ ·ï¼Œ`Student`çš„åŸå‹æ˜¯`Person`çš„ä¸€ä¸ªå®ä¾‹ï¼Œä»è€Œåˆ›å»ºäº†ä¸€ä¸ªåŸå‹é“¾ã€‚

```js
function Person() {}

//personåŸå‹ä¸Šæ·»åŠ sayHelloæ–¹æ³•
Person.prototype.sayHello = function () {
  console.log('hello')
}

function Student() {}

//å°†studentåŸå‹ä¿®æ”¹ä¸ºpersonå®ä¾‹ åŸå‹é“¾å¯»æ‰¾è¿‡ç¨‹:studentå®ä¾‹æœ¬èº« => studentåŸå‹(personå®ä¾‹) => personåŸå‹å¯¹è±¡
Student.prototype = new Person()

var stu = new Student()

stu.sayHello() //hello
```

ç¼ºç‚¹: å­ç±»å‹å®ä¾‹ä¼šå…±äº«çˆ¶ç±»å‹çš„å¼•ç”¨å±æ€§ã€‚

```js
function Person(name) {
  this.name = name
}

//personåŸå‹ä¸Šæ·»åŠ sayHelloæ–¹æ³•
Person.prototype.sayHello = function () {
  console.log('hello')
}

function Student() {}

//å°†studentåŸå‹ä¿®æ”¹ä¸ºpersonåŸå‹
Student.prototype = new Person('å¼ ä¸‰')

var stu = new Student()
var stu1 = new Student()

stu.sayHello() //hello

//Studentå®ä¾‹å¯¹è±¡å…±äº«çˆ¶ç±»å‹å¼•ç”¨å±æ€§
console.log(stu.name) //å¼ ä¸‰
console.log(stu1.name) //å¼ ä¸‰

//åŒæ ·çš„å±æ€§éœ€è¦ä¹¦å†™é‡å¤ä»£ç 
/* 
    function Student () {
      this.name = name
    }
*/
```

2. å€Ÿç”¨æ„é€ å‡½æ•°ç»§æ‰¿ : å€Ÿç”¨æ„é€ å‡½æ•°ç»§æ‰¿é€šè¿‡åœ¨å­ç±»å‹æ„é€ å‡½æ•°å†…éƒ¨è°ƒç”¨çˆ¶ç±»å‹æ„é€ å‡½æ•°å®ç°ã€‚

```js
function Person(name) {
  this.name = name
  //this...æ›´å¤šå±æ€§
}

function Student(name) {
  Person.call(this, name)
  //Person.call(this, name,...æ›´å¤šå±æ€§)
}

var stu = new Student('ç‹äº”')
var stu1 = new Student('èµµå…­')

console.log(stu.name) //ç‹äº”
console.log(stu1.name) //èµµå…­
```

ç¼ºç‚¹:
åªèƒ½ç»§æ‰¿çˆ¶ç±»çš„**å®ä¾‹**å±æ€§å’Œæ–¹æ³•ï¼Œä¸èƒ½ç»§æ‰¿åŸå‹å±æ€§/æ–¹æ³•ã€‚æ–¹æ³•éƒ½åœ¨æ„é€ å‡½æ•°ä¸­å®šä¹‰ï¼Œæ¯æ¬¡å®ä¾‹åŒ–å¯¹è±¡éƒ½å¾—åˆ›å»ºä¸€éæ–¹æ³•ï¼ŒåŸºæœ¬æ— æ³•å®ç°å‡½æ•°å¤ç”¨ã€‚

3. ç»„åˆç»§æ‰¿ : ç»„åˆç»§æ‰¿ç»“åˆäº†åŸå‹é“¾å’Œå€Ÿç”¨æ„é€ å‡½æ•°çš„æŠ€æœ¯ï¼Œæ—¢é€šè¿‡åŸå‹é“¾ç»§æ‰¿æ–¹æ³•ï¼Œåˆé€šè¿‡å€Ÿç”¨æ„é€ å‡½æ•°ç»§æ‰¿å±æ€§ã€‚

```js
function Person(name) {
  this.name = name
}

//personåŸå‹ä¸Šæ·»åŠ sayHelloæ–¹æ³•
Person.prototype.sayHello = function () {
  console.log('hello')
}

function Student(name) {
  //å€Ÿç”¨æ„é€ å‡½æ•° ç¬¬ä¸€æ¬¡è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°
  Person.call(this, name)
}

//å°†studentåŸå‹ä¿®æ”¹ä¸ºpersonåŸå‹ ç¬¬äºŒæ¬¡è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°
Student.prototype = new Person('å¼ ä¸‰')

var stu = new Student('ç‹äº”')
var stu1 = new Student('èµµå…­')

stu.sayHello() //hello

console.log(stu.name) //ç‹äº”
console.log(stu1.name) //èµµå…­
```

ç¼ºç‚¹: éœ€è¦è°ƒç”¨ä¸¤æ¬¡çˆ¶ç±»æ„é€ å‡½æ•°ã€‚

4. åŸå‹å¼ç»§æ‰¿ : ç±»ä¼¼åŸå‹é“¾ç»§æ‰¿,ä¸å†èµ˜è¿°

```js
var parent = {
  name: 'parent',
  friends: ['Bob', 'Alice'],
}
//Object.create() é™æ€æ–¹æ³•ä»¥ä¸€ä¸ªç°æœ‰å¯¹è±¡ä½œä¸ºåŸå‹ï¼Œåˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ã€‚
var child1 = Object.create(parent)
child1.name = 'child1'
child1.friends.push('Tom')

var child2 = Object.create(parent)
child2.name = 'child2'
child2.friends.push('Jerry')

console.log(child1.friends) // ["Bob", "Alice", "Tom", "Jerry"]
console.log(child2.friends) // ["Bob", "Alice", "Tom", "Jerry"]
```

5. å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿ : å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿é€šè¿‡å€Ÿç”¨æ„é€ å‡½æ•°æ¥ç»§æ‰¿å±æ€§ï¼Œé€šè¿‡åŸå‹é“¾çš„æ··æˆå½¢å¼æ¥ç»§æ‰¿æ–¹æ³•ï¼Œæ˜¯æœ€ç†æƒ³çš„ç»§æ‰¿æ–¹å¼ã€‚

```js
function inherit(Parent, Son) {
  //åŸå‹å¼ç»§æ‰¿ ä½¿ç”¨Object.createé¿å…ç›´æ¥è°ƒç”¨çˆ¶æ„é€ å‡½æ•°
  Son.prototype = Object.create(Parent.prototype)

  Object.defineProperty(Son.prototype, 'constructor', {
    enumerable: false,
    configurable: true,
    writable: true,
    value: Son,
  })
}

function Person(name) {
  this.name = name
}

function Student(name, sno) {
  //å€Ÿç”¨æ„é€ å‡½æ•°
  Person.call(this, name)
  this.sno = sno
}

inherit(Person, Student)
```

6. es6 extends å…³é”®å­—

```js
class Person {
  constructor(name, age) {
    this.name = name
  }

  eat(food) {
    console.log(`${this.name}åœ¨åƒ${food}`)
  }
}

class Student extends Person {
  constructor(name, age) {
    super(name, age)
  }
}

var student = new Student('å–½å–½', 18)

student.eat('ğŸŸ') // å–½å–½åœ¨åƒğŸŸ
```

extends åº•å±‚å®ç°

```js
/* 
      t:this
      o:å­ç±»åŸå‹
      e:ç›¸åŒå±æ€§
    */
function _callSuper(t, o, e) {
  return (
    //è·å–å­ç±»__proto__å±æ€§
    (o = _getPrototypeOf(o)),
    _possibleConstructorReturn(
      t,
      //åˆ¤æ–­æ˜¯å¦æ”¯æŒReflectå†™æ³• å¦‚æœæ”¯æŒé€šè¿‡Reflectè°ƒç”¨æ„é€ å‡½æ•° å¦‚æœä¸æ”¯æŒå°±ç”¨apply ä¸Šé¢oå·²è¢«ä¿®æ”¹ä¸ºå­ç±»__proto__å±æ€§ ä¾‹å­:Person.apply(this,[ç›¸åŒå±æ€§])
      _isNativeReflectConstruct()
        ? /* 
            o: ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ„é€ å‡½æ•°ï¼Œè¿™é‡Œå·²ç»é€šè¿‡_getPrototypeOfè¢«è®¾ç½®ä¸ºçˆ¶ç±»ã€‚
            e || []: ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¼ é€’ç»™æ„é€ å‡½æ•°çš„å‚æ•°åˆ—è¡¨ã€‚å¦‚æœeå­˜åœ¨ï¼Œåˆ™ä½¿ç”¨eï¼›å¦åˆ™ä½¿ç”¨ç©ºæ•°ç»„[]ã€‚
            _getPrototypeOf(t).constructor: ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯newTargetï¼Œç”¨äºæŒ‡å®šå®é™…è¢«è°ƒç”¨çš„æ„é€ å‡½æ•°ã€‚
            è¿™é‡Œé€šè¿‡_getPrototypeOf(t).constructorè·å–ï¼Œtä¸€èˆ¬ä»£è¡¨å­ç±»å®ä¾‹ã€‚è¿™æ ·åšçš„ç›®çš„æ˜¯ç¡®ä¿åœ¨è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°æ—¶ï¼Œnew.targetæŒ‡å‘çš„æ˜¯å­ç±»æ„é€ å‡½æ•°
            */
          Reflect.construct(o, e || [], _getPrototypeOf(t).constructor)
        : o.apply(t, e),
    )
  )
}

/* 
      ç”¨äºå¤„ç†ä»çˆ¶ç±»æ„é€ å‡½æ•°æˆ–æ–¹æ³•è°ƒç”¨è¿”å›çš„å€¼
      self:this
      call: undefined/é€šè¿‡Reflect.constructåˆ›å»ºå‡ºæ¥å¯¹è±¡
    */
function _possibleConstructorReturn(self, call) {
  //å¦‚æœè°ƒç”¨ç»“æœæ˜¯å¯¹è±¡æˆ–å‡½æ•°ï¼Œé‚£ä¹ˆå¯ä»¥ç›´æ¥è¿”å›è¯¥ç»“æœã€‚
  if (call && (_typeof(call) === 'object' || typeof call === 'function')) {
    return call
  } //è°ƒç”¨è¿”å›äº†ä¸€ä¸ªéundefinedçš„éå¯¹è±¡å€¼ï¼ŒæŠ›å‡ºä¸€ä¸ªTypeError
  else if (call !== void 0) {
    throw new TypeError(
      'Derived constructors may only return object or undefined',
    )
  }
  //ç¡®ä¿å½“å‰å®ä¾‹å·²ç»è¢«æ­£ç¡®åˆå§‹åŒ–ã€‚
  return _assertThisInitialized(self)
}

function _assertThisInitialized(self) {
  //å¦‚æœselfä¸ºundefinedï¼Œæ„å‘³ç€çˆ¶ç±»çš„æ„é€ å‡½æ•°æ²¡æœ‰è¢«æ­£ç¡®è°ƒç”¨
  if (self === void 0) {
    throw new ReferenceError(
      "this hasn't been initialised - super() hasn't been called",
    )
  }
  //è¿”å›é€šè¿‡çˆ¶ç±»æ„é€ å‡½æ•°èµ‹å€¼å±æ€§çš„å­ç±»
  return self
}

function _isNativeReflectConstruct() {
  try {
    var t = !Boolean.prototype.valueOf.call(
      Reflect.construct(Boolean, [], function () {}),
    )
  } catch (t) {}
  return (_isNativeReflectConstruct = function _isNativeReflectConstruct() {
    return !!t
  })()
}

/* 
      o:å­ç±»
      è·å–å­ç±»__proto__å±æ€§
    */
function _getPrototypeOf(o) {
  _getPrototypeOf = Object.setPrototypeOf
    ? Object.getPrototypeOf.bind()
    : function _getPrototypeOf(o) {
        return o.__proto__ || Object.getPrototypeOf(o)
      }
  return _getPrototypeOf(o)
}

/* 
      é€šè¿‡å¯„ç”Ÿç»„åˆå¼å®ç°ç»§æ‰¿
      subClass:å­ç±»
      superClass:çˆ¶ç±»
    */
function _inherits(subClass, superClass) {
  //è¾¹ç•Œåˆ¤æ–­ çˆ¶ç±»è¦ä¹ˆæ˜¯ä¸ä¸ºå‡½æ•°è¦ä¹ˆæ˜¯ä¸ä¸ºnull
  if (typeof superClass !== 'function' && superClass !== null) {
    throw new TypeError('Super expression must either be null or a function')
  }

  //å¯„ç”Ÿå¼ç»„åˆç»§æ‰¿ ç”Ÿæˆä¸€ä¸ªçˆ¶ç±»å®ä¾‹å¯¹è±¡ èµ‹å€¼ç»™å­ç±»çš„åŸå‹å¯¹è±¡ è¿™æ ·å­ç±»çš„åŸå‹å¯¹è±¡å³ä¸ºçˆ¶ç±»çš„å®ä¾‹å¯¹è±¡ å½¢æˆåŸå‹é“¾
  subClass.prototype = Object.create(superClass && superClass.prototype, {
    constructor: { value: subClass, writable: true, configurable: true },
  })

  Object.defineProperty(subClass, 'prototype', { writable: false })

  // å°†å­ç±»æ„é€ å‡½æ•°çš„__proto__ä¿®æ”¹ä¸ºçˆ¶ç±»æ„é€ å‡½æ•°
  if (superClass) _setPrototypeOf(subClass, superClass)
}

/* 
      å°†å­ç±»æ„é€ å‡½æ•°çš„__proto__ä¿®æ”¹ä¸ºçˆ¶ç±»æ„é€ å‡½æ•°  ä¾‹:Student.__proto__ = Person ç¡®ä¿Studentä¹Ÿå¯ä»¥ä½¿ç”¨çˆ¶ç±»çš„ç±»æ–¹æ³•
      o:å­ç±»
      p:çˆ¶ç±»
    */
function _setPrototypeOf(o, p) {
  //åˆ¤æ–­Object.setPrototypeOfå…¼å®¹æ€§
  _setPrototypeOf = Object.setPrototypeOf
    ? Object.setPrototypeOf.bind()
    : function _setPrototypeOf(o, p) {
        o.__proto__ = p
        return o
      }
  return _setPrototypeOf(o, p)
}

function _typeof(o) {
  '@babel/helpers - typeof'
  return (
    (_typeof =
      'function' == typeof Symbol && 'symbol' == typeof Symbol.iterator
        ? function (o) {
            return typeof o
          }
        : function (o) {
            return o &&
              'function' == typeof Symbol &&
              o.constructor === Symbol &&
              o !== Symbol.prototype
              ? 'symbol'
              : typeof o
          }),
    _typeof(o)
  )
}

/* 
      instance:this
      Constructor:æ„é€ å‡½æ•°æœ¬èº« 
      åˆ¤æ–­æ˜¯å¦é€šè¿‡newè°ƒç”¨ å¦‚æœä¸æ˜¯æŠ¥é”™æç¤º
    */
function _classCallCheck(instance, Constructor) {
  if (!(instance instanceof Constructor)) {
    throw new TypeError('Cannot call a class as a function')
  }
}

/* 
      æ–¹æ³•æ•´åˆ
      target:æ„é€ å‡½æ•°æœ¬èº«/æ„é€ å‡½æ•°å¯¹åº”çš„åŸå‹å¯¹è±¡
      props: æ‰€æœ‰å‡½æ•°
    */
function _defineProperties(target, props) {
  for (var i = 0; i < props.length; i++) {
    //æ–¹æ³•ä»¥é”®å€¼å¯¹çš„å½¢å¼å­˜å‚¨  props[i]å°±æ˜¯å­˜å‚¨çš„å‡½æ•° ä¾‹:{key:"eat",value:å‡½æ•°}
    var descriptor = props[i]
    descriptor.enumerable = descriptor.enumerable || false
    descriptor.configurable = true
    if ('value' in descriptor) descriptor.writable = true
    //_toPropertyKeyä¸»è¦ç”¨äºç¡®ä¿å¯¹è±¡çš„å±æ€§é”®å¯ä»¥è¢«æ­£ç¡®å¤„ç†
    //å°†ä¿å­˜çš„å‡½æ•°å­˜æ”¾åœ¨targetä¸­
    Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor)
  }
}

/* 
      å¯¹åŸå‹å¯¹è±¡æ–¹æ³•å’Œç±»æ–¹æ³•è¿›è¡Œæ±‡æ€»æ•´åˆ 
      Constructor:æ„é€ å‡½æ•°æœ¬èº«
      protoProps:å®ä¾‹å¯¹è±¡ä¸Šçš„å‡½æ•°
      staticProps:ç±»æ–¹æ³•
    */
function _createClass(Constructor, protoProps, staticProps) {
  //åŸå‹å¯¹è±¡æ–¹æ³•
  if (protoProps) _defineProperties(Constructor.prototype, protoProps)
  //ç±»æ–¹æ³•
  if (staticProps) _defineProperties(Constructor, staticProps)

  Object.defineProperty(Constructor, 'prototype', { writable: false })
  return Constructor
}

function _toPropertyKey(t) {
  var i = _toPrimitive(t, 'string')
  return 'symbol' == _typeof(i) ? i : i + ''
}

function _toPrimitive(t, r) {
  if ('object' != _typeof(t) || !t) return t
  var e = t[Symbol.toPrimitive]
  if (void 0 !== e) {
    var i = e.call(t, r || 'default')
    if ('object' != _typeof(i)) return i
    throw new TypeError('@@toPrimitive must return a primitive value.')
  }
  return ('string' === r ? String : Number)(t)
}

/* 
      å®šä¹‰çš„personå¯¹è±¡
    */
var Person = /*#__PURE__*/ (function () {
  function Person(name, age) {
    //åˆ¤æ–­æ˜¯å¦é€šè¿‡newåˆ›å»ºå®ä¾‹å¯¹è±¡
    _classCallCheck(this, Person)
    this.name = name
  }

  //æ•´åˆæ‰€æœ‰å‡½æ•°
  return _createClass(
    Person,
    [
      {
        key: 'eat',
        value: function eat(food) {
          // \u5728\u5403  : åœ¨åƒ
          console.log(''.concat(this.name, '\u5728\u5403').concat(food))
        },
        //ç±»æ–¹æ³•
      },
    ],
    [
      {
        key: 'play',
        value: function play() {
          console.log('å¥½å¥½ç©')
        },
      },
    ],
  )
})()

/* 
      å°†Personä»¥å‚æ•°ä¼ å…¥ ä½œç”¨:ä½¿å…¶å½¢æˆçº¯å‡½æ•°

    */
var Student = /*#__PURE__*/ (function (_Person) {
  function Student(name, age, skill) {
    var _this
    //åˆ¤æ–­æ˜¯å¦é€šè¿‡newæ„å»ºå®ä¾‹
    _classCallCheck(this, Student)

    _this = _callSuper(this, Student, [name, age])
    _this.skill = skill
    return _this
  }

  //ç»§æ‰¿
  _inherits(Student, _Person)

  return _createClass(Student)
})(Person)

var student = new Student('å–½å–½', 18, 'javascript')
student.eat('ğŸŸ') // å–½å–½åœ¨åƒğŸŸ
```

å®ç°æµç¨‹ç®€è¿°

1. çˆ¶ç±»å¯¹è±¡ç”Ÿæˆ

```js
//è‡ªåŠ¨æ‰§è¡Œå‡½æ•° ç”ŸæˆPersonç±»
var Person = /*#__PURE__*/ (function () {
  function Person(name, age) {
    //åˆ¤æ–­æ˜¯å¦é€šè¿‡newåˆ›å»ºå®ä¾‹å¯¹è±¡
    _classCallCheck(this, Person)
    this.name = name
  }
  //æ•´åˆæ‰€æœ‰å‡½æ•°
  return _createClass(
    Person,
    [
      {
        key: 'eat',
        value: function eat(food) {
          console.log(''.concat(this.name, '\u5728\u5403').concat(food))
        },
        //ç±»æ–¹æ³•
      },
    ],
    [
      {
        key: 'play',
        value: function play() {
          console.log('å¥½å¥½ç©')
        },
      },
    ],
  )
})()
```

2. æ‰§è¡Œ\_createClass å‡½æ•° å°†å®šä¹‰çš„å‡½æ•°å­˜æ”¾ä¹‹åŸå‹å¯¹è±¡/æ„é€ å‡½æ•°æœ¬èº«ä¸­

```js
/* 
      å¯¹å®ä¾‹æ–¹æ³•å’Œç±»æ–¹æ³•è¿›è¡Œæ±‡æ€»æ•´åˆ protoProps[]å­˜æ”¾åœ¨åŸå‹å¯¹è±¡ä¸­ staticProps[]å­˜æ”¾åœ¨æ„é€ å‡½æ•°æœ¬èº«
      Constructor:æ„é€ å‡½æ•°æœ¬èº«
      protoProps:å®ä¾‹å¯¹è±¡ä¸Šçš„å‡½æ•°
      staticProps:ç±»æ–¹æ³•
*/
function _createClass(Constructor, protoProps, staticProps) {
  //åŸå‹å¯¹è±¡æ–¹æ³•
  if (protoProps) _defineProperties(Constructor.prototype, protoProps)
  //ç±»æ–¹æ³•
  if (staticProps) _defineProperties(Constructor, staticProps)

  //æ„é€ å‡½æ•°prototypeä¸å¯è¢«æ›´æ”¹
  Object.defineProperty(Constructor, 'prototypeä¸å¯è¢«æ›´æ”¹', { writable: false })

  return Constructor
}

/* 
      æ–¹æ³•æ•´åˆ
      target:æ„é€ å‡½æ•°æœ¬èº«/æ„é€ å‡½æ•°å¯¹åº”çš„åŸå‹å¯¹è±¡
      props: æ‰€æœ‰å‡½æ•°æ•°ç»„
    */
function _defineProperties(target, props) {
  for (var i = 0; i < props.length; i++) {
    //æ–¹æ³•ä»¥é”®å€¼å¯¹çš„å½¢å¼å­˜å‚¨  props[i]å°±æ˜¯å­˜å‚¨çš„å‡½æ•° ä¾‹:{key:"eat",value:å‡½æ•°}
    var descriptor = props[i]
    descriptor.enumerable = descriptor.enumerable || false
    descriptor.configurable = true
    if ('value' in descriptor) descriptor.writable = true
    //_toPropertyKeyä¸»è¦ç”¨äºç¡®ä¿å¯¹è±¡çš„å±æ€§é”®å¯ä»¥è¢«æ­£ç¡®å¤„ç†
    //å°†ä¿å­˜çš„å‡½æ•°å­˜æ”¾åœ¨targetä¸­
    Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor)
  }
}
```

3. å­ç±»å¯¹è±¡ç”Ÿæˆ

```js
/* 
      å°†Personä»¥å‚æ•°ä¼ å…¥ ä½œç”¨:ä½¿å…¶å½¢æˆçº¯å‡½æ•°
  */
var Student = /*#__PURE__*/ (function (_Person) {
  function Student(name, age, skill) {
    var _this
    //åˆ¤æ–­æ˜¯å¦é€šè¿‡newæ„å»ºå®ä¾‹
    _classCallCheck(this, Student)

    _this = _callSuper(this, Student, [name, age])
    debugger
    _this.skill = skill
    return _this
  }

  //ç»§æ‰¿
  _inherits(Student, _Person)

  return _createClass(Student)
})(Person)
```

4. è°ƒç”¨\_inherits å‡½æ•°å®ç°ç»§æ‰¿

```js
/* 
      é€šè¿‡å¯„ç”Ÿç»„åˆå¼å®ç°ç»§æ‰¿
      subClass:å­ç±»
      superClass:çˆ¶ç±»
    */
function _inherits(subClass, superClass) {
  //è¾¹ç•Œåˆ¤æ–­ çˆ¶ç±»è¦ä¹ˆæ˜¯ä¸ä¸ºå‡½æ•°è¦ä¹ˆæ˜¯ä¸ä¸ºnull
  if (typeof superClass !== 'function' && superClass !== null) {
    throw new TypeError('Super expression must either be null or a function')
  }

  //å¯„ç”Ÿå¼ç»„åˆç»§æ‰¿ ç”Ÿæˆä¸€ä¸ªçˆ¶ç±»å®ä¾‹å¯¹è±¡ èµ‹å€¼ç»™å­ç±»çš„åŸå‹å¯¹è±¡ è¿™æ ·å­ç±»çš„åŸå‹å¯¹è±¡å³ä¸ºçˆ¶ç±»çš„å®ä¾‹å¯¹è±¡ å½¢æˆåŸå‹é“¾
  subClass.prototype = Object.create(superClass && superClass.prototype, {
    constructor: { value: subClass, writable: true, configurable: true },
  })

  //é…ç½®å­ç±»prototypeå±æ€§ä¸å¯è¢«ä¿®æ”¹
  Object.defineProperty(subClass, 'prototype', { writable: false })

  // å°†å­ç±»æ„é€ å‡½æ•°çš„__proto__å±æ€§ä¿®æ”¹ä¸ºçˆ¶ç±»æ„é€ å‡½æ•°
  if (superClass) _setPrototypeOf(subClass, superClass)
}

/* 
      å°†å­ç±»æ„é€ å‡½æ•°çš„__proto__ä¿®æ”¹ä¸ºçˆ¶ç±»æ„é€ å‡½æ•°  ä¾‹:Student.__proto__ = Person ç¡®ä¿Studentä¹Ÿå¯ä»¥ä½¿ç”¨çˆ¶ç±»çš„ç±»æ–¹æ³•
      o:å­ç±»
      p:çˆ¶ç±»
    */
function _setPrototypeOf(o, p) {
  //åˆ¤æ–­Object.setPrototypeOfå…¼å®¹æ€§
  _setPrototypeOf = Object.setPrototypeOf
    ? Object.setPrototypeOf.bind()
    : function _setPrototypeOf(o, p) {
        o.__proto__ = p
        return o
      }
  return _setPrototypeOf(o, p)
}
```

5. æ‰§è¡Œ\_createClass å‡½æ•° å’Œ Person æ•ˆæœä¸€è‡´ ä¸å†èµ˜è¿°

6. åˆ›å»ºå®ä¾‹å¯¹è±¡

```js
var student = new Student('å–½å–½', 18, 'javascript')
```

7. Student æ„é€ å‡½æ•°æ‰§è¡Œ

```js
function Student(name, age, skill) {
  var _this
  //åˆ¤æ–­æ˜¯å¦é€šè¿‡newæ„å»ºå®ä¾‹
  _classCallCheck(this, Student)

  _this = _callSuper(this, Student, [name, age])
  _this.skill = skill
  return _this
}
```

8. è¾¹ç•Œåˆ¤æ–­ æ˜¯å¦é€šè¿‡ new åˆ›å»º

```js
/* 
      instance:this
      Constructor:æ„é€ å‡½æ•°æœ¬èº« 
      åˆ¤æ–­æ˜¯å¦é€šè¿‡newè°ƒç”¨ å¦‚æœä¸æ˜¯æŠ¥é”™æç¤º
    */
function _classCallCheck(instance, Constructor) {
  if (!(instance instanceof Constructor)) {
    throw new TypeError('Cannot call a class as a function')
  }
}
```

9. è°ƒç”¨\_callSuper å‡½æ•° å®ç°å€Ÿç”¨æ„é€ å‡½æ•°ä¸ºå­ç±»å±æ€§èµ‹å€¼

```js
/* 
      t:this
      o:å­ç±»åŸå‹
      e:ç›¸åŒå±æ€§
    */
function _callSuper(t, o, e) {
  return (
    //è·å–å­ç±»__proto__å±æ€§ åœ¨_inheritså‡½æ•°å®ç°ç»§æ‰¿æ—¶å·²ç»å­ç±»__proto__å±æ€§ä¿®æ”¹ä¸ºçˆ¶ç±»æœ¬èº« æ­¤æ—¶è·å¾—oä¸ºçˆ¶ç±»æœ¬èº«
    (o = _getPrototypeOf(o)),
    _possibleConstructorReturn(
      t,
      //åˆ¤æ–­æ˜¯å¦æ”¯æŒReflectå†™æ³• å¦‚æœæ”¯æŒé€šè¿‡Reflectè°ƒç”¨æ„é€ å‡½æ•° è¿”å›å€¼ä¸ºå­ç±»å®ä¾‹å¯¹è±¡ å¦‚æœä¸æ”¯æŒå°±ç”¨apply ä¸Šé¢oå·²è¢«ä¿®æ”¹ä¸ºå­ç±»__proto__å±æ€§ è¿”å›å€¼ä¸ºundefined ä¾‹å­:Person.apply(this,[ç›¸åŒå±æ€§])
      _isNativeReflectConstruct()
        ? /* 
            o: ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ„é€ å‡½æ•°ï¼Œè¿™é‡Œå·²ç»é€šè¿‡_getPrototypeOfè¢«è®¾ç½®ä¸ºçˆ¶ç±»ã€‚
            e || []: ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¼ é€’ç»™æ„é€ å‡½æ•°çš„å‚æ•°åˆ—è¡¨ã€‚å¦‚æœeå­˜åœ¨ï¼Œåˆ™ä½¿ç”¨eï¼›å¦åˆ™ä½¿ç”¨ç©ºæ•°ç»„[]ã€‚
            _getPrototypeOf(t).constructor: ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯newTargetï¼Œç”¨äºæŒ‡å®šå®é™…è¢«è°ƒç”¨çš„æ„é€ å‡½æ•°ã€‚
            è¿™é‡Œé€šè¿‡_getPrototypeOf(t).constructorè·å–ï¼Œtä¸€èˆ¬ä»£è¡¨å­ç±»å®ä¾‹ã€‚è¿™æ ·åšçš„ç›®çš„æ˜¯ç¡®ä¿åœ¨è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°æ—¶ï¼Œnew.targetæŒ‡å‘çš„æ˜¯å­ç±»æ„é€ å‡½æ•°
            */
          Reflect.construct(o, e || [], _getPrototypeOf(t).constructor)
        : o.apply(t, e),
    )
  )
}

/* 
      o:å­ç±»
      è·å–å­ç±»__proto__å±æ€§
    */
function _getPrototypeOf(o) {
  //Object.setPrototypeOfå…¼å®¹æ€§åˆ¤æ–­
  _getPrototypeOf = Object.setPrototypeOf
    ? Object.getPrototypeOf.bind()
    : function _getPrototypeOf(o) {
        return o.__proto__ || Object.getPrototypeOf(o)
      }
  return _getPrototypeOf(o)
}

/* 
      ç”¨äºå¤„ç†ä»çˆ¶ç±»æ„é€ å‡½æ•°æˆ–æ–¹æ³•è°ƒç”¨è¿”å›çš„å€¼
      self:this
      call: undefined/é€šè¿‡Reflect.constructåˆ›å»ºå‡ºæ¥å¯¹è±¡
    */
function _possibleConstructorReturn(self, call) {
  //å¦‚æœè°ƒç”¨ç»“æœæ˜¯å¯¹è±¡æˆ–å‡½æ•°ï¼Œé‚£ä¹ˆå¯ä»¥ç›´æ¥è¿”å›è¯¥ç»“æœã€‚
  if (call && (_typeof(call) === 'object' || typeof call === 'function')) {
    return call
  } //è°ƒç”¨è¿”å›äº†ä¸€ä¸ªéundefinedçš„éå¯¹è±¡å€¼ï¼ŒæŠ›å‡ºä¸€ä¸ªTypeError
  else if (call !== void 0) {
    throw new TypeError(
      'Derived constructors may only return object or undefined',
    )
  }
  //ç¡®ä¿å½“å‰å®ä¾‹å·²ç»è¢«æ­£ç¡®åˆå§‹åŒ–ã€‚
  return _assertThisInitialized(self)
}

function _assertThisInitialized(self) {
  //å¦‚æœselfä¸ºundefinedï¼Œæ„å‘³ç€çˆ¶ç±»çš„æ„é€ å‡½æ•°æ²¡æœ‰è¢«æ­£ç¡®è°ƒç”¨
  if (self === void 0) {
    throw new ReferenceError(
      "this hasn't been initialised - super() hasn't been called",
    )
  }
  //è¿”å›é€šè¿‡çˆ¶ç±»æ„é€ å‡½æ•°èµ‹å€¼å±æ€§çš„å­ç±»
  return self
}
```

10. å¯¹ä¸åŒå±æ€§è¿›è¡Œèµ‹å€¼å¹¶è¿”å›å®ä¾‹å¯¹è±¡

```js
function Student(name, age, skill) {
  var _this
  //åˆ¤æ–­æ˜¯å¦é€šè¿‡newæ„å»ºå®ä¾‹
  _classCallCheck(this, Student)
  //é€šè¿‡å€Ÿç”¨æ„é€ å‡½æ•° è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°èµ‹å€¼ç›¸åŒçš„å±æ€§ å¹¶å°†å­ç±»å®ä¾‹è¿”å›
  _this = _callSuper(this, Student, [name, age])
  //ä¸ºä¸åŒå±æ€§è¿›è¡Œèµ‹å€¼æ“ä½œ
  _this.skill = skill
  //è¿”å›å®ä¾‹å¯¹è±¡
  return _this
}
```

---

### class

`class`å…³é”®å­—ç”¨äºå®šä¹‰ä¸€ä¸ªç±»ï¼Œç±»æ˜¯åˆ›å»ºå¯¹è±¡çš„æ¨¡æ¿ã€‚åœ¨ ES6ï¼ˆECMAScript 2015ï¼‰ä¹‹å‰ï¼ŒJavaScript ä½¿ç”¨å‡½æ•°å’ŒåŸå‹æ¥å®ç°ç±»ä¼¼ç±»çš„ç»“æ„ã€‚ES6 å¼•å…¥çš„`class`è¯­æ³•æä¾›äº†ä¸€ç§æ›´æ¸…æ™°ã€æ›´ç›´è§‚çš„æ–¹å¼æ¥å®šä¹‰å’Œåˆ›å»ºå¯¹è±¡åŸå‹ã€‚

```js
class Person {
  constructor(name) {
    this.name = name
  }
}

var person = new Person('å–½å–½')
console.log(person) //Person { name: 'å–½å–½' }
```

**ç±»å£°æ˜å’Œå‡½æ•°å£°æ˜åŒºåˆ«**

å‡½æ•°å£°æ˜å’Œç±»å£°æ˜ä¹‹é—´çš„ä¸€ä¸ªé‡è¦åŒºåˆ«åœ¨äºï¼Œå‡½æ•°å£°æ˜ä¼šæå‡ï¼Œç±»å£°æ˜ä¸ä¼šã€‚ä½ é¦–å…ˆéœ€è¦å£°æ˜ä½ çš„ç±»ï¼Œç„¶åå†è®¿é—®å®ƒï¼Œå¦åˆ™ç±»ä¼¼ä»¥ä¸‹çš„ä»£ç å°†æŠ›å‡º ReferenceError

```js
var person = new Person('å–½å–½')

class Person {
  constructor(name) {
    this.name = name
  }
}

console.log(person) // Uncaught ReferenceError: Cannot access 'Person' before initialization
```

```js
var student = new Student('å–½å–½')

function Student(name) {
  this.name = name
}

console.log(student) //Student { name: 'å–½å–½' }
```

**constructor**

constructor æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æ–¹æ³•ï¼Œç”¨äºåˆ›å»ºå’Œåˆå§‹åŒ–é€šè¿‡ç±»åˆ›å»ºçš„å¯¹è±¡ã€‚å½“é€šè¿‡ new å…³é”®å­—è°ƒç”¨ç±»åˆ›å»ºå®ä¾‹æ—¶,é»˜è®¤è°ƒç”¨ constructor æ–¹æ³•ã€‚æ¯ä¸ªç±»åªèƒ½æœ‰ä¸€ä¸ª constructorã€‚å¦‚æœæœªæ˜¾å¼å®šä¹‰ constructorï¼Œåˆ™ä¼šä½¿ç”¨ä¸€ä¸ªé»˜è®¤çš„ constructorã€‚å¦‚æœç±»åŒ…å«å¤šä¸ª constructor çš„æ–¹æ³•ï¼Œåˆ™å°†æŠ›å‡º ä¸€ä¸ª SyntaxError ã€‚

```js
class Person {
  constructor(name) {
    this.name = name
  }
}
```

**static**

`static`å…³é”®å­—ç”¨äºå®šä¹‰ä¸€ä¸ªç±»çš„é™æ€æ–¹æ³•ã€‚é™æ€æ–¹æ³•å¯ä»¥è¢«ç±»æœ¬èº«è°ƒç”¨ï¼Œè€Œä¸æ˜¯ç”±ç±»çš„å®ä¾‹è°ƒç”¨ã€‚ç›¸å½“äºåˆ›å»ºä¸€ä¸ªç±»æ–¹æ³•ã€‚

```js
class Person {
  static sayHello() {
    return 'Hello!'
  }
}
console.log(Person.sayHello()) // ç›´æ¥é€šè¿‡ç±»è°ƒç”¨é™æ€æ–¹æ³•
```

åä¹‹ç›´æ¥åœ¨ç±»ä»£ç å—ä¸­å®šä¹‰çš„å‡½æ•°åˆ™ä¸ºå®ä¾‹å¯¹è±¡

```js
class Person {
  constructor(name) {
    this.name = name
  }
  //å­˜å‚¨åœ¨PersonåŸå‹å¯¹è±¡ä¸­
  eat(food) {
    console.log(`${this.name}åœ¨åƒ${food}`)
  }
}

var person = new Person('å–½å–½')

person.eat('ğŸŸ') // å–½å–½åœ¨åƒğŸŸ  é€šè¿‡å®ä¾‹è°ƒç”¨åŸå‹å¯¹è±¡ä¸­çš„æ–¹æ³•
```

### let/const

ES6 å¼•å…¥äº†å—çº§ä½œç”¨åŸŸçš„æ¦‚å¿µï¼Œä¸»è¦é€šè¿‡`let`å’Œ`const`å£°æ˜å®ç°ã€‚

**ES6 å¼•å…¥çš„å˜åŒ–**

è¯æ³•ç¯å¢ƒï¼ˆLexical Environmentï¼‰å’Œå˜é‡ç¯å¢ƒï¼ˆVariable Environmentï¼‰å–ä»£äº†ä¼ ç»Ÿçš„å˜é‡å¯¹è±¡ï¼ˆVOï¼‰ã€‚ç”¨äºä¸åŒç±»å‹çš„å˜é‡å£°æ˜ã€‚

æ‰§è¡Œä¸Šä¸‹æ–‡çš„ç»„æˆ : æ¯ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡ï¼ˆæ— è®ºæ˜¯å…¨å±€çš„è¿˜æ˜¯å‡½æ•°çš„ï¼‰éƒ½åŒ…å«ä¸¤ä¸ªä¸è¯æ³•ç¯å¢ƒç›¸å…³çš„ä¸»è¦ç»„ä»¶ï¼š

1. **è¯æ³•ç¯å¢ƒï¼ˆLexicalEnvironmentï¼‰**
2. **å˜é‡ç¯å¢ƒï¼ˆVariableEnvironmentï¼‰**

è¿™ä¸¤ä¸ªç»„ä»¶éƒ½æ˜¯è¯æ³•ç¯å¢ƒçš„ç±»å‹ã€‚

å…³äºè¯æ³•ç¯å¢ƒå’Œå˜é‡ç¯å¢ƒ:

**è¯æ³•ç¯å¢ƒï¼ˆLexicalEnvironmentï¼‰**ï¼šåœ¨æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­ï¼Œè¿™ä¸ªè¯æ³•ç¯å¢ƒç»„ä»¶ç”¨äºå­˜å‚¨ä½¿ç”¨ let å’Œ const å£°æ˜çš„å˜é‡ï¼Œä»¥åŠç›¸å…³çš„å‡½æ•°å’Œå—ä½œç”¨åŸŸã€‚å®ƒä¹Ÿå¯èƒ½æŒ‡å‘å‡½æ•°ä½œç”¨åŸŸå†…éƒ¨çš„æ›´æ·±å±‚æ¬¡çš„è¯æ³•ç¯å¢ƒï¼ˆå¦‚å—çº§ä½œç”¨åŸŸï¼‰ã€‚

**å˜é‡ç¯å¢ƒï¼ˆVariableEnvironmentï¼‰**ï¼šè¿™ä¸ªç»„ä»¶åœ¨æ¦‚å¿µä¸Šä¸è¯æ³•ç¯å¢ƒç±»ä¼¼ï¼Œä½†åœ¨ ES6 å’Œæ›´é«˜ç‰ˆæœ¬ä¸­ï¼Œå®ƒä¸“é—¨ç”¨äºå­˜å‚¨ä½¿ç”¨ var å£°æ˜çš„å˜é‡ã€‚åœ¨å‡½æ•°ä½œç”¨åŸŸä¸­ï¼Œè¿™æ„å‘³ç€å®ƒç”¨äºå­˜å‚¨æ—§å¼çš„ var å£°æ˜çš„å˜é‡ï¼Œè¿™äº›å˜é‡å…·æœ‰å‡½æ•°ä½œç”¨åŸŸæˆ–å…¨å±€ä½œç”¨åŸŸï¼Œè€Œä¸æ˜¯å—çº§ä½œç”¨åŸŸã€‚

è¯æ³•ç¯å¢ƒçš„ç»“æ„:

ä¸€ä¸ªè¯æ³•ç¯å¢ƒæ˜¯ç”±ç¯å¢ƒè®°å½•ï¼ˆEnvironment Recordï¼‰å’Œä¸€ä¸ªå¤–éƒ¨è¯æ³•ç¯å¢ƒï¼ˆouter Lexical Environmentï¼‰ç»„æˆï¼›

1. ç¯å¢ƒè®°å½•:å­˜å‚¨å˜é‡å’Œå‡½æ•°å£°æ˜çš„å®é™…ä½ç½®ã€‚ç¯å¢ƒè®°å½•æœ¬èº«åˆ†ä¸ºä¸¤ç§ç±»å‹ï¼š

   - **å£°æ˜å¼ç¯å¢ƒè®°å½•ï¼ˆDeclarative Environment Recordï¼‰**ï¼šç”¨äºå­˜å‚¨å‡½æ•°ã€`let`ã€`const`,`var`å£°æ˜çš„å˜é‡ç­‰ã€‚

   - **å¯¹è±¡ç¯å¢ƒè®°å½•ï¼ˆObject Environment Recordï¼‰**ï¼šç”¨äºå®šä¹‰å…¨å±€ç¯å¢ƒä¸­çš„å˜é‡å’Œå‡½æ•°ã€‚å®ƒçš„ä¸»è¦ç›®çš„æ˜¯å°†å…¨å±€ä½œç”¨åŸŸä¸­å£°æ˜çš„å˜é‡å’Œå‡½æ•°å…³è”åˆ°å…¨å±€å¯¹è±¡ä¸Šã€‚

     å¯¹è±¡å¼ç¯å¢ƒè®°å½•ä¼šè®°å½• `var` å£°æ˜çš„æ ‡è¯†ç¬¦ï¼ŒåŒæ—¶ç»‘å®šåˆ°**ç»‘å®šå¯¹è±¡**çš„åŒåå±æ€§ä¸Š,å³å¦‚æœåœ¨å…¨å±€ç¯å¢ƒä¸­ä½¿ç”¨ `var` æ¥å£°æ˜ï¼Œå°±ä¼šé€šè¿‡**å…¨å±€ç¯å¢ƒè®°å½•**æŒ‡å‘çš„**å¯¹è±¡å¼ç¯å¢ƒè®°å½•**ç»‘å®šåˆ° `window` ä¸Šï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡ `window` æ¥è®¿é—®ç”¨ `var` å£°æ˜çš„å˜é‡ã€‚

2. **å¤–éƒ¨è¯æ³•ç¯å¢ƒçš„å¼•ç”¨ï¼ˆOuter Lexical Environment Referenceï¼‰**ï¼šæŒ‡å‘å¤–éƒ¨è¯æ³•ç¯å¢ƒï¼ˆå³çˆ¶çº§ä½œç”¨åŸŸï¼‰ï¼Œç”¨äºå®ç°è¯æ³•ä½œç”¨åŸŸçš„é“¾å¼æŸ¥æ‰¾æœºåˆ¶ã€‚

**æš‚æ—¶æ€§æ­»åŒº**

æš‚æ—¶æ€§æ­»åŒºï¼ˆTDZï¼‰æ˜¯ä¸€ä¸ªæœ¯è¯­ï¼Œç”¨äºæè¿°`let`å’Œ`const`å˜é‡ä»å—å¼€å§‹åˆ°åˆå§‹åŒ–ä¹‹é—´çš„åŒºåŸŸã€‚åœ¨è¿™ä¸ªåŒºåŸŸå†…è®¿é—®å˜é‡ä¼šå¯¼è‡´`ReferenceError`ã€‚è¿™æ˜¯å› ä¸º`let`å’Œ`const`å£°æ˜çš„å˜é‡ä¸ä¼šæå‡è‡³å®ƒä»¬æ‰€åœ¨çš„å—ä½œç”¨åŸŸé¡¶éƒ¨ï¼ˆä¸`var`å£°æ˜çš„å˜é‡ä¸åŒï¼‰ï¼Œä½†å®ƒä»¬åœ¨å£°æ˜ä¹‹å‰å°±å·²ç»å­˜åœ¨äºä½œç”¨åŸŸä¸­ã€‚

```js
console.log(message) //undefined

//å˜é‡ä¼šè¢«æå‰åˆ›å»ºå‡ºæ¥,ä½†å¹¶ä¸èƒ½è¢«è®¿é—®,ç›´åˆ°è¯æ³•ç»‘å®šè¢«æ±‚å€¼
console.log(age) //Uncaught ReferenceError: Cannot access 'age' before initialization

let age
/*ä»è¿™é‡Œå¼€å§‹

æš‚æ—¶æ€§æ­»åŒº  

åˆ°è¿™ä¸€éƒ¨åˆ†*/ age = 10

var message

message = 'hello'
```

**var å’Œ let/const çš„åŒºåˆ«**

1. var ä¸ä¼šå½¢æˆå—çº§ä½œç”¨åŸŸ,let/const ä¼š

```js
//ageå°†å­˜æ”¾åœ¨å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡è¯æ³•ç¯å¢ƒä¸‹çš„å£°æ˜å¼ç¯å¢ƒè®°å½•ä¸­
let age = 10

{
  //ä¸ä¼šå½¢æˆå—çº§ä½œç”¨åŸŸ messageå°†å­˜æ”¾åœ¨å…¨å±€å˜é‡ç¯å¢ƒä¸­çš„å¯¹è±¡ç¯å¢ƒè®°å½•ä¸­
  var message = 'hello'

  //å½¢æˆå—çº§ä½œç”¨åŸŸ å­˜å‚¨åœ¨è¿™ä¸ªå—çº§æ‰§è¡Œä¸Šä¸‹æ–‡è¯æ³•ç¯å¢ƒçš„å£°æ˜å¼ç¯å¢ƒè®°å½•ä¸­
  let title = 'å–½å–½'
}

console.log(age, message, title) //title is not defined
```

2. let/const ä¸ä¼šä½œç”¨åŸŸæå‡,var æœ‰
3. let/const ä¸å¯ä»¥é‡å¤å£°æ˜,var å¯ä»¥

<Callout icon="âš ï¸" type="warning">
  æ³¨: **å¯¹äºå‡½æ•°å£°æ˜ï¼ŒES6
  ä¹‹å‰çš„ç¯å¢ƒï¼ˆæ²¡æœ‰å—çº§ä½œç”¨åŸŸçš„æ¦‚å¿µï¼‰ï¼Œå‡½æ•°å£°æ˜ä¹Ÿä¼šæå‡è‡³æ‰€åœ¨ä½œç”¨åŸŸçš„é¡¶éƒ¨ï¼Œå¹¶ä¸”å¯ä»¥åœ¨æ•´ä¸ªä½œç”¨åŸŸå†…è®¿é—®ã€‚åœ¨
  ES6
  åŠä¹‹åå¼•å…¥å—çº§ä½œç”¨åŸŸçš„ç¯å¢ƒä¸­ï¼Œå‡½æ•°å£°æ˜çš„è¡Œä¸ºç±»ä¼¼äº`let`å’Œ`const`ï¼Œåœ¨å—çº§ä½œç”¨åŸŸå†…éƒ¨æå‡ï¼Œå¹¶ä¸”åªèƒ½åœ¨å£°æ˜ä¹‹åè®¿é—®ã€‚**
</Callout>

```js
// foo() æŠ¥é”™:// foo is not a function

{
  function foo() {
    console.log('foo')
  }
}

foo() //foo
```

### Symbol

symbol æ˜¯ä¸€ç§**åŸºæœ¬æ•°æ®ç±»å‹**ã€‚`Symbol()` å‡½æ•°ä¼šè¿”å› symbol ç±»å‹çš„å€¼ï¼Œè¯¥ç±»å‹å…·æœ‰é™æ€å±æ€§å’Œé™æ€æ–¹æ³•ã€‚æ¯ä¸ªä» `Symbol()` è¿”å›çš„ symbol å€¼éƒ½æ˜¯å”¯ä¸€çš„ã€‚ä¸€ä¸ª symbol å€¼èƒ½ä½œä¸ºå¯¹è±¡å±æ€§çš„æ ‡è¯†ç¬¦ã€‚

```js
var sym1 = Symbol()
//Symbol([description]) description:æè¿°
var sym2 = Symbol('foo')
var sym3 = Symbol('foo')

//æ¯ä¸ªä» `Symbol()` è¿”å›çš„ symbol å€¼éƒ½æ˜¯å”¯ä¸€çš„ã€‚
console.log(sym1 === sym3) //false

//è·å–Symbolæè¿°
console.log(sym2.description) //foo

//åˆ›å»ºç›¸åŒçš„Symbol sym2.description : foo
var sym4 = Symbol.for(sym2.description)

var sym5 = Symbol.for(sym2.description)

console.log(sym4 === sym5) //true

//ä»å…¨å±€ symbol æ³¨å†Œè¡¨ä¸­è·å–æŒ‡å®šSymbol å…±äº«çš„symbol key
//sym4 sym5 å…±åŒä½¿ç”¨fooç”Ÿæˆ æ‰€æœ‰fooä¸ºsym4 sym5çš„å…±äº«symbol key
console.log(Symbol.keyFor(sym4)) //foo
```

### Proxy

\*Proxy å¯¹è±¡ç”¨äºåˆ›å»ºä¸€ä¸ªå¯¹è±¡çš„ä»£ç†ï¼Œä»è€Œå®ç°åŸºæœ¬æ“ä½œçš„æ‹¦æˆªå’Œè‡ªå®šä¹‰ï¼ˆå¦‚å±æ€§æŸ¥æ‰¾ã€èµ‹å€¼ã€æšä¸¾ã€å‡½æ•°è°ƒç”¨ç­‰ï¼‰ã€‚

**ç›‘å¬å¯¹è±¡**

ES5 ä½¿ç”¨ defineProperty è¿›è¡Œç›‘å¬

```js
const obj = {
  name: 'zs',
  age: 10,
}

Object.keys(obj).forEach(function (key) {
  var value = obj[key]

  Object.defineProperty(obj, key, {
    set(newValue) {
      console.log(`ç›‘å¬:${key}å±æ€§é‡æ–°èµ‹å€¼ä¸º:${newValue}`)

      value = newValue
    },

    get() {
      console.log(`ç›‘å¬:è·å–${key}å±æ€§å€¼`)
      return value
    },
  })
})

obj.name = 'å–½å–½' //ç›‘å¬:nameå±æ€§é‡æ–°èµ‹å€¼ä¸º:å–½å–½

console.log(obj) //ç›‘å¬:è·å–ageå±æ€§å€¼ 10
```

ç¼ºç‚¹:æ— æ³•ç›‘å¬å±æ€§åˆ é™¤

```js
const obj = {
  name: 'zs',
  age: 10,
}

/* 
      new Proxy(target, handler)
      target:Proxy ä¼šå¯¹ç›®æ ‡ï¼ˆtargetï¼‰å¯¹è±¡è¿›è¡ŒåŒ…è£…ã€‚
      handler:handler æ˜¯å®šä¹‰äº†ä»£ç†çš„è‡ªå®šä¹‰è¡Œä¸ºçš„å¯¹è±¡
    */
const proxyObj = new Proxy(obj, {
  set(target, key, newValue) {
    console.log(`ç›‘å¬:${key}å±æ€§é‡æ–°èµ‹å€¼ä¸º:${newValue}`)
    target[key] = newValue
  },
  get(target, key) {
    console.log(`ç›‘å¬:è·å–${key}å±æ€§å€¼`)
    return target[key]
  },
  //å¿…é¡»è¿”å›ä¸€ä¸ª Boolean ç±»å‹çš„å€¼ï¼Œè¡¨ç¤ºäº†è¯¥å±æ€§æ˜¯å¦è¢«æˆåŠŸåˆ é™¤ã€‚
  deleteProperty(target, key) {
    console.log(`ç›‘å¬:åˆ é™¤${key}å±æ€§å€¼`)
    delete target[key]
    return true
  },
})

proxyObj.name = 'å–½å–½' //ç›‘å¬:nameå±æ€§é‡æ–°èµ‹å€¼ä¸º:å–½å–½

console.log(proxyObj.age) //ç›‘å¬:è·å–ageå±æ€§å€¼ 10

//ç›‘å¬:åˆ é™¤ageå±æ€§å€¼
delete proxyObj.age

console.log(obj) //{name: 'å–½å–½'}
```

| å¯¹è±¡ä¸­çš„æ–¹æ³•                       | å¯¹åº”è§¦å‘æ¡ä»¶                                                                    |
| ---------------------------------- | ------------------------------------------------------------------------------- |
| handler.getPrototypeOf()           | `Object.getPrototypeOf` æ–¹æ³•çš„æ•æ‰å™¨                                            |
| handler.setPrototypeOf()           | `Object.setPrototypeOf` æ–¹æ³•çš„æ•æ‰å™¨                                            |
| handler.isExtensible()             | `Object.isExtensible` æ–¹æ³•çš„æ•æ‰å™¨                                              |
| handler.preventExtensions()        | `Object.preventExtensions` æ–¹æ³•çš„æ•æ‰å™¨                                         |
| handler.getOwnPropertyDescriptor() | `Object.getOwnPropertyDescriptor` æ–¹æ³•çš„æ•æ‰å™¨                                  |
| handler.defineProperty()           | `Object.defineProperty` æ–¹æ³•çš„æ•æ‰å™¨                                            |
| handler.has()                      | `in` æ“ä½œç¬¦çš„æ•æ‰å™¨                                                             |
| handler.get()                      | å±æ€§è¯»å–æ“ä½œçš„æ•æ‰å™¨                                                            |
| handler.set()                      | å±æ€§è®¾ç½®æ“ä½œçš„æ•æ‰å™¨                                                            |
| handler.deleteProperty()           | `delete` æ“ä½œç¬¦çš„æ•æ‰å™¨                                                         |
| handler.ownKeys()                  | `Object.getOwnPropertyNames` æ–¹æ³•å’Œ `Object.getOwnPropertySymbols` æ–¹æ³•çš„æ•æ‰å™¨ |
| handler.apply()                    | å‡½æ•°è¢«`apply`è°ƒç”¨æ“ä½œçš„æ•æ‰å™¨                                                   |
| handler.construct()                | `new` æ“ä½œç¬¦çš„æ•æ‰å™¨                                                            |

### Reflect

**Reflect** æ˜¯ä¸€ä¸ªå†…ç½®çš„å¯¹è±¡ï¼Œå®ƒæä¾›æ‹¦æˆª JavaScript æ“ä½œçš„æ–¹æ³•ã€‚

æ—©æœŸæ²¡æœ‰è€ƒè™‘å¯¹å¯¹è±¡æœ¬èº«å¦‚ä½•è®¾è®¡æ›´åŠ è§„èŒƒ,è®¸å¤š API æ”¾åˆ°äº† Object,å¯¼è‡´ä¸€ä¸ªå†…ç½®ç±»é€æ¸ç¹é‡ã€‚æ‰€ä»¥åœ¨ ES6 æ–°å¢äº† Reflect,è®©è¿™äº› API å‡ ç§å­˜å‚¨åœ¨äº† Reflect å¯¹è±¡ä¸Šã€‚å¹¶ä¸”å¯¹äºåŸå§‹çš„ä¸€äº› Object æ–¹æ³•ä¸åŒ,`Reflect`çš„æ–¹æ³•åœ¨æ— æ³•å®ŒæˆæœŸæœ›æ“ä½œæ—¶ï¼Œå¾€å¾€è¿”å›`false`è€Œä¸æ˜¯æŠ›å‡ºé”™è¯¯ã€‚è¿™ä½¿å¾—é”™è¯¯å¤„ç†å˜å¾—æ›´åŠ çµæ´»ï¼Œå°¤å…¶æ˜¯åœ¨ä½¿ç”¨`Proxy`è¿›è¡Œå¯¹è±¡æ“ä½œæ‹¦æˆªæ—¶ã€‚

ä¼ ç»Ÿé€š**è¿‡ Object.defineProperty**æ·»åŠ å±æ€§

```js
const obj = {
  name: 'zs',
  age: 10,
}

Object.freeze(obj)
/*  
Uncaught TypeError: Cannot define property message, 
object is not extensible at Function.defineProperty(<anonymous>) 
æŠ¥é”™å¯¼è‡´åé¢ä»£ç æ— æ³•æ­£å¸¸è¿è¡Œ
*/
Object.defineProperty(obj, 'message', {
  value: 'hello',
})

console.log(obj)
```

ä½¿ç”¨**Reflect**æ·»åŠ å±æ€§

```js
const obj = {
  name: 'zs',
  age: 10,
}

Object.freeze(obj)

//ä¸ä¼šæŠ¥é”™ è¿”å›ç»“æœ
/*  
Reflect.defineProperty(obj, 'mseeage', {
     value: 'hello'
}) 
*/

if (
  Reflect.defineProperty(obj, 'mseeage', {
    value: 'hello',
  })
) {
  // æˆåŠŸ
  console.log('Successfully added attribute')
} else {
  // å¤±è´¥
  console.warn('Failed to add attribute...')
}

console.log(obj)
```

é…åˆ Proxy

```js
const obj = {
  _name: 'zs',
  age: 10,

  set name(name) {
    this._name = name
  },

  get name() {
    return this._name
  },
}

const proxtObj = new Proxy(obj, {
  get(target, property, receiver) {
    console.log(`Getting property '${property}'`)
    return Reflect.get(target, property)
  },
  set(target, property, value, receiver) {
    console.log(`Setting property '${property}' to '${value}'`)
    /* 
          thisç»‘å®šä¸ºreceiver:ä»£ç†å¯¹è±¡
          ç›¸å½“äºsetæ—¶this._name thisä¸ºä»£ç†å¯¹è±¡ è¿™æ ·å¯ä»¥ç›‘å¬ä¸¤æ¬¡
          1.proxtObj.nameèµ‹å€¼æ—¶è§¦å‘è®¿é—®å™¨
          2.è®¿é—®å™¨ä¸­this._name = nameå†æ¬¡è§¦å‘ å› ä¸ºç›¸å½“äº proxtObj._name = name
          è¿™ç¡®ä¿äº†æ‰€æœ‰åŸºäºthisçš„æ“ä½œ
          (æ¯”å¦‚åœ¨setterå†…éƒ¨ä¿®æ”¹å¦ä¸€ä¸ªå±æ€§ï¼‰éƒ½æ˜¯åœ¨proxyä¸Šè¿›è¡Œçš„ï¼Œè€Œä¸ä¼šç›´æ¥å½±å“åˆ°targetå¯¹è±¡ã€‚
        */

    return Reflect.set(target, property, value, receiver)
  },
})

proxtObj.name = 'å–½å–½'

//Setting property 'name' to 'å–½å–½'
// Setting property '_name' to 'å–½å–½'
//  Getting property '_name'
//  å–½å–½
console.log(proxtObj._name)
```

| Reflect æ–¹æ³•                         | Object æ–¹æ³•                                                                       | å¤‡æ³¨                                               |
| ------------------------------------ | --------------------------------------------------------------------------------- | -------------------------------------------------- |
| `Reflect.apply()`                    | ç›´æ¥è°ƒç”¨å‡½æ•°ï¼ˆæ— ç›´æ¥å¯¹åº”ï¼‰                                                        | ç”¨äºè°ƒç”¨å‡½æ•°ï¼Œæ›¿ä»£äº†å‡½æ•°çš„`apply`æ–¹æ³•ã€‚            |
| `Reflect.construct()`                | `new`æ“ä½œç¬¦ï¼ˆæ— ç›´æ¥å¯¹åº”ï¼‰                                                         | ç”¨äºæ„é€ å¯¹è±¡ï¼Œç±»ä¼¼äºä½¿ç”¨`new`æ“ä½œç¬¦ã€‚              |
| `Reflect.defineProperty()`           | `Object.defineProperty()`                                                         | ç”¨äºå®šä¹‰å¯¹è±¡ä¸Šçš„ä¸€ä¸ªæ–°å±æ€§æˆ–ä¿®æ”¹ç°æœ‰å±æ€§ã€‚         |
| `Reflect.deleteProperty()`           | `delete`æ“ä½œç¬¦ï¼ˆæ— ç›´æ¥å¯¹åº”ï¼‰                                                      | ç”¨äºåˆ é™¤å¯¹è±¡çš„å±æ€§ã€‚                               |
| `Reflect.get()`                      | ç›´æ¥å±æ€§è®¿é—®ï¼ˆæ— ç›´æ¥å¯¹åº”ï¼‰                                                        | ç”¨äºè·å–å¯¹è±¡çš„å±æ€§ã€‚                               |
| `Reflect.getOwnPropertyDescriptor()` | `Object.getOwnPropertyDescriptor()`                                               | è·å–å¯¹è±¡æŸä¸ªå±æ€§çš„å±æ€§æè¿°ç¬¦ã€‚                     |
| `Reflect.getPrototypeOf()`           | `Object.getPrototypeOf()`                                                         | è·å–å¯¹è±¡çš„åŸå‹ã€‚                                   |
| `Reflect.has()`                      | `in`æ“ä½œç¬¦ï¼ˆæ— ç›´æ¥å¯¹åº”ï¼‰                                                          | åˆ¤æ–­å¯¹è±¡æ˜¯å¦æœ‰æŸä¸ªå±æ€§ã€‚                           |
| `Reflect.isExtensible()`             | `Object.isExtensible()`                                                           | åˆ¤æ–­å¯¹è±¡æ˜¯å¦å¯æ‰©å±•ï¼ˆèƒ½å¦æ·»åŠ æ–°çš„å±æ€§ï¼‰ã€‚           |
| `Reflect.ownKeys()`                  | `Object.keys()`, `Object.getOwnPropertyNames()`, `Object.getOwnPropertySymbols()` | è¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰è‡ªæœ‰å±æ€§ï¼ˆä¸åŒ…æ‹¬ç»§æ‰¿å±æ€§ï¼‰çš„æ•°ç»„ã€‚ |
| `Reflect.preventExtensions()`        | `Object.preventExtensions()`                                                      | é˜²æ­¢å¯¹è±¡æ‰©å±•ã€‚                                     |
| `Reflect.set()`                      | ç›´æ¥å±æ€§èµ‹å€¼ï¼ˆæ— ç›´æ¥å¯¹åº”ï¼‰                                                        | ç”¨äºè®¾ç½®å¯¹è±¡çš„å±æ€§ã€‚                               |
| `Reflect.setPrototypeOf()`           | `Object.setPrototypeOf()`                                                         | è®¾ç½®å¯¹è±¡çš„åŸå‹ã€‚                                   |

---

### Promise

Promise ä»£è¡¨äº†ä¸€ä¸ªæœªæ¥å¯èƒ½ä¼šå®Œæˆæˆ–å¤±è´¥çš„æ“ä½œåŠå…¶ç»“æœã€‚ä½¿ç”¨ Promiseï¼Œå¯ä»¥æ›´å®¹æ˜“åœ°ç»„ç»‡å’Œç®¡ç†å¼‚æ­¥ä»£ç ï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç†å¤šä¸ªå¼‚æ­¥æ“ä½œæ—¶ï¼Œå¯ä»¥é¿å…é™·å…¥å›è°ƒåœ°ç‹±ã€‚

ä¸€ä¸ª `Promise` å¿…ç„¶å¤„äºä»¥ä¸‹å‡ ç§çŠ¶æ€ä¹‹ä¸€ï¼š

- **Pending**ï¼ˆç­‰å¾…ï¼‰ï¼šåˆå§‹çŠ¶æ€ï¼Œæ—¢æ²¡æœ‰è¢«å®Œæˆï¼Œä¹Ÿæ²¡æœ‰è¢«æ‹’ç»ã€‚
- **Fulfilled**ï¼ˆå·²å®Œæˆï¼‰ï¼šæ“ä½œæˆåŠŸå®Œæˆã€‚
- **Rejected**ï¼ˆå·²æ‹’ç»ï¼‰ï¼šæ“ä½œå¤±è´¥ã€‚

```js
/*
      Promise(executor function): executor function,è¿™ä¸ªå‡½æ•°ä¼šç«‹å³æ‰§è¡Œã€‚
    */
let promise = new Promise(function(resolve, reject) {
    // å¼‚æ­¥æ“ä½œ
    if (/* æ“ä½œæˆåŠŸ */) {
        resolve(value); // å°†Promiseçš„çŠ¶æ€æ”¹ä¸ºFulfilled
    } else {
        reject(error); // å°†Promiseçš„çŠ¶æ€æ”¹ä¸ºRejected
    }
})
```

<Callout icon="âš ï¸" type="warning">
  æ³¨:**ä¸€æ—¦çŠ¶æ€è¢«ç¡®å®šä¸‹æ¥ï¼ŒPromise çš„çŠ¶æ€ä¼šè¢« é”æ­»ï¼Œè¯¥ Promise
  çš„çŠ¶æ€æ˜¯ä¸å¯æ›´æ”¹çš„**
</Callout>

**resolve ä¸åŒå€¼çš„åŒºåˆ«**

1. ä¸€ä¸ªæ™®é€šçš„å€¼æˆ–è€…å¯¹è±¡

```js
//ä¸€ä¸ªæ™®é€šçš„å€¼æˆ–è€…å¯¹è±¡
const promise = new Promise((resolve, reject) => {
  resolve(123)
})

//ä¼ ç»™resolveçš„å€¼ä½œä¸ºthençš„å›è°ƒå‚æ•°
promise.then((res) => {
  console.log('res:', res) //res: 123
})
```

2. å¦å¤–ä¸€ä¸ª Promise

```js
//resolve
const p = new Promise((resolve, reject) => {
  setTimeout(() => {
    resolve('å¦ä¸€ä¸ªpromise')
  }, 3000)
})

//å¦å¤–ä¸€ä¸ªPromise
const promise = new Promise((resolve, reject) => {
  //æ–°Promiseä¼šå†³å®šæ­¤Promiseçš„çŠ¶æ€
  resolve(p)
})

//ä¼ ç»™resolveçš„å€¼ä½œä¸ºthençš„å›è°ƒå‚æ•°
promise
  .then((res) => {
    console.log('res:', res) //3000msåè¾“å‡º res: å¦ä¸€ä¸ªpromise
  })
  .catch((err) => {
    console.log('err:', err) //3000msåè¾“å‡º err: å¦ä¸€ä¸ªpromise
  })
```

3. ä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶ä¸”è¿™ä¸ªå¯¹è±¡æœ‰å®ç° then æ–¹æ³•

```js
//ä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶ä¸”è¿™ä¸ªå¯¹è±¡æœ‰å®ç°thenæ–¹æ³•
const promise = new Promise((resolve, reject) => {
  resolve({
    then(resolve, reject) {
      reject('å¯¹è±¡thenæ–¹æ³•...')
    },
  })
})

//ä¼ ç»™resolveçš„å€¼ä½œä¸ºthençš„å›è°ƒå‚æ•°
promise
  .then((res) => {
    console.log('res:', res) //res: å¯¹è±¡thenæ–¹æ³•...
  })
  .catch((err) => {
    console.log('err:', err) //err: å¯¹è±¡thenæ–¹æ³•...
  })
```

**é“¾å¼è°ƒç”¨**

`.then()` æ–¹æ³•æœ€å¤šæ¥å—ä¸¤ä¸ªå‚æ•°ï¼›ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ Promise å…‘ç°æ—¶çš„å›è°ƒå‡½æ•°ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ Promise æ‹’ç»æ—¶çš„å›è°ƒå‡½æ•°ã€‚æ¯ä¸ª `.then()` è¿”å›ä¸€ä¸ªæ–°ç”Ÿæˆçš„ Promise å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡å¯è¢«ç”¨äºé“¾å¼è°ƒç”¨ï¼Œä¾‹å¦‚ï¼š

```js
const myPromise = new Promise((resolve, reject) => {
  setTimeout(() => {
    resolve('foo')
  }, 300)
})

//ä¸æ¨èè¿™ä¹ˆå†™ çœ‹ä¸Šå»æ··ä¹±
myPromise
  .then(
    (res) => {
      console.log('res:', res) //res:foo
    },
    (err) => {
      console.log('err:', err)
    },
  )
  .then(
    (res) => {
      console.log('res:', res) //res:undefined
    },
    (err) => {
      console.log('err:', err)
    },
  )

//æ¨è
myPromise
  .then((res) => {
    //myPromise resolveçš„å€¼ä¼šè¢«ä¼ å‚
    console.log('res:', res) //res:foo
  })
  .then((res) => {
    //æ­¤å¤„çš„resç›¸å½“äºä¸Šä¸€æ­¥.thenç”Ÿæˆæ–°çš„promise; new Promise((resolve)=> { resolve()})
    console.log('res:', res) //res:undefined
  })
  .catch((err) => {
    console.log('err:', err)
  })
```

then è¿”å›å€¼

```js
const myPromise = new Promise((resolve, reject) => {
  setTimeout(() => {
    resolve('foo')
  }, 300)
})

myPromise
  .then((res) => {
    //é»˜è®¤æƒ…å†µä¸‹è¿”å›ä¸€ä¸ªæ–°çš„promise ç­‰åŒäº:new Promise((resolve) = > {resolve()})
    console.log('res:', res) //res:undefined
    //ä½†æˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨è¿”å›æƒ³è¦çš„æ•°æ®
    return 123
  })
  .then((res) => {
    //ç­‰åŒäº:new Promise((resolve) = > {resolve(123)})
    console.log('res:', res) //res:123
    //è¿”å›ä¸€ä¸ªPromise
    return new Promise((resolve) => {
      setTimeout(() => {
        resolve('resolve...')
      }, 3000)
    })
  })
  .then((res) => {
    //ä¸Šä¸€ä¸ª.thençš„promiseçŠ¶æ€
    console.log('res:', res) // 3000ms åè¾“å‡º:res:resolve...
    //thentable...
  })
  .then((res) => {
    //å½“thenæ–¹æ³•æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸æ—¶ï¼Œé‚£ä¹ˆå®ƒå¤„äºrejectçŠ¶æ€ï¼›
    throw new Error('æ‰‹åŠ¨æŠ›å‡ºå¼‚å¸¸')
  })
  .catch((err) => {
    console.log('err:', err) // err: Error: æ‰‹åŠ¨æŠ›å‡ºå¼‚å¸¸
  })
```

---

### è¿­ä»£å™¨

åœ¨ JavaScript ä¸­ï¼Œ**è¿­ä»£å™¨**æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒå®šä¹‰ä¸€ä¸ªåºåˆ—ï¼Œå¹¶åœ¨ç»ˆæ­¢æ—¶å¯èƒ½é™„å¸¦ä¸€ä¸ªè¿”å›å€¼ã€‚è¿­ä»£å™¨å¯¹è±¡é€šè¿‡ next()æ–¹æ³•è¿”å›é›†åˆçš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶é€šè¿‡è¿”å›çš„å¯¹è±¡çš„ done å±æ€§è¡¨æ˜æ˜¯å¦è¿˜æœ‰æ›´å¤šçš„å…ƒç´ ã€‚

ä¸€ä¸ªå¯¹è±¡å¦‚æœè¦æˆä¸ºè¿­ä»£å™¨ï¼Œå®ƒå¿…é¡»å®ç° next()æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•å¿…é¡»è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡åŒ…å«ä¸¤ä¸ªå±æ€§ï¼š

- valueï¼šåºåˆ—ä¸­çš„ä¸‹ä¸€ä¸ªå€¼ã€‚
- doneï¼šå¸ƒå°”å€¼ï¼Œå¦‚æœåºåˆ—ä¸­æ‰€æœ‰çš„å€¼éƒ½å·²ç»è¿”å›ï¼Œåˆ™ä¸º trueï¼›å¦‚æœåºåˆ—ä¸­è¿˜æœ‰å€¼å¯ä»¥è¿”å›ï¼Œåˆ™ä¸º falseã€‚

```js
const num = [1, 56, 11, 90]

function createIterator(arg) {
  let index = 0
  /* 
        è¿­ä»£å™¨å¯¹è±¡:
        1.å¿…é¡»æœ‰ä¸€ä¸ªnextå‡½æ•°
        2.è¿”å›å€¼å¿…é¡»ä¸ºä¸€ä¸ªå¯¹è±¡ å¯¹è±¡åŒ…å«ä¸¤ä¸ªå±æ€§valueï¼šè¿­ä»£åºåˆ—çš„ä¸‹ä¸€ä¸ªå€¼ã€‚ã€‚doneï¼šå¸ƒå°”å€¼ï¼Œå¦‚æœåºåˆ—ä¸­æ‰€æœ‰çš„å€¼éƒ½å·²ç»è¿”å›ï¼Œåˆ™ä¸ºtrueï¼›å¦‚æœåºåˆ—ä¸­è¿˜æœ‰å€¼å¯ä»¥è¿”å›ï¼Œåˆ™ä¸ºfalseã€‚
      */
  return {
    next() {
      if (index < arg.length) {
        return {
          value: arg[index++],
          done: false,
        }
      } else {
        return {
          done: true,
        }
      }
    },
  }
}

const numIterator = createIterator(num)

console.log(numIterator.next()) //{value: 1, done: false}
console.log(numIterator.next()) //{value: 56, done: false}
console.log(numIterator.next()) //{value: 11, done: false}
console.log(numIterator.next()) //{ value: 90, done: false }
console.log(numIterator.next()) //done: true}
```

**å¯è¿­ä»£å¯¹è±¡**

è¦æˆä¸º**å¯è¿­ä»£**å¯¹è±¡ï¼Œè¯¥å¯¹è±¡å¿…é¡»å®ç° **`@@iterator`** æ–¹æ³•ï¼Œè¿™æ„å‘³ç€å¯¹è±¡å¿…é¡»æœ‰ä¸€ä¸ªé”®ä¸º @@iterator çš„å±æ€§ï¼Œå¯é€šè¿‡å¸¸é‡ Symbol.iterator è®¿é—®è¯¥å±æ€§ã€‚

```js
class Student {
  constructor(subject) {
    this.subject = subject
  }

  /* è¿­ä»£å™¨
      å¿…é¡»å®ç° @@iterator æ–¹æ³•,å¯é€šè¿‡å¸¸é‡ Symbol.iterator è®¿é—®è¯¥å±æ€§
      */
  [Symbol.iterator] = () => {
    let index = 0
    return {
      next: () => {
        if (index < this.subject.length) {
          return { done: false, value: this.subject[index++] }
        } else {
          return { done: true }
        }
      },
      //è¿­ä»£å™¨ä¸­æ–­å›è°ƒ
      return: () => {
        console.log(this, 'è¿­ä»£å™¨è¢«ä¸­æ–­')
        return { done: true }
      },
    }
  }
}

const s1 = new Student(['è¯­æ–‡', 'æ•°å­¦', 'ç§‘å­¦'])

const s2 = new Student(['åœ°ç†', 'è‹±è¯­', 'åŒ–å­¦'])

for (const sub of s1) {
  //è¯­æ–‡
  //æ•°å­¦
  //ç§‘å­¦
  console.log(sub)
}

for (const sub of s2) {
  //åœ°ç†
  //è‹±è¯­
  console.log(sub)
  if (sub === 'è‹±è¯­') break
  //Student{...}  'è¿­ä»£å™¨è¢«ä¸­æ–­'
}
```

**ç”Ÿæˆå™¨å‡½æ•°**

**ç”Ÿæˆå™¨å‡½æ•°**æä¾›äº†ä¸€ä¸ªå¼ºå¤§çš„æ›¿ä»£é€‰æ‹©ï¼šå®ƒå…è®¸ä½ å®šä¹‰ä¸€ä¸ªéè¿ç»­æ‰§è¡Œçš„å‡½æ•°ä½œä¸ºè¿­ä»£ç®—æ³•ã€‚è¿™åœ¨å¤„ç†å¼‚æ­¥æ“ä½œã€ç®¡ç†æµæ§åˆ¶ç­‰æ–¹é¢éå¸¸æœ‰ç”¨ã€‚

ç”Ÿæˆå™¨å‡½æ•°çš„å®šä¹‰ä½¿ç”¨`function*`è¯­æ³•ï¼Œè€Œä¸æ˜¯æ ‡å‡†çš„`function`ã€‚å½“ä½ è°ƒç”¨ä¸€ä¸ªç”Ÿæˆå™¨å‡½æ•°æ—¶ï¼Œå®ƒå¹¶ä¸ä¼šç«‹å³æ‰§è¡Œï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ªæŒ‡å‘ç”Ÿæˆå™¨å®ä¾‹çš„è¿­ä»£å™¨ã€‚é€šè¿‡è¿™ä¸ªè¿­ä»£å™¨ä¸Šçš„`next()`æ–¹æ³•ï¼Œç”Ÿæˆå™¨å‡½æ•°å¯ä»¥åœ¨æ¯ä¸ª`yield`è¡¨è¾¾å¼å¤„æš‚åœå’Œæ¢å¤æ‰§è¡Œã€‚

```js
function* generatorFunction() {
  yield 'Hello,'
  yield 'World!'
}

const generatorObject = generatorFunction()

console.log(generatorObject.next()) // {value: 'Hello,', done: false}
console.log(generatorObject.next()) // {value: 'World!', done: false}
console.log(generatorObject.next()) // {value: undefined, done: true}
```

å‚æ•°åŠè¿”å›å€¼

```js
/* 
        ä¼ å‚:
        ç¬¬ä¸€æ¬¡ä¼ å‚ä¼ å…¥å£°æ˜å‡½æ•°ä¸­å³å¯å‰©ä½™æ­¥éª¤åˆ™æ˜¯åœ¨è°ƒç”¨nextå‡½æ•°ä¸­ä¼ å‚
        generatorObject.next('next2')
        æ¥æ”¶å‚æ•°åˆ™æ˜¯åœ¨yieldå‰å£°æ˜
        ä¾‹:  const name1 = yield 'Hello,'
        è¿”å›å€¼:åœ¨yieldåå£°æ˜
        ä¾‹:   const name1 = yield 'Hello'; 'Hello'ä¸ºè¿”å›å€¼
    */
function* generatorFunction(name) {
  console.log('ç¬¬ä¸€æ¬¡è°ƒç”¨nextå‡½æ•°...', name)
  const name1 = yield 'Hello'
  const name2 = yield 'World'
}

const generatorObject = generatorFunction('next1')

console.log(generatorObject.next()) // {value: 'Hello,', done: false}
console.log(generatorObject.next('next2')) // {value: 'World!', done: false}
console.log(generatorObject.next('next3')) // {value: undefined, done: true}
```

return å’Œ throw

```js
function* generatorFunction(name) {
  console.log('ç¬¬ä¸€æ¬¡è°ƒç”¨nextå‡½æ•°...', name)
  const name1 = yield 'Hello'
  console.log('ç¬¬äºŒæ¬¡è°ƒç”¨nextå‡½æ•°...', name1)
  const name2 = yield 'World'
}

const generatorObject = generatorFunction('next1')

console.log(generatorObject.next()) // {value: 'Hello,', done: false}
console.log(generatorObject.throw(new Error('new throw error'))) //Uncaught Error: new throw error
// console.log(generatorObject.return());//{} value: undefined, done: true}
```

ç”Ÿæˆå™¨æ›¿ä»£è¿­ä»£å™¨

```js
const num = [1, 56, 11, 90]

/* è¿­ä»£å™¨ */
function createIterator(arg) {
  let index = 0
  return {
    next() {
      if (index < arg.length) {
        return {
          value: arg[index++],
          done: false,
        }
      } else {
        return {
          done: true,
        }
      }
    },
  }
}

const numIterator = createIterator(num)
console.log(numIterator.next()) //{value: 1, done: false}
console.log(numIterator.next()) //{value: 56, done: false}
console.log(numIterator.next()) //{value: 11, done: false}
console.log(numIterator.next()) //{ value: 90, done: false }
console.log(numIterator.next()) //done: true}

/* ----------------------------------------------------------- */

/* ç”Ÿæˆå™¨ */
function* createGenerator(arg) {
  for (let i = 0; i <= arg.length; i++) {
    yield arg[i]
  }
}

const generator = createGenerator(num)
console.log(generator.next()) //{value: 1, done: false}
console.log(generator.next()) //{value: 56, done: false}
console.log(generator.next()) //{value: 11, done: false}
console.log(generator.next()) //{ value: 90, done: false }
console.log(generator.next()) //{value: undefined, done: false}
```

yield è¯­æ³•ç³–
**yield\* [[expression]]** expression:è¿”å›ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡çš„è¡¨è¾¾å¼ã€‚

```js
function* createGenerator(arg) {
  yield* arg
}

const generator = createGenerator(num)
console.log(generator.next()) //{value: 1, done: false}
console.log(generator.next()) //{value: 56, done: false}
console.log(generator.next()) //{value: 11, done: false}
console.log(generator.next()) //{ value: 90, done: false }
console.log(generator.next()) //{value: undefined, done: false}
```

ç®€åŒ–ä¹‹å‰å¯è¿­ä»£å¯¹è±¡

```js
class Student {
  constructor(subject) {
    this.subject = subject
  }

  *[Symbol.iterator]() {
    yield* this.subject
  }
}

const s1 = new Student(['è¯­æ–‡', 'æ•°å­¦', 'ç§‘å­¦'])

for (const sub of s1) {
  //è¯­æ–‡
  //æ•°å­¦
  //ç§‘å­¦
  console.log(sub)
}
```

ç”Ÿæˆå™¨å®ç°å¼‚æ­¥å‡½æ•°è°ƒç”¨

```js
function requestFn(url) {
  return new Promise((resolve) => {
    setTimeout(() => {
      resolve(url)
    }, 2000)
  })
}

//æœ€åŸå§‹å†™æ³• äº§ç”Ÿå›è°ƒåœ°ç‹±
requestFn('my').then((res) => {
  console.log('res1:', res)
  requestFn('code').then((res) => {
    console.log('res2:', res)
    requestFn('foo').then((res) => {
      console.log('res3:', res)
    })
  })
})

//ä½¿ç”¨ç”Ÿæˆå™¨å®ç°
function* generatorFn() {
  yield requestFn('hello')
  yield requestFn('co')
  yield requestFn('co')
}

//ç”Ÿæˆå™¨
/*    const generator = generatorFn()

       generator.next().value.then(res => {
         console.log(res)

         generator.next().value.then(res => {
           console.log(res)

           generator.next().value.then(res => {
             console.log(res)
           })
         })
       }) */

//ä¼˜åŒ–å†™æ³•
function executionFn(fn) {
  //è·å–å‡½æ•°ç”Ÿæˆå™¨
  const generator = generatorFn()
  //é€’å½’è°ƒç”¨
  function execution() {
    const res = generator.next()
    if (!res.done) {
      res.value.then((data) => {
        console.log(data)
        execution()
      })
    }
  }

  execution()
}

executionFn(generatorFn)
```

### async å’Œ await

**`async function`** å£°æ˜åˆ›å»ºä¸€ä¸ªæ–°å¼‚æ­¥å‡½æ•°ã€‚å‡½æ•°ä½“å†…å…è®¸ä½¿ç”¨ `await` å…³é”®å­—ï¼Œè¿™ä½¿å¾—æˆ‘ä»¬å¯ä»¥æ›´ç®€æ´åœ°ç¼–å†™åŸºäº promise çš„å¼‚æ­¥ä»£ç ã€‚` async``await `å®é™…ä¸Šæ˜¯åŸºäº Promises çš„è¯­æ³•ç³–ï¼Œæä¾›äº†ä¸€ç§æ›´ç›´è§‚å’Œæ›´æ˜“è¯»çš„æ–¹å¼æ¥å¤„ç†å¼‚æ­¥æ“ä½œã€‚

```js
function requestFn(url) {
  return new Promise((resolve) => {
    setTimeout(() => {
      resolve(url)
    }, 2000)
  })
}

async function execFn() {
  const res = await requestFn('code...')
  console.log(res) //2000msåè¾“å‡º code...
}

execFn()
```

ä¸æ™®é€šå‡½æ•°çš„åŒºåˆ«

1. **è¿”å›å€¼**:æ™®é€šå‡½æ•°è¿”å›å€¼é»˜è®¤ä¸º undefined æˆ–è¿”å› return çš„æ•°æ®,è€Œ async å¼‚æ­¥å‡½æ•°é»˜è®¤è¿”å›çš„åˆ™æ˜¯ä¸€ä¸ª Promiseã€‚

```js
/* 
      é»˜è®¤è¿”å›ä¸€ä¸ªpromise
      1å¦‚æœè¿”å›ä¸€ä¸ªæ™®é€šæ•°æ®ç›¸å½“äº resolve(æ™®é€šæ•°æ®)
      2å¦‚æœè¿”å›ä¸€ä¸ªpromise,è¿™ä¸ªprimiseå†³å®šå¼‚æ­¥å‡½æ•°.thençš„çŠ¶æ€   
      3ä¹Ÿå¯ä»¥è¿”å›ä¸€ä¸ªthentable
      ä¸Šè¿°3ç‚¹å’Œä¹‹å‰æè¿°promiseè¿”å›å€¼ä¸€è‡´
    */
async function execFn() {
  //ç­‰åŒäºreturn new Promise((resolve)=>{resolve()})
}

execFn().then((res) => {
  console.log('execFnå¼‚æ­¥å‡½æ•°è¿”å›å€¼:', res) //execFnå¼‚æ­¥å‡½æ•°è¿”å›å€¼: undefined
})

async function foo() {
  //ç­‰åŒäºreturn new Promise((resolve)=>{resolve(123)})
  return 123
}

foo().then((res) => {
  console.log('fooå¼‚æ­¥å‡½æ•°è¿”å›å€¼:', 123) //fooå¼‚æ­¥å‡½æ•°è¿”å›å€¼: 123
})
```

2. **å¼‚å¸¸å¤„ç†**:æ™®é€šå‡½æ•°é‡åˆ°æŠ¥é”™å°†ä¸ä¼šæ‰§è¡Œåç»­ä»£ç ,è€Œ async å¼‚æ­¥å‡½æ•°åˆ™ä¼šæ•è·å¼‚å¸¸åœ¨ catch ä¸­è¿›è¡Œå¤„ç†(å‰ææ˜¯å¼‚æ­¥å‡½æ•°æœ‰è°ƒç”¨ catch)ã€‚

```js
function foo() {
  console.log(a) // a is not defined
}

// foo()
//ä¸Šé¢å¼‚å¸¸å¯¼è‡´åç»­ä»£ç å°†ä¸ä¼šæ‰§è¡Œ

async function bar() {
  console.log(a) // a is not defined
}

bar()
  .then((res) => {
    console.log(res)
  })
  .catch((err) => {
    console.log('err:', err)
    //é”™è¯¯å¤„ç†....
  })

console.log('åç»­ä»£ç ....') //åç»­ä»£ç ....
```

3. await å…³é”®å­—:æ™®é€šå‡½æ•°ä¸èƒ½ä½¿ç”¨ await å…³é”®å­—,è€Œ async å¼‚æ­¥å‡½æ•°å¯ä»¥ã€‚

### å¾®ä»»åŠ¡å’Œå®ä»»åŠ¡

å¾®ä»»åŠ¡ï¼ˆMicrotasksï¼‰å’Œå®ä»»åŠ¡ï¼ˆMacrotasksï¼‰æ˜¯ç°ä»£ JavaScript å¼•æ“ç”¨æ¥å¤„ç†å¼‚æ­¥ä»»åŠ¡çš„ä¸¤ç§æœºåˆ¶ï¼Œå®ƒä»¬åœ¨äº‹ä»¶å¾ªç¯ï¼ˆEvent Loopï¼‰ä¸­æœ‰ä¸åŒçš„è°ƒåº¦æ—¶æœºã€‚

ä¸»è¦çš„å®ä»»åŠ¡åŒ…æ‹¬ï¼š

- `setTimeout`
- `setInterval`
- `setImmediate` (Node.js ç¯å¢ƒ)
- `I/O` (å¦‚æ–‡ä»¶è¯»å†™ã€ç½‘ç»œé€šè®¯ç­‰æ“ä½œï¼ŒNode.js ç¯å¢ƒ)
- `UIæ¸²æŸ“` (æµè§ˆå™¨ç¯å¢ƒ)

ä¸»è¦çš„å¾®ä»»åŠ¡åŒ…æ‹¬ï¼š

- `Promise.then/catch/finally`
- `MutationObserver` (æµè§ˆå™¨ç‰¹å®šåŠŸèƒ½ï¼Œç”¨äºç›‘æ§ DOM å˜åŒ–)
- `process.nextTick` (Node.js ç¯å¢ƒ)
- `queueMicrotask` (ç›´æ¥å°†ä»»åŠ¡åŠ å…¥å¾®ä»»åŠ¡é˜Ÿåˆ—çš„ API)

{/* todo */}
[å¸¸è§é¢è¯•é¢˜:äº†è§£ js ä»»åŠ¡é˜Ÿåˆ—å—ï¼Ÿ](https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/p)
